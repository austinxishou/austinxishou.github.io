<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>爵士犀首</title>
  <subtitle>Talk is cheap, show me the code!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://austinxishou.github.io/"/>
  <updated>2017-11-07T09:58:43.366Z</updated>
  <id>https://austinxishou.github.io/</id>
  
  <author>
    <name>AustinXishou</name>
    <email>austinxishou@yahoo.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>createjs详解-preloadJS的使用</title>
    <link href="https://austinxishou.github.io/2017/11/07/webdesign/JavaScript-module-createjs/"/>
    <id>https://austinxishou.github.io/2017/11/07/webdesign/JavaScript-module-createjs/</id>
    <published>2017-11-07T08:05:26.130Z</published>
    <updated>2017-11-07T09:58:43.366Z</updated>
    
    <content type="html"><![CDATA[<h2 id="About-简介"><a href="#About-简介" class="headerlink" title="About-简介"></a>About-简介</h2><p>createJs框架<br><a href="http://www.ajexoop.com/wordpress/" target="_blank" rel="external">ajexoop博客</a><br><a href="http://creatine.guineashots.com/" target="_blank" rel="external">Creatine-基于create.js的游戏引擎</a><br><a href="http://www.mapeditor.org/" target="_blank" rel="external">Creatine-地图编辑器</a></p>
<blockquote>
<p>createJs分成easelJs（图形动画）、preloadJs（文件加载）、soundJs（音频控制）以及tweenJs（补间动画）四部分</p>
</blockquote>
<h2 id="preloadJS的使用"><a href="#preloadJS的使用" class="headerlink" title="preloadJS的使用"></a>preloadJS的使用</h2><p><code>定义依赖模块</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">require.config(&#123;</div><div class="line">    paths: &#123;</div><div class="line">		jquery:	&apos;lib/jquery-3.1.0.min&apos;,</div><div class="line">		PreloadJS: &apos;lib/preloadjs-0.6.2.min&apos;,</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><code>定义manifest</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Global.manifest = [</div><div class="line">               &#123;src:&quot;image/man.png&quot; , id:&quot;man&quot;&#125;,</div><div class="line">               &#123;src:&quot;image/ground.png&quot; , id:&quot;ground&quot;&#125;,</div><div class="line">               &#123;src:&quot;image/bg.png&quot; , id:&quot;bg&quot;&#125;,</div><div class="line">               &#123;src:&quot;image/high.jpg&quot; , id:&quot;high&quot;&#125;,</div><div class="line">               &#123;src:&quot;image/coins.png&quot; , id:&quot;coin&quot;&#125;</div><div class="line">];</div></pre></td></tr></table></figure>
<blockquote>
<p>src表示资源的路径，id在后面用来取加载好的资源。</p>
</blockquote>
<p><code>加载资源</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// 加载资源</div><div class="line">var loader = new createjs.LoadQueue(false);</div><div class="line">   loader.setMaxConnections(100);</div><div class="line">   loader.maintainScriptOrder = true;</div><div class="line">loader.addEventListener(&apos;progress&apos;, function (e) &#123;</div><div class="line">	console.log(Math.floor(e.progress * 100) + &apos;%&apos;);</div><div class="line">&#125;);</div><div class="line">   loader.addEventListener(&apos;complete&apos;, function () &#123;&#125;);//当图片素材load完后执行该方法</div><div class="line">   loader.loadManifest(Global.manifest);</div></pre></td></tr></table></figure>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>参照网络上的<a href="http://whxaxes.github.io/canvas-test/src/Game-demo/runningMan/index.html" target="_blank" rel="external">酷跑demo</a></p>
<p><code>初始化舞台</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">function init()&#123;</div><div class="line">	stage = new createjs.Stage(&quot;cas&quot;);</div><div class="line">	C_W = stage.canvas.width;</div><div class="line">	C_H = stage.canvas.height;</div><div class="line">	var manifest = [</div><div class="line">		&#123;src:&quot;image/man.png&quot; , id:&quot;man&quot;&#125;,</div><div class="line">		&#123;src:&quot;image/ground.png&quot; , id:&quot;ground&quot;&#125;,</div><div class="line">		&#123;src:&quot;image/bg.png&quot; , id:&quot;bg&quot;&#125;,</div><div class="line">		&#123;src:&quot;image/high.jpg&quot; , id:&quot;high&quot;&#125;,</div><div class="line">		&#123;src:&quot;image/coins.png&quot; , id:&quot;coin&quot;&#125;</div><div class="line">	]</div><div class="line">	loader = new createjs.LoadQueue(false);</div><div class="line">	loader.addEventListener(&quot;complete&quot; , handleComplete);</div><div class="line">	loader.loadManifest(manifest);</div><div class="line">	drawLoading();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      createjs详解-preloadJS的使用
    
    </summary>
    
      <category term="webdesign" scheme="https://austinxishou.github.io/categories/webdesign/"/>
    
    
      <category term="JavaScript" scheme="https://austinxishou.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>AMD模块详解——Javascript模块化编程(三)</title>
    <link href="https://austinxishou.github.io/2017/11/07/webdesign/JavaScript-module-amd/"/>
    <id>https://austinxishou.github.io/2017/11/07/webdesign/JavaScript-module-amd/</id>
    <published>2017-11-07T03:47:12.535Z</published>
    <updated>2017-11-07T08:05:20.193Z</updated>
    
    <content type="html"><![CDATA[<h2 id="About-简介"><a href="#About-简介" class="headerlink" title="About-简介"></a>About-简介</h2><blockquote>
<p>前端开发在近一两年发展的非常快，JavaScript作为主流的开发语言得到了前所未有的热捧。大量的前端框架出现了，这些框架都在尝试着解决一些前端开发中的共性问题，但是实现又不尽相同。<br>在这个背景下，CommonJS社区诞生了，为了让前端框架发展的更加成熟，CommonJS鼓励开发人员 一起在社区里为一些完成特定功能的框架制定规范。 AMD（Asynchronous Module Definition） 就是其中的一个规范。</p>
</blockquote>
<h3 id="传统JavaScript代码的问题"><a href="#传统JavaScript代码的问题" class="headerlink" title="传统JavaScript代码的问题"></a>传统JavaScript代码的问题</h3><blockquote>
<p>让我们来看看一般情况下JavaScript代码是如何开发的：通过<code>&lt;script&gt;</code>标签来载入JavaScript文件，用全局变量 来区分不同的功能代码，全局变量之间的依赖关系需要显式的通过指定其加载顺序来解决，发布应用时要通过工具来压缩所有的JavaScript代码到一个文 件。当Web项目变得非常庞大，前端模块非常多的时候，手动管理这些全局变量间的依赖关系就变得很困难，这种做法显得非常的低效。</p>
</blockquote>
<h3 id="AMD-（Asynchronous-Module-Definition）-的引入"><a href="#AMD-（Asynchronous-Module-Definition）-的引入" class="headerlink" title="AMD （Asynchronous Module Definition） 的引入"></a>AMD （Asynchronous Module Definition） 的引入</h3><blockquote>
<p>从名称上看便知它是适合script tag的。也可以说AMD是专门为浏览器中JavaScript环境设计的规范。它吸取了CommonJS的一些优点，但又不照搬它的格式。</p>
<p>开始AMD作为CommonJS的 transport format  存在，因无法与CommonJS开发者达成一致而独立出来。它有自己的 wiki  和 讨论组  。</p>
</blockquote>
<p>AMD提出了一种基于模块的异步加载JavaScript代码的机制，它推荐开发人员将JavaScript代码封装进一个个模块，对全局对象的依 赖变成了对其他模块的依赖，无须再声明一大堆的全局变量。通过延迟和按需加载来解决各个模块的依赖关系。模块化的JavaScript代码好处很明显，各 个功能组件的松耦合性可以极大的提升代码的复用性、可维护性。这种非阻塞式的并发式快速加载JavaScript代码，使Web页面上其他不依赖 JavaScript代码的UI元素，如图片、CSS以及其他DOM节点得以先加载完毕，Web页面加载速度更快，用户也得到更好的体验。</p>
<p>  CommonJS的AMD规范中只定义了一个全局的方法:<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">define(id?, dependencies?, factory);</div></pre></td></tr></table></figure></p>
<p>  该方法用来定义一个JavaScript模块，开发人员可以用这个方法来将部分功能模块封装在这个<code>define方法</code>体内。</p>
<ul>
<li><p><code>id</code>表示该模块的标识，为可选参数。</p>
</li>
<li><p><code>dependencies</code>是一个字符串Array，表示该模块依赖的其他所有模块标识，模块依赖必须在真正执行具体的factory方法前解决，这些依赖对象加载执行以后的返回值，可以以默认的顺序作为factory方法的参数。dependencies也是可选参数，当用户不提供该参数时，实现 AMD的框架应提供默认值为[“require”，”exports”，“module”]。</p>
</li>
<li><p><code>factory</code>是一个用于执行改模块的方法，它可以使用前面dependencies里声明的其他依赖模块的返回值作为参数，若该方法有返回值，当该模块被其他模块依赖时，返回值就是该模块的输出。</p>
</li>
</ul>
<p>CommonJS在规范中并没有详细规定其他的方法，一些主要的AMD框架如RequireJS、curl、bdload等都实现了define方法，同时各个框架都有自己的补充使得其API更实用。</p>
<h2 id="AMD模块的写法"><a href="#AMD模块的写法" class="headerlink" title="AMD模块的写法"></a>AMD模块的写法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">define(id?, dependencies?, factory);</div></pre></td></tr></table></figure>
<p>其中:</p>
<ul>
<li>id: 模块标识，可以省略。</li>
<li>dependencies: 所依赖的模块，可以省略。</li>
<li>factory: 模块的实现，或者一个JavaScript对象。</li>
</ul>
<blockquote>
<p>id遵循CommonJS  Module Identifiers  。dependencies元素的顺序和factory参数一一对应。</p>
</blockquote>
<p>以下是使用AMD模式开发的简单三层结构（基础库/UI层/应用层）：</p>
<ol>
<li><p><strong>定义无依赖的模块 （base.js）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">define(function() &#123;</div><div class="line">    return &#123;</div><div class="line">        mix: function(source, target) &#123;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><strong>定义有依赖的模块 （ui.js，page.js）</strong></p>
</li>
</ol>
<p><code>ui.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">define([&apos;base&apos;], function(base) &#123;</div><div class="line">    return &#123;</div><div class="line">        show: function() &#123;</div><div class="line">            // todo with module base</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><code>page.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">define([&apos;data&apos;, &apos;ui&apos;], function(data, ui) &#123;</div><div class="line">    // init here</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<ol>
<li><p><strong>定义数据对象模块 （data.js）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">define(&#123;</div><div class="line">    users: [],</div><div class="line">    members: []</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>具名模块</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">define(&apos;index&apos;, [&apos;data&apos;,&apos;base&apos;], function(data, base) &#123;</div><div class="line">    // todo</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<blockquote>
<p>具名模块多数时候是<code>不推荐</code>的，一般由打包工具合并多个模块到一个js文件中时使用。</p>
</blockquote>
<ol>
<li>包装模块</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">define(function(require, exports, module) &#123;</div><div class="line">    var base = require(&apos;base&apos;);</div><div class="line">    exports.show = function() &#123;</div><div class="line">        // todo with module base</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>不考虑多了一层函数外，格式和Node.js是一样的。使用require获取依赖模块，使用exports导出API。<br>除了define外，AMD还保留一个关键字require。 require   作为规范保留的全局标识符，可以实现为   module loader。也可以不实现。</p>
<p>目前，实现AMD的库有 RequireJS  、 curl  、 Dojo  、 bdLoad 、 JSLocalnet 、 Nodules  等。</p>
<p>也有很多库支持AMD规范，即将自己作为一个模块存在，如 MooTools  、jQuery  、 qwery  、 bonzo   甚至还有  firebug  。</p>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      AMD模块详解 Javascript模块化编程
    
    </summary>
    
      <category term="webdesign" scheme="https://austinxishou.github.io/categories/webdesign/"/>
    
    
      <category term="JavaScript" scheme="https://austinxishou.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>require.js详解——Javascript模块化编程(四)</title>
    <link href="https://austinxishou.github.io/2017/11/07/webdesign/JavaScript-module-require/"/>
    <id>https://austinxishou.github.io/2017/11/07/webdesign/JavaScript-module-require/</id>
    <published>2017-11-07T03:29:43.323Z</published>
    <updated>2017-11-07T03:46:58.667Z</updated>
    
    <content type="html"><![CDATA[<h2 id="About-简介"><a href="#About-简介" class="headerlink" title="About-简介"></a>About-简介</h2><blockquote>
<p>require.js是用于解决js文件的异步加载，避免网页失去响应，另外管理模块之间的依赖性，便于代码的编写和维护。</p>
</blockquote>
<h2 id="GetStarted-第一步"><a href="#GetStarted-第一步" class="headerlink" title="GetStarted-第一步"></a>GetStarted-第一步</h2><ol>
<li>使用require.js的第一步，是先去<a href="http://requirejs.org/docs/download.html" target="_blank" rel="external">官方网站</a>下载最新版本。</li>
</ol>
<p>下载后，假定把它放在js子目录下面，就可以加载了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;js/require.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>显而易见，加载这个文件，也可能造成网页失去响应。解决办法有两个，一个是把它放在网页底部加载，另一个是写成下面这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;js/require.js&quot; defer async=&quot;true&quot; &gt;&lt;/script&gt;</div><div class="line"></div><div class="line">//async属性表明这个文件需要异步加载，避免网页失去响应。IE不支持这个属性，只支持defer，所以把defer也写上。</div></pre></td></tr></table></figure>
<p>加载require.js以后，下一步就要加载我们自己的代码了。假定我们自己的代码文件是main.js，也放在js目录下面。那么，只需要写成下面这样就行了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;js/require.js&quot; data-main=&quot;js/main&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>data-main属性的作用是，指定网页程序的主模块。在上例中，就是js目录下面的main.js，这个文件会第一个被require.js加载。<br>由于require.js默认的文件后缀名是js，所以可以把main.js简写成main。</p>
<h2 id="main-js-主模块实现"><a href="#main-js-主模块实现" class="headerlink" title="main.js-主模块实现"></a>main.js-主模块实现</h2><p>上述加载的main.js，称为用户主模块，它有点像C语言的main()函数，所有代码都从这儿开始运行。<br>下面就来看，怎么写main.js。</p>
<p>主模块依赖于其他模块，这时就要使用AMD规范定义的的require()函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// main.js</div><div class="line">　　require([&apos;moduleA&apos;, &apos;moduleB&apos;, &apos;moduleC&apos;], function (moduleA, moduleB, moduleC)&#123;</div><div class="line">　　　　// some code here</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure>
<p>require()函数接受两个参数。</p>
<ol>
<li>第一个参数是一个数组，表示所依赖的模块，上例就是[‘moduleA’, ‘moduleB’, ‘moduleC’]，即主模块依赖这三个模块；</li>
<li>第二个参数是一个回调函数，当前面指定的模块都加载成功后，它将被调用。加载的模块会以参数形式传入该函数，从而在回调函数内部就可以使用这些模块。</li>
</ol>
<p>require()异步加载moduleA，moduleB和moduleC，浏览器不会失去响应；它指定的回调函数，只有前面的模块都加载成功后，才会运行，解决了依赖性的问题。</p>
<p>下面，我们看一个实际的例子。<br>假定主模块依赖jquery、underscore和backbone这三个模块，main.js就可以这样写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">　　require([&apos;jquery&apos;, &apos;underscore&apos;, &apos;backbone&apos;], function ($, _, Backbone)&#123;</div><div class="line">　　　　// some code here</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure>
<p>require.js会先加载jQuery、underscore和backbone，然后再运行回调函数。主模块的代码就写在回调函数中。</p>
<h2 id="require-config-模块加载"><a href="#require-config-模块加载" class="headerlink" title="require.config-模块加载"></a>require.config-模块加载</h2><p>上一节最后的示例中，主模块的依赖模块是[‘jquery’, ‘underscore’, ‘backbone’]。默认情况下，require.js假定这三个模块与main.js在同一个目录，文件名分别为jquery.js，underscore.js和backbone.js，然后自动加载。<br>使用require.config()方法，我们可以对模块的加载行为进行自定义。require.config()就写在主模块（main.js）的头部。参数就是一个对象，这个对象的paths属性指定各个模块的加载路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">require.config(&#123;</div><div class="line">    paths: &#123;</div><div class="line">		jquery:	&apos;lib/jquery-3.1.0.min&apos;,</div><div class="line">		PreloadJS: &apos;lib/preloadjs-0.6.2.min&apos;,</div><div class="line">		jweixin: &apos;http://res.wx.qq.com/open/js/jweixin-1.0.0&apos;,</div><div class="line">		jstween: &apos;lib/jstween.min&apos;,</div><div class="line">		jstimeline: &apos;lib/jstimeline.min&apos;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>上面的代码给出了三个模块的文件名，路径默认与main.js在同一个目录（js子目录）。如果这些模块在其他目录，比如js/lib目录，则有两种写法。一种是逐一指定路径。</p>
<p>也可以通过直接改变基目录(baseUrl)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">　　require.config(&#123;</div><div class="line">　　　　baseUrl: &quot;js/lib&quot;,</div><div class="line">　　　　paths: &#123;</div><div class="line">　　　　　　&quot;jquery&quot;: &quot;jquery.min&quot;,</div><div class="line">　　　　　　&quot;underscore&quot;: &quot;underscore.min&quot;,</div><div class="line">　　　　　　&quot;backbone&quot;: &quot;backbone.min&quot;</div><div class="line">　　　　&#125;</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure>
<p>require.js要求，每个模块是一个单独的js文件。这样的话，如果加载多个模块，就会发出多次HTTP请求，会影响网页的加载速度。<br>因此，require.js提供了一个<a href="http://requirejs.org/docs/optimization.html" target="_blank" rel="external">优化工具</a>，当模块部署完毕以后，可以用这个工具将多个模块合并在一个文件中，减少HTTP请求数。</p>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      require.js详解 Javascript模块化编程
    
    </summary>
    
      <category term="webdesign" scheme="https://austinxishou.github.io/categories/webdesign/"/>
    
    
      <category term="JavaScript" scheme="https://austinxishou.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Krpano-skin 皮肤详解及配置说明</title>
    <link href="https://austinxishou.github.io/2017/11/06/krpano/krpano-skin-develop/"/>
    <id>https://austinxishou.github.io/2017/11/06/krpano/krpano-skin-develop/</id>
    <published>2017-11-06T06:16:00.934Z</published>
    <updated>2017-11-06T07:06:49.282Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简单例子"><a href="#简单例子" class="headerlink" title="简单例子"></a>简单例子</h2><blockquote>
<p>自动旋转播放</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>"<span class="attr">autorotatebutton</span>"</span></div><div class="line">        <span class="attr">url</span>=<span class="string">"autorotatebuttonimage.png"</span></div><div class="line">        <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"10"</span></div><div class="line">        <span class="attr">onclick</span>=<span class="string">"switch(autorotate.enabled);"</span></div><div class="line">        /&gt;</div></pre></td></tr></table></figure>
<blockquote>
<p>全屏切换<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>"<span class="attr">fullscreenbutton</span>"</span></div><div class="line">        <span class="attr">url</span>=<span class="string">"fullscreenbuttonimage.png"</span></div><div class="line">        <span class="attr">align</span>=<span class="string">"bottomright"</span> <span class="attr">x</span>=<span class="string">"10"</span> <span class="attr">y</span>=<span class="string">"10"</span></div><div class="line">        <span class="attr">onclick</span>=<span class="string">"switch(fullscreen);"</span></div><div class="line">        /&gt;</div></pre></td></tr></table></figure></p>
<p>帮助图文菜单<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>"<span class="attr">helpimage</span>"</span></div><div class="line">        <span class="attr">url</span>=<span class="string">"help.png"</span></div><div class="line">        <span class="attr">align</span>=<span class="string">"center"</span> </div><div class="line">        <span class="attr">visible</span>=<span class="string">"false"</span></div><div class="line">        <span class="attr">onclick</span>=<span class="string">"set(visible,false);"</span></div><div class="line">        /&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>"<span class="attr">helpbutton</span>"</span></div><div class="line">        <span class="attr">url</span>=<span class="string">"helpbuttonimage.png"</span></div><div class="line">        <span class="attr">align</span>=<span class="string">"leftbottom"</span> <span class="attr">x</span>=<span class="string">"10"</span> <span class="attr">y</span>=<span class="string">"10"</span></div><div class="line">        <span class="attr">onclick</span>=<span class="string">"switch(plugin[helpimage].visible);"</span></div><div class="line">        /&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="XML配置详解"><a href="#XML配置详解" class="headerlink" title="XML配置详解"></a>XML配置详解</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div><div class="line">815</div><div class="line">816</div><div class="line">817</div><div class="line">818</div><div class="line">819</div><div class="line">820</div><div class="line">821</div><div class="line">822</div><div class="line">823</div><div class="line">824</div><div class="line">825</div><div class="line">826</div><div class="line">827</div><div class="line">828</div><div class="line">829</div><div class="line">830</div><div class="line">831</div><div class="line">832</div><div class="line">833</div><div class="line">834</div><div class="line">835</div><div class="line">836</div><div class="line">837</div><div class="line">838</div><div class="line">839</div><div class="line">840</div><div class="line">841</div><div class="line">842</div><div class="line">843</div><div class="line">844</div><div class="line">845</div><div class="line">846</div><div class="line">847</div><div class="line">848</div><div class="line">849</div><div class="line">850</div><div class="line">851</div><div class="line">852</div><div class="line">853</div><div class="line">854</div><div class="line">855</div><div class="line">856</div><div class="line">857</div><div class="line">858</div><div class="line">859</div><div class="line">860</div><div class="line">861</div><div class="line">862</div><div class="line">863</div><div class="line">864</div><div class="line">865</div><div class="line">866</div><div class="line">867</div><div class="line">868</div><div class="line">869</div><div class="line">870</div><div class="line">871</div><div class="line">872</div><div class="line">873</div><div class="line">874</div><div class="line">875</div><div class="line">876</div><div class="line">877</div><div class="line">878</div><div class="line">879</div><div class="line">880</div><div class="line">881</div><div class="line">882</div><div class="line">883</div><div class="line">884</div><div class="line">885</div><div class="line">886</div><div class="line">887</div><div class="line">888</div><div class="line">889</div><div class="line">890</div><div class="line">891</div><div class="line">892</div><div class="line">893</div><div class="line">894</div><div class="line">895</div><div class="line">896</div><div class="line">897</div><div class="line">898</div><div class="line">899</div><div class="line">900</div><div class="line">901</div><div class="line">902</div><div class="line">903</div><div class="line">904</div><div class="line">905</div><div class="line">906</div><div class="line">907</div><div class="line">908</div><div class="line">909</div><div class="line">910</div><div class="line">911</div><div class="line">912</div><div class="line">913</div><div class="line">914</div><div class="line">915</div><div class="line">916</div><div class="line">917</div><div class="line">918</div><div class="line">919</div><div class="line">920</div><div class="line">921</div><div class="line">922</div><div class="line">923</div><div class="line">924</div><div class="line">925</div><div class="line">926</div><div class="line">927</div><div class="line">928</div><div class="line">929</div><div class="line">930</div><div class="line">931</div><div class="line">932</div><div class="line">933</div><div class="line">934</div><div class="line">935</div><div class="line">936</div><div class="line">937</div><div class="line">938</div><div class="line">939</div><div class="line">940</div><div class="line">941</div><div class="line">942</div><div class="line">943</div><div class="line">944</div><div class="line">945</div><div class="line">946</div><div class="line">947</div><div class="line">948</div><div class="line">949</div><div class="line">950</div><div class="line">951</div><div class="line">952</div><div class="line">953</div><div class="line">954</div><div class="line">955</div><div class="line">956</div><div class="line">957</div><div class="line">958</div><div class="line">959</div><div class="line">960</div><div class="line">961</div><div class="line">962</div><div class="line">963</div><div class="line">964</div><div class="line">965</div><div class="line">966</div><div class="line">967</div><div class="line">968</div><div class="line">969</div><div class="line">970</div><div class="line">971</div><div class="line">972</div><div class="line">973</div><div class="line">974</div><div class="line">975</div><div class="line">976</div><div class="line">977</div><div class="line">978</div><div class="line">979</div><div class="line">980</div><div class="line">981</div><div class="line">982</div><div class="line">983</div><div class="line">984</div><div class="line">985</div><div class="line">986</div><div class="line">987</div><div class="line">988</div><div class="line">989</div><div class="line">990</div><div class="line">991</div><div class="line">992</div><div class="line">993</div><div class="line">994</div><div class="line">995</div><div class="line">996</div><div class="line">997</div><div class="line">998</div><div class="line">999</div><div class="line">1000</div><div class="line">1001</div><div class="line">1002</div><div class="line">1003</div><div class="line">1004</div><div class="line">1005</div><div class="line">1006</div><div class="line">1007</div><div class="line">1008</div><div class="line">1009</div><div class="line">1010</div><div class="line">1011</div><div class="line">1012</div><div class="line">1013</div><div class="line">1014</div><div class="line">1015</div><div class="line">1016</div><div class="line">1017</div><div class="line">1018</div><div class="line">1019</div><div class="line">1020</div><div class="line">1021</div><div class="line">1022</div><div class="line">1023</div><div class="line">1024</div><div class="line">1025</div><div class="line">1026</div><div class="line">1027</div><div class="line">1028</div><div class="line">1029</div><div class="line">1030</div><div class="line">1031</div><div class="line">1032</div><div class="line">1033</div><div class="line">1034</div><div class="line">1035</div><div class="line">1036</div><div class="line">1037</div><div class="line">1038</div><div class="line">1039</div><div class="line">1040</div><div class="line">1041</div><div class="line">1042</div><div class="line">1043</div><div class="line">1044</div><div class="line">1045</div><div class="line">1046</div><div class="line">1047</div><div class="line">1048</div><div class="line">1049</div><div class="line">1050</div><div class="line">1051</div><div class="line">1052</div><div class="line">1053</div><div class="line">1054</div><div class="line">1055</div><div class="line">1056</div><div class="line">1057</div><div class="line">1058</div><div class="line">1059</div><div class="line">1060</div><div class="line">1061</div><div class="line">1062</div><div class="line">1063</div><div class="line">1064</div><div class="line">1065</div><div class="line">1066</div><div class="line">1067</div><div class="line">1068</div><div class="line">1069</div><div class="line">1070</div><div class="line">1071</div><div class="line">1072</div><div class="line">1073</div><div class="line">1074</div><div class="line">1075</div><div class="line">1076</div><div class="line">1077</div><div class="line">1078</div><div class="line">1079</div><div class="line">1080</div><div class="line">1081</div><div class="line">1082</div><div class="line">1083</div><div class="line">1084</div><div class="line">1085</div><div class="line">1086</div><div class="line">1087</div><div class="line">1088</div><div class="line">1089</div><div class="line">1090</div><div class="line">1091</div><div class="line">1092</div><div class="line">1093</div><div class="line">1094</div><div class="line">1095</div><div class="line">1096</div><div class="line">1097</div><div class="line">1098</div><div class="line">1099</div><div class="line">1100</div><div class="line">1101</div><div class="line">1102</div><div class="line">1103</div><div class="line">1104</div><div class="line">1105</div><div class="line">1106</div><div class="line">1107</div><div class="line">1108</div><div class="line">1109</div><div class="line">1110</div><div class="line">1111</div><div class="line">1112</div><div class="line">1113</div><div class="line">1114</div><div class="line">1115</div><div class="line">1116</div><div class="line">1117</div><div class="line">1118</div><div class="line">1119</div><div class="line">1120</div><div class="line">1121</div><div class="line">1122</div><div class="line">1123</div><div class="line">1124</div><div class="line">1125</div><div class="line">1126</div><div class="line">1127</div><div class="line">1128</div><div class="line">1129</div><div class="line">1130</div><div class="line">1131</div><div class="line">1132</div><div class="line">1133</div><div class="line">1134</div><div class="line">1135</div><div class="line">1136</div><div class="line">1137</div><div class="line">1138</div><div class="line">1139</div><div class="line">1140</div><div class="line">1141</div><div class="line">1142</div><div class="line">1143</div><div class="line">1144</div><div class="line">1145</div><div class="line">1146</div><div class="line">1147</div><div class="line">1148</div><div class="line">1149</div><div class="line">1150</div><div class="line">1151</div><div class="line">1152</div><div class="line">1153</div><div class="line">1154</div><div class="line">1155</div><div class="line">1156</div><div class="line">1157</div><div class="line">1158</div><div class="line">1159</div><div class="line">1160</div><div class="line">1161</div><div class="line">1162</div><div class="line">1163</div><div class="line">1164</div><div class="line">1165</div><div class="line">1166</div><div class="line">1167</div><div class="line">1168</div><div class="line">1169</div><div class="line">1170</div><div class="line">1171</div><div class="line">1172</div><div class="line">1173</div><div class="line">1174</div><div class="line">1175</div><div class="line">1176</div><div class="line">1177</div><div class="line">1178</div><div class="line">1179</div><div class="line">1180</div><div class="line">1181</div><div class="line">1182</div><div class="line">1183</div><div class="line">1184</div><div class="line">1185</div><div class="line">1186</div><div class="line">1187</div><div class="line">1188</div><div class="line">1189</div><div class="line">1190</div><div class="line">1191</div><div class="line">1192</div><div class="line">1193</div><div class="line">1194</div><div class="line">1195</div><div class="line">1196</div><div class="line">1197</div><div class="line">1198</div><div class="line">1199</div><div class="line">1200</div><div class="line">1201</div><div class="line">1202</div><div class="line">1203</div><div class="line">1204</div><div class="line">1205</div><div class="line">1206</div><div class="line">1207</div><div class="line">1208</div><div class="line">1209</div><div class="line">1210</div><div class="line">1211</div><div class="line">1212</div><div class="line">1213</div><div class="line">1214</div><div class="line">1215</div><div class="line">1216</div><div class="line">1217</div><div class="line">1218</div><div class="line">1219</div><div class="line">1220</div><div class="line">1221</div><div class="line">1222</div><div class="line">1223</div><div class="line">1224</div><div class="line">1225</div><div class="line">1226</div><div class="line">1227</div><div class="line">1228</div><div class="line">1229</div><div class="line">1230</div><div class="line">1231</div><div class="line">1232</div><div class="line">1233</div><div class="line">1234</div><div class="line">1235</div><div class="line">1236</div><div class="line">1237</div><div class="line">1238</div><div class="line">1239</div><div class="line">1240</div><div class="line">1241</div><div class="line">1242</div><div class="line">1243</div><div class="line">1244</div><div class="line">1245</div><div class="line">1246</div><div class="line">1247</div><div class="line">1248</div><div class="line">1249</div><div class="line">1250</div><div class="line">1251</div><div class="line">1252</div><div class="line">1253</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">krpano</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- krpano 1.19.pr13 - Virtual Tour Skin --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 皮肤具体参数含义注释 --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 	maps="false"  是否使用必应地图或谷歌地图</span></div><div class="line">			maps_type="bing"  选择使用谷歌地图或必应地图</div><div class="line">			maps_bing_api_key=""   必应地图所需的API密钥，需申请</div><div class="line">			maps_google_api_key=""   谷歌地图所需的API密钥，需申请</div><div class="line">			maps_zoombuttons="false"   是否在地图上显示缩放按钮</div><div class="line">			gyro="true"   是否使用陀螺仪</div><div class="line">			webvr="true"    是否启用VR</div><div class="line">			webvr_gyro_keeplookingdirection="false" 进入陀螺仪或VR时是否保持观看方向</div><div class="line">			webvr_prev_next_hotspots="true"  在VR下是否启用导航到前后场景的链接热点</div><div class="line">			littleplanetintro="false"    是否使用小行星开场</div><div class="line">			title="true"  是否左下角显示title</div><div class="line">			thumbs="true"  是否使用缩略图，如不使用，则没有缩略图一栏</div><div class="line">			thumbs_width="120" thumbs_height="80" thumbs_padding="10" thumbs_crop="0|40|240|160"  缩略图宽度、高度、间距以及缩略图裁切范围</div><div class="line">			thumbs_opened="false"   是否在启动时弹出缩略图一栏</div><div class="line">			thumbs_text="false"  是否在缩略图上显示名字</div><div class="line">			thumbs_dragging="true"   是否允许鼠标拖拽缩略图区域</div><div class="line">			thumbs_onhoverscrolling="false"  是否允许鼠标悬停缩略图自动滚动</div><div class="line">			thumbs_scrollbuttons="false"   是否显示缩略图滚动按钮</div><div class="line">			thumbs_scrollindicator="false"   是否显示缩略图滚动条</div><div class="line">			thumbs_loop="false"  滚动按钮是否使用缩略图循环</div><div class="line">			tooltips_buttons="false" 鼠标在按钮悬停时是否弹出文字提示</div><div class="line">			tooltips_thumbs="false"  鼠标在缩略图悬停时是否弹出文字提示</div><div class="line">			tooltips_hotspots="false"   鼠标在热点上悬停时是否弹出文字提示</div><div class="line">			tooltips_mapspots="false"   鼠标在地图热点悬停时是否弹出文字提示</div><div class="line">			deeplinking="false"       是否使用深度链接获取功能，可使得当前页面路径获取场景及视角信息</div><div class="line">			loadscene_flags="MERGE"  缩略图切换场景时的变量</div><div class="line">			loadscene_blend="OPENBLEND(0.5, 0.0, 0.75, 0.05, linear)"  缩略图切换场景时的融合</div><div class="line">			loadscene_blend_prev="SLIDEBLEND(0.5, 180, 0.75, linear)"  缩略图切换到上一个场景时的融合</div><div class="line">			loadscene_blend_next="SLIDEBLEND(0.5, 0, 0.75, linear)"  缩略图切换到下一个场景时的融合</div><div class="line">			loadingtext="载入中..." 在全景图载入中时显示的文字</div><div class="line">			layout_width="100%"  导航条容器相对屏幕宽度的百分比</div><div class="line">			layout_maxwidth="814"  导航条容器的最大宽度像素</div><div class="line">			controlbar_width="-24" 导航条背景的宽度像素</div><div class="line">			controlbar_height="40"  导航条背景的高度像素</div><div class="line">			controlbar_offset.normal="20"  导航条背景与屏幕底部的距离</div><div class="line">			controlbar_offset_closed="-40"  导航条隐藏状态时与屏幕底部的距离</div><div class="line">			controlbar_overlap.no-fractionalscaling="10"  在不支持分级缩放页面和设置像素比的设备的导航条重叠的像素</div><div class="line">			controlbar_overlap.fractionalscaling="0" 支持分级缩放页面和设置像素比的设备的导航条重叠的像素</div><div class="line">			design_skin_images="vtourskin.png" 皮肤所用的源图片</div><div class="line">			design_bgcolor="0x000000" 皮肤的背景颜色</div><div class="line">			design_bgalpha="0.5" 皮肤的透明度</div><div class="line">			design_bgborder="0 0xFFFFFF 1.0" 皮肤的边框</div><div class="line">			design_bgroundedge="1" 皮肤边框圆角设置</div><div class="line">			design_bgshadow="0 0 9 0xFFFFFF 0.5" 皮肤的背景阴影</div><div class="line">			design_thumbborder_bgborder="4 0xFFFFFF 1.0" 皮肤的缩略图边框</div><div class="line">			design_thumbborder_padding="2" 皮肤缩略图边框间距</div><div class="line">			design_thumbborder_bgroundedge="5" 皮肤缩略图边框的圆角</div><div class="line">			design_text_css="color:#FFFFFF; font-family:Arial; font-weight:bold;"皮肤文字样式</div><div class="line">			design_text_shadow="1" 皮肤的文字阴影 --&gt;</div><div class="line">    </div><div class="line">	</div><div class="line">    <span class="comment">&lt;!-- save the url path of this xml file (the url value will be adjusted during xml parsing) --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">vtourskinxmlpath</span> <span class="attr">url</span>=<span class="string">"./"</span> /&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- mouse / touch / keyboard(button) control settings - http://krpano.com/docu/xml/#control --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 鼠标触屏键盘控制的设定 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">control</span> <span class="attr">mouse</span>=<span class="string">"drag"</span></span></div><div class="line">             <span class="attr">touch</span>=<span class="string">"drag"</span></div><div class="line">             <span class="attr">zoomtocursor</span>=<span class="string">"false"</span></div><div class="line">             <span class="attr">zoomoutcursor</span>=<span class="string">"false"</span></div><div class="line">             <span class="attr">draginertia</span>=<span class="string">"0.1"</span></div><div class="line">             <span class="attr">dragfriction</span>=<span class="string">"0.9"</span></div><div class="line">             <span class="attr">movetoaccelerate</span>=<span class="string">"1.0"</span></div><div class="line">             <span class="attr">movetospeed</span>=<span class="string">"10.0"</span></div><div class="line">             <span class="attr">movetofriction</span>=<span class="string">"0.8"</span></div><div class="line">             <span class="attr">keybaccelerate</span>=<span class="string">"0.09"</span></div><div class="line">             <span class="attr">keybfriction</span>=<span class="string">"0.94"</span></div><div class="line">             <span class="attr">keybfovchange</span>=<span class="string">"0.25"</span></div><div class="line">             <span class="attr">mousefovchange</span>=<span class="string">"1.0"</span></div><div class="line">             <span class="attr">fovspeed</span>=<span class="string">"3.0"</span></div><div class="line">             <span class="attr">fovfriction</span>=<span class="string">"0.9"</span></div><div class="line">             <span class="attr">bouncinglimits</span>=<span class="string">"true"</span></div><div class="line">             /&gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- mouse cursors - http://krpano.com/docu/xml/#cursors --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 鼠标光标设定可自定义光标的样式 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">cursors</span> <span class="attr">standard</span>=<span class="string">"default"</span></span></div><div class="line">             <span class="attr">dragging</span>=<span class="string">"move"</span></div><div class="line">             <span class="attr">moving</span>=<span class="string">"move"</span></div><div class="line">             /&gt;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- ensure stagescale 2x for mobile devices (regardless if mobilescale is 0.5 or 1.0) --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">krpano</span> <span class="attr">stagescale</span>=<span class="string">"calc:stagescale * 2"</span> <span class="attr">if</span>=<span class="string">"stagescale LT 1.0"</span> <span class="attr">devices</span>=<span class="string">"mobile"</span> /&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- include VR support - http://krpano.com/plugins/webvr/ --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- WebVR插件 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">url</span>=<span class="string">"%SWFPATH%/plugins/webvr.xml"</span> <span class="attr">devices</span>=<span class="string">"html5"</span> /&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- overwrite some settings from the webvr.xml for the skin integration --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 覆盖WebVR默认设定 --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- onavailable去除插件自定义的进入VR按钮（因为皮肤中已包含）webvr_enterbutton </span></div><div class="line">    skin_arrange_buttons初始化皮肤按钮  webvr_onavailable()初始化设定，显示Enter VR 按钮--&gt;</div><div class="line">	</div><div class="line">    <span class="comment">&lt;!-- onentervr skin_showloading去除加载文字 webvr_setup 设置场景切换热点并跟随</span></div><div class="line">    webvr_onentervr 将所有没有添加vr="true"的layer隐藏，并显示VR的Layer skin_reloadscene_webvr</div><div class="line">    显示屏幕旋转提示图片--&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>=<span class="string">"WebVR"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">devices</span>=<span class="string">"html5"</span></span></div><div class="line">            <span class="attr">pluginurl</span>=<span class="string">"%SWFPATH%/plugins/webvr.js"</span></div><div class="line">            <span class="attr">url</span>=<span class="string">""</span></div><div class="line">            <span class="attr">multireslock.desktop</span>=<span class="string">"true"</span></div><div class="line">            <span class="attr">multireslock.mobile.or.tablet</span>=<span class="string">"false"</span></div><div class="line">            <span class="attr">mobilevr_support</span>=<span class="string">"true"</span></div><div class="line">            <span class="attr">mobilevr_fake_support</span>=<span class="string">"true"</span></div><div class="line">            <span class="attr">onavailable</span>=<span class="string">"removelayer(webvr_enterbutton); skin_arrange_buttons(); webvr_onavailable();"</span></div><div class="line">            <span class="attr">onentervr</span>=<span class="string">"skin_showloading(false); webvr_onentervr(); webvr_setup(); skin_reloadscene_webvr();"</span></div><div class="line">            <span class="attr">onexitvr</span>=<span class="string">"webvr_onexitvr(); webvr_setup(); skin_reloadscene_webvr();"</span></div><div class="line">            /&gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- webvr button style (adjust to match skin style) --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 修改WebVR界面的style使其符合当前场景的样式 主要设置背景颜色和文字 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"webvr_button_style"</span></span></div><div class="line">           <span class="attr">border</span>=<span class="string">"false"</span></div><div class="line">           <span class="attr">roundedge</span>=<span class="string">"calc:1.0"</span></div><div class="line">           <span class="attr">backgroundcolor</span>=<span class="string">"get:skin_settings.design_bgcolor"</span> <span class="attr">backgroundalpha</span>=<span class="string">"get:skin_settings.design_bgalpha"</span></div><div class="line">           <span class="attr">shadow</span>=<span class="string">"0.01"</span> <span class="attr">shadowrange</span>=<span class="string">"10.0"</span> <span class="attr">shadowangle</span>=<span class="string">"90.0"</span> <span class="attr">shadowcolor</span>=<span class="string">"0x30261B"</span> <span class="attr">shadowalpha</span>=<span class="string">"0.50"</span></div><div class="line">           <span class="attr">css</span>=<span class="string">"calc:skin_settings.design_text_css + ' color:#FFFFFF;font-size:' + 20*webvr_setup_scale*webvr_button_scale + 'px;'"</span>/&gt;<span class="xml"></span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- show a 'rotate the device' info when the mobile device is in portrait orientation in VR mode --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 显示屏幕旋转提示图片 devices="mobile" 只在手机模式下--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"webvr_rotate_to_landscape_request"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">vr</span>=<span class="string">"true"</span> <span class="attr">devices</span>=<span class="string">"mobile"</span></span></div><div class="line">           <span class="attr">url</span>=<span class="string">"rotate_device.png"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span></div><div class="line">           <span class="attr">align</span>=<span class="string">"top"</span> <span class="attr">edge</span>=<span class="string">"center"</span> <span class="attr">y</span>=<span class="string">"28%"</span></div><div class="line">           <span class="attr">autoalpha</span>=<span class="string">"true"</span> <span class="attr">alpha</span>=<span class="string">"0.0"</span></div><div class="line">           <span class="attr">enabled</span>=<span class="string">"false"</span></div><div class="line">           /&gt;</div><div class="line">    <span class="comment">&lt;!-- WebVR相关事件触发 webvr_set_startup_view 设置镜头位置 onloadcomplete根据场景数目觉得是否显示VR场景切换热点--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">events</span> <span class="attr">name</span>=<span class="string">"webvr_events"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">devices</span>=<span class="string">"html5"</span></span></div><div class="line">            <span class="attr">onxmlcomplete</span>=<span class="string">"webvr_set_startup_view()"</span></div><div class="line">            <span class="attr">onresize.mobile</span>=<span class="string">"webvr_act_as_gyro_in_portrait_mode();"</span></div><div class="line">            <span class="attr">onloadcomplete</span>=<span class="string">"delayedcall(0.5, if(webvr.isenabled AND scene.count GT 1 AND skin_settings.webvr_prev_next_hotspots, set(hotspot[webvr_prev_scene].visible,true); set(hotspot[webvr_next_scene].visible,true); ); );"</span></div><div class="line">            <span class="attr">onviewchange</span>=<span class="string">""</span></div><div class="line">            /&gt;</div><div class="line">			</div><div class="line">    <span class="comment">&lt;!-- 根据VR是否打开设置镜头位置 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"webvr_set_startup_view"</span>&gt;</span></div><div class="line">        if((webvr.isenabled OR plugin[skin_gyro].enabled) AND skin_settings.webvr_gyro_keeplookingdirection == false,</div><div class="line">            skin_lookat( get(xml.view.hlookat) );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 进入VR时设定 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"webvr_setup"</span>&gt;</span></div><div class="line">        if(webvr.isenabled,</div><div class="line">            <span class="comment">&lt;!-- 读取自定义设定 --&gt;</span></div><div class="line">            copy(loadscene_flags_backup, skin_settings.loadscene_flags);</div><div class="line">            <span class="comment">&lt;!-- 设置为 MERGE|KEEPVIEW|KEEPMOVING|NOPREVIEW--&gt;</span></div><div class="line">            set(skin_settings.loadscene_flags, MERGE|KEEPVIEW|KEEPMOVING|NOPREVIEW);</div><div class="line">            <span class="comment">&lt;!-- 打开WebVR时是否竖屏启动陀螺仪 --&gt;</span></div><div class="line">            webvr_act_as_gyro_in_portrait_mode(true);</div><div class="line">            <span class="comment">&lt;!-- 读取设置是否显示VR模式下的上下按钮 并且设置跟随--&gt;</span></div><div class="line">            if(scene.count GT 1 AND skin_settings.webvr_prev_next_hotspots,</div><div class="line">                set(hotspot[webvr_prev_scene].visible, true);</div><div class="line">                set(hotspot[webvr_next_scene].visible, true);</div><div class="line">                set(events[webvr_events].onviewchange, webvr_menu_following());</div><div class="line">              );</div><div class="line">          ,</div><div class="line">            if(loadscene_flags_backup !== null, copy(skin_settings.loadscene_flags, loadscene_flags_backup));</div><div class="line">            tween(layer[webvr_rotate_to_landscape_request].alpha, 0.0, 0.0);</div><div class="line">            set(hotspot[webvr_prev_scene].visible, false);</div><div class="line">            set(hotspot[webvr_next_scene].visible, false);</div><div class="line">            set(events[webvr_events].onviewchange, null);</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 打开WebVR时是否竖屏启动陀螺仪 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"webvr_act_as_gyro_in_portrait_mode"</span>&gt;</span></div><div class="line">        if(device.mobile AND webvr.isenabled,</div><div class="line">            div(aspect, stagewidth, stageheight);</div><div class="line">            if(aspect != lastaspect OR '%1' == 'true',</div><div class="line">                copy(lastaspect, aspect);</div><div class="line">                if(stagewidth GT stageheight,</div><div class="line">                    <span class="comment">&lt;!-- landscape orientation - use stereo rendering and a direct/fast gyro sensor mode --&gt;</span></div><div class="line">                    set(display.stereo, true);</div><div class="line">                    set(webvr.mobilevr_sensor_mode, 3);</div><div class="line">                    webvr.update();</div><div class="line">                    tween(layer[webvr_rotate_to_landscape_request].alpha, 0.0, 0.0);</div><div class="line">                  ,</div><div class="line">                    <span class="comment">&lt;!-- portrait orientation - use normal rendering and a smoother/slower gyro sensor mode --&gt;</span></div><div class="line">                    set(display.stereo, false);</div><div class="line">                    set(webvr.mobilevr_sensor_mode, 1);</div><div class="line">                    webvr.update();</div><div class="line">                    tween(layer[webvr_rotate_to_landscape_request].alpha, 1.0);</div><div class="line">                    delayedcall(3.0, tween(layer[webvr_rotate_to_landscape_request].alpha, 0.0, 1.0); );</div><div class="line">                  );</div><div class="line">              );</div><div class="line">          ,</div><div class="line">            set(lastaspect, 0);</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- VR scene switching hotspots --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- VR场景切换热点 distorted="true" 热点跟随场景扭曲--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"webvr_menu_style"</span> <span class="attr">depth</span>=<span class="string">"800"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">distorted</span>=<span class="string">"true"</span> <span class="attr">ath</span>=<span class="string">"0"</span> <span class="attr">atv</span>=<span class="string">"45"</span> <span class="attr">alpha</span>=<span class="string">"0.5"</span> /&gt;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">name</span>=<span class="string">"webvr_prev_scene"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">style</span>=<span class="string">"skin_base|webvr_menu_style"</span> <span class="attr">crop</span>=<span class="string">"0|64|64|64"</span>  <span class="attr">ox</span>=<span class="string">"-64"</span> <span class="attr">onover</span>=<span class="string">"tween(scale,0.6);"</span> <span class="attr">onout</span>=<span class="string">"tween(scale,0.5);"</span> <span class="attr">vr_timeout</span>=<span class="string">"750"</span> <span class="attr">onclick</span>=<span class="string">"skin_nextscene_loop(-1);"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">devices</span>=<span class="string">"html5.and.webgl"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">hotspot</span> <span class="attr">name</span>=<span class="string">"webvr_next_scene"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">style</span>=<span class="string">"skin_base|webvr_menu_style"</span> <span class="attr">crop</span>=<span class="string">"64|64|64|64"</span> <span class="attr">ox</span>=<span class="string">"+64"</span> <span class="attr">onover</span>=<span class="string">"tween(scale,0.6);"</span> <span class="attr">onout</span>=<span class="string">"tween(scale,0.5);"</span> <span class="attr">vr_timeout</span>=<span class="string">"750"</span> <span class="attr">onclick</span>=<span class="string">"skin_nextscene_loop(+1);"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">devices</span>=<span class="string">"html5.and.webgl"</span> /&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- floating/following VR hotspots --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 设置VR模式下跟随镜头的场景切换热点 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"webvr_menu_following"</span> <span class="attr">type</span>=<span class="string">"Javascript"</span> <span class="attr">devices</span>=<span class="string">"html5"</span>&gt;</span>&lt;![CDATA[        var hs1 = krpano.get("hotspot[webvr_prev_scene]");</div><div class="line">        var hs2 = krpano.get("hotspot[webvr_next_scene]");</div><div class="line">        //头追没有移动到热点处的时候</div><div class="line">        if(!hs1.hovering &amp;&amp; !hs2.hovering)</div><div class="line">        &#123;</div><div class="line">            var f = 0.01;   // following speed factor</div><div class="line">            var h = krpano.view.hlookat;//获取当前场景的垂直度数（垂直180°）</div><div class="line">            var v = krpano.view.vlookat;//获取当前场景的水平度数（水平360°）</div><div class="line">            var hsh = hs1.ath;</div><div class="line">            var hsv = hs1.atv;</div><div class="line">            //将度数转化为距离设置到热点上</div><div class="line">            h   = (h  -(h|0))   + (((h|0)  +360180)%360) - 180.0;</div><div class="line">            v   = (v  -(v|0))   + (((v|0)  +360180)%360) - 180.0;</div><div class="line">            hsh = (hsh-(hsh|0)) + (((hsh|0)+360180)%360) - 180.0;</div><div class="line">            var dh = h - hsh;</div><div class="line">            dh += (dh &gt; 180) ? -360 : (dh &lt; -180) ? 360 : 0</div><div class="line">            hsh += dh*f;</div><div class="line">            var a = Math.abs(v - hsv) / 90.0;</div><div class="line">            a = 1.0 * Math.max(1.0 - 2.0*Math.sqrt(a), 0);</div><div class="line">            v = v + 55.0 - v*1.5;</div><div class="line">            hsv = hsv*(1.0 - f) + v*f;</div><div class="line">            hs1.ath = hs2.ath = hsh;</div><div class="line">            hs1.atv = hs2.atv = hsv;</div><div class="line">            hs1.alpha = hs2.alpha = a;</div><div class="line">        &#125;</div><div class="line">    ]]&gt;<span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- VR support --&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin styles --&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin_base - the base skin image --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 基础样式，设置皮肤的图标文件路径 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"skin_base"</span> <span class="attr">url</span>=<span class="string">"calc:vtourskinxmlpath.url + skin_settings.design_skin_images"</span> /&gt;</span><span class="xml"></span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin_glow - button glowing (if additional ondown,onup,onout,over events are needed, this style provides ondown2,onup2,onover2,onout2 events) --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 样式属性，如果有额外的事件监听使用 ondown2,onup2,onover2,onout2 skin_buttonglow 设置按钮的点击hover效果--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"skin_glow"</span></span></div><div class="line">           <span class="attr">ondown</span>=<span class="string">"copy(skin_lockglow,name); skin_buttonglow(get(name)); if(ondown2, ondown2() );"</span></div><div class="line">           <span class="attr">onover</span>=<span class="string">"if(skin_lockglow === null, copy(skin_lockglow,name); skin_buttonglow(get(name),0.3) ); if(onover2, onover2() );"</span></div><div class="line">           <span class="attr">onout</span>=<span class="string">"if(skin_lockglow === name AND !pressed, skin_buttonglow(null);delete(skin_lockglow); ); if(onout2, onout2() );"</span></div><div class="line">           <span class="attr">onup</span>=<span class="string">"if(onup2, onup2()); delayedcall(0, if(hovering AND enabled, skin_buttonglow(get(name),0.3); , skin_buttonglow(null);delete(skin_lockglow); ); );"</span></div><div class="line">           /&gt;<span class="xml"></span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin_thumbtext_style - style/textfield for the (optional, skin_settings.thumbs_text) thumbnails texts --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 场景缩略图的文字样式 通过skin_settings.thumbs_text设定是否显示缩略图的文字--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"skin_thumbtext_style"</span> <span class="attr">url</span>=<span class="string">"%SWFPATH%/plugins/textfield.swf"</span> <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">autoheight</span>=<span class="string">"true"</span> <span class="attr">y</span>=<span class="string">"5"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> <span class="attr">background</span>=<span class="string">"false"</span> <span class="attr">border</span>=<span class="string">"false"</span> <span class="attr">css</span>=<span class="string">"calc:skin_settings.design_text_css + ' text-align:center; font-size:10px;'"</span> <span class="attr">textshadow</span>=<span class="string">"get:skin_settings.design_text_shadow"</span> /&gt;</span><span class="xml"></span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin_hotspotstyle - style for the hotspots --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 当前皮肤热点的按钮样式 如果skin_settings.tooltips_hotspots为true 则将scene的title属性值设置为热点的tips--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"skin_hotspotstyle"</span> <span class="attr">url</span>=<span class="string">"vtourskin_hotspot.png"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">edge</span>=<span class="string">"top"</span> <span class="attr">distorted</span>=<span class="string">"true"</span></span></div><div class="line">           <span class="attr">tooltip</span>=<span class="string">""</span></div><div class="line">           <span class="attr">linkedscene</span>=<span class="string">""</span></div><div class="line">           <span class="attr">linkedscene_lookat</span>=<span class="string">""</span></div><div class="line">           <span class="attr">onclick</span>=<span class="string">"skin_hotspotstyle_click();"</span></div><div class="line">           <span class="attr">onover</span>=<span class="string">"tween(scale,0.55);"</span></div><div class="line">           <span class="attr">onout</span>=<span class="string">"tween(scale,0.5);"</span></div><div class="line">           <span class="attr">onloaded</span>=<span class="string">"if(linkedscene AND skin_settings.tooltips_hotspots, copy(tooltip,scene[get(linkedscene)].title); loadstyle(skin_tooltips); );"</span></div><div class="line">           /&gt;<span class="xml"></span></div><div class="line">    <span class="comment">&lt;!-- 热点点击 读取热点的linkedscene属性设置为跳转的scene如果存在linkedscene_lookat属性则按照","切分字符分别赋值给h,v,fov</span></div><div class="line">    点击时隐藏tips 调用skin_loadscene打开场景skin_lookat旋转到指定位置--&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_hotspotstyle_click"</span>&gt;</span></div><div class="line">        if(linkedscene,</div><div class="line">            if(linkedscene_lookat,</div><div class="line">                txtsplit(linkedscene_lookat, ',', hs_lookat_h, hs_lookat_v, hs_lookat_fov);</div><div class="line">              );</div><div class="line">            set(enabled, false);</div><div class="line">            skin_hidetooltips();</div><div class="line">            tween(depth|alpha|oy|rx, 4000|0.0|-50|-60, 0.5, default,</div><div class="line">                skin_loadscene(get(linkedscene), get(skin_settings.loadscene_blend));</div><div class="line">                if(hs_lookat_h !== null,</div><div class="line">                    skin_lookat(get(hs_lookat_h), get(hs_lookat_v), get(hs_lookat_fov));</div><div class="line">                    delete(hs_lookat_h, hs_lookat_v, hs_lookat_fov);</div><div class="line">                  );</div><div class="line">                skin_updatescroll();</div><div class="line">              );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin_tooltip - style for the thumb, hotspot and mapspot tooltips --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- tips样式，当前为鼠标移动到layer读取tooltip值设置到mouse.stagex  mouse.stagey（为鼠标的topleft位置） 这个位置--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"skin_tooltips"</span></span></div><div class="line">           <span class="attr">onover.mouse</span>=<span class="string">"copy(layer[skin_tooltip].html, tooltip);</span></div><div class="line">                         set(layer[skin_tooltip].visible, true);</div><div class="line">                         tween(layer[skin_tooltip].alpha, 1.0, 0.1);</div><div class="line">                         asyncloop(hovering, copy(layer[skin_tooltip].x,mouse.stagex); copy(layer[skin_tooltip].y,mouse.stagey); );"</div><div class="line">           <span class="attr">onout.mouse</span>=<span class="string">"tween(layer[skin_tooltip].alpha, 0.0, 0.1, default, set(layer[skin_tooltip].visible,false), copy(layer[skin_tooltip].x,mouse.stagex); copy(layer[skin_tooltip].y,mouse.stagey); );"</span></div><div class="line">           /&gt;<span class="xml"></span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- the tooltip textfield --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 文字提示tips layer使用文字插件展示，这里可以修改tips的式样 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_tooltip"</span> <span class="attr">keep</span>=<span class="string">"true"</span></span></div><div class="line">           <span class="attr">url</span>=<span class="string">"%SWFPATH%/plugins/textfield.swf"</span></div><div class="line">           <span class="attr">parent</span>=<span class="string">"STAGE"</span></div><div class="line">           <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">alpha</span>=<span class="string">"0"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> <span class="attr">zorder</span>=<span class="string">"2"</span></div><div class="line">           <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">edge</span>=<span class="string">"bottom"</span> <span class="attr">oy</span>=<span class="string">"-2"</span> <span class="attr">width</span>=<span class="string">"200"</span> <span class="attr">autoheight</span>=<span class="string">"true"</span></div><div class="line">           <span class="attr">background</span>=<span class="string">"false"</span> <span class="attr">backgroundcolor</span>=<span class="string">"0xFFFFFF"</span> <span class="attr">backgroundalpha</span>=<span class="string">"1.0"</span></div><div class="line">           <span class="attr">border</span>=<span class="string">"false"</span> <span class="attr">bordercolor</span>=<span class="string">"0x000000"</span> <span class="attr">borderalpha</span>=<span class="string">"1.0"</span> <span class="attr">borderwidth</span>=<span class="string">"1.0"</span> <span class="attr">roundedge</span>=<span class="string">"0"</span></div><div class="line">           <span class="attr">shadow</span>=<span class="string">"0.0"</span> <span class="attr">shadowrange</span>=<span class="string">"4.0"</span> <span class="attr">shadowangle</span>=<span class="string">"45"</span> <span class="attr">shadowcolor</span>=<span class="string">"0x000000"</span> <span class="attr">shadowalpha</span>=<span class="string">"1.0"</span></div><div class="line">           <span class="attr">textshadow</span>=<span class="string">"get:skin_settings.design_text_shadow"</span> <span class="attr">textshadowrange</span>=<span class="string">"6.0"</span> <span class="attr">textshadowangle</span>=<span class="string">"90"</span> <span class="attr">textshadowcolor</span>=<span class="string">"0x000000"</span> <span class="attr">textshadowalpha</span>=<span class="string">"1.0"</span></div><div class="line">           <span class="attr">css</span>=<span class="string">"calc:skin_settings.design_text_css + ' text-align:center; font-size:16px;'"</span></div><div class="line">           <span class="attr">html</span>=<span class="string">""</span></div><div class="line">           /&gt;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin layout --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 下方控制条 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_layer"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"top"</span> <span class="attr">width</span>=<span class="string">"get:skin_settings.layout_width"</span> <span class="attr">maxwidth</span>=<span class="string">"get:skin_settings.layout_maxwidth"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">maskchildren</span>=<span class="string">"true"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">bgcapture</span>=<span class="string">"false"</span> <span class="attr">zorder</span>=<span class="string">"1"</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 控制条上部分包括视频控制条，缩略图展示，场景名称等 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_scroll_window"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"calc:skin_settings.controlbar_offset + skin_settings.controlbar_height - skin_settings.controlbar_overlap"</span> <span class="attr">maskchildren</span>=<span class="string">"true"</span> <span class="attr">onloaded</span>=<span class="string">"skin_calc_opened_closed();"</span> <span class="attr">zorder</span>=<span class="string">"1"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_scroll_layer"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">width</span>=<span class="string">"get:skin_settings.controlbar_width"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">x</span>=<span class="string">"200"</span> <span class="attr">y</span>=<span class="string">"200"</span> <span class="attr">y_offset</span>=<span class="string">"get:skin_settings.controlbar_overlap"</span> <span class="attr">accuracy</span>=<span class="string">"1"</span> <span class="attr">bgalpha</span>=<span class="string">"get:skin_settings.design_bgalpha"</span> <span class="attr">bgcolor</span>=<span class="string">"get:skin_settings.design_bgcolor"</span> <span class="attr">bgborder</span>=<span class="string">"get:skin_settings.design_bgborder"</span> <span class="attr">bgroundedge</span>=<span class="string">"get:skin_settings.design_bgroundedge"</span> <span class="attr">bgshadow</span>=<span class="string">"get:skin_settings.design_bgshadow"</span>&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 场景名称 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_title"</span> <span class="attr">url</span>=<span class="string">"%SWFPATH%/plugins/textfield.swf"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">edge</span>=<span class="string">"leftbottom"</span> <span class="attr">x</span>=<span class="string">"4"</span> <span class="attr">y</span>=<span class="string">"0"</span> <span class="attr">zorder</span>=<span class="string">"4"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> <span class="attr">background</span>=<span class="string">"false"</span> <span class="attr">border</span>=<span class="string">"false"</span> <span class="attr">css</span>=<span class="string">"calc:skin_settings.design_text_css + ' text-align:left; font-style:italic; font-size:12px;'"</span> <span class="attr">textshadow</span>=<span class="string">"get:skin_settings.design_text_shadow"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">onautosized</span>=<span class="string">"skin_video_updateseekbarwidth();"</span> /&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 视频控制条 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_video_controls"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">edge</span>=<span class="string">"leftbottom"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"18"</span> <span class="attr">visible</span>=<span class="string">"false"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_video_seekbar_container"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">bgcapture</span>=<span class="string">"true"</span> <span class="attr">ondown</span>=<span class="string">"skin_video_ondownseeking();"</span> &gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_video_seekbar"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">bgcolor</span>=<span class="string">"0xFFFFFF"</span> <span class="attr">bgalpha</span>=<span class="string">"0.25"</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"2"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_video_loadbar"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">bgcolor</span>=<span class="string">"0xFFFFFF"</span> <span class="attr">bgalpha</span>=<span class="string">"0.5"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">width</span>=<span class="string">"0"</span> <span class="attr">height</span>=<span class="string">"2"</span> /&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_video_seekpos"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">bgcolor</span>=<span class="string">"0xFFFFFF"</span> <span class="attr">bgalpha</span>=<span class="string">"1.0"</span> <span class="attr">align</span>=<span class="string">"left"</span> <span class="attr">edge</span>=<span class="string">"center"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">bgroundedge</span>=<span class="string">"8"</span> <span class="attr">width</span>=<span class="string">"10"</span> <span class="attr">height</span>=<span class="string">"10"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_video_time"</span> <span class="attr">url</span>=<span class="string">"%SWFPATH%/plugins/textfield.swf"</span> <span class="attr">align</span>=<span class="string">"rightbottom"</span> <span class="attr">x</span>=<span class="string">"4"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> <span class="attr">background</span>=<span class="string">"false"</span> <span class="attr">border</span>=<span class="string">"false"</span> <span class="attr">css</span>=<span class="string">"calc:skin_settings.design_text_css + ' text-align:left; font-style:italic; font-size:12px;'"</span> <span class="attr">textshadow</span>=<span class="string">"get:skin_settings.design_text_shadow"</span> <span class="attr">html</span>=<span class="string">"0:00 / 0:00"</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_scroll_container"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"0"</span> <span class="attr">bgroundedge</span>=<span class="string">"get:skin_settings.design_bgroundedge"</span> <span class="attr">maskchildren</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">                    <span class="comment">&lt;!-- 缩略图展示 --&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_thumbs_container"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">visible</span>=<span class="string">"false"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_thumbs_scrollleft"</span>  <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|64|64|64"</span>  <span class="attr">align</span>=<span class="string">"lefttop"</span>  <span class="attr">edge</span>=<span class="string">"left"</span>  <span class="attr">x</span>=<span class="string">"5"</span> <span class="attr">y</span>=<span class="string">"50"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">zorder</span>=<span class="string">"2"</span> <span class="attr">alpha</span>=<span class="string">"1.0"</span> <span class="attr">ondown2</span>=<span class="string">"asyncloop(pressed, layer[skin_thumbs].scrollby(+2,0));"</span> <span class="attr">visible</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_thumbs_scrollright"</span> <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"64|64|64|64"</span> <span class="attr">align</span>=<span class="string">"righttop"</span> <span class="attr">edge</span>=<span class="string">"right"</span> <span class="attr">x</span>=<span class="string">"5"</span> <span class="attr">y</span>=<span class="string">"50"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">zorder</span>=<span class="string">"2"</span> <span class="attr">alpha</span>=<span class="string">"1.0"</span> <span class="attr">ondown2</span>=<span class="string">"asyncloop(pressed, layer[skin_thumbs].scrollby(-2,0));"</span> <span class="attr">visible</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_thumbs_scrollindicator"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">bgcolor</span>=<span class="string">"0xFFFFFF"</span> <span class="attr">bgalpha</span>=<span class="string">"0.25"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">width</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"100"</span> <span class="attr">height</span>=<span class="string">"2"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">                        <span class="comment">&lt;!-- 滑动插件 --&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_thumbs"</span> <span class="attr">state</span>=<span class="string">"closed"</span> <span class="attr">url.flash</span>=<span class="string">"%SWFPATH%/plugins/scrollarea.swf"</span> <span class="attr">url.html5</span>=<span class="string">"%SWFPATH%/plugins/scrollarea.js"</span> <span class="attr">direction</span>=<span class="string">"h"</span> <span class="attr">align</span>=<span class="string">"top"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100"</span> <span class="attr">zorder</span>=<span class="string">"1"</span> <span class="attr">onloaded</span>=<span class="string">"skin_updatescroll();"</span> <span class="attr">onscroll</span>=<span class="string">"skin_updatethumbscroll();"</span> /&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">                    <span class="comment">&lt;!-- 地图展示 --&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_map_container"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"leftop"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">bgroundedge</span>=<span class="string">"get:skin_settings.design_bgroundedge"</span> <span class="attr">maskchildren</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_map"</span> <span class="attr">state</span>=<span class="string">"closed"</span> <span class="attr">url</span>=<span class="string">""</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"50%"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"0"</span> <span class="attr">zorder</span>=<span class="string">"1"</span> <span class="attr">lat</span>=<span class="string">"0"</span> <span class="attr">lng</span>=<span class="string">"0"</span> <span class="attr">zoom</span>=<span class="string">"10"</span> <span class="attr">bgalpha</span>=<span class="string">"0"</span> <span class="attr">maptype</span>=<span class="string">"satellite"</span> <span class="attr">onmapready</span>=<span class="string">"skin_addmapspots();"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">maptypecontrol</span> <span class="attr">visible</span>=<span class="string">"true"</span> <span class="attr">align</span>=<span class="string">"righttop"</span> <span class="attr">x</span>=<span class="string">"5"</span> <span class="attr">y</span>=<span class="string">"5"</span> <span class="attr">buttonalign</span>=<span class="string">"v"</span> <span class="attr">scale.mobile</span>=<span class="string">"1.5"</span> /&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">radar</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">headingoffset</span>=<span class="string">"0"</span> /&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">spotstyle</span> <span class="attr">name</span>=<span class="string">"DEFAULT"</span> <span class="attr">url</span>=<span class="string">"vtourskin_mapspot.png"</span> <span class="attr">activeurl</span>=<span class="string">"vtourskin_mapspotactive.png"</span> <span class="attr">edge</span>=<span class="string">"bottom"</span> <span class="attr">x</span>=<span class="string">"-5"</span> <span class="attr">y</span>=<span class="string">"-8"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> /&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_map_zoom_in"</span>  <span class="attr">style</span>=<span class="string">"skin_base"</span> <span class="attr">visible</span>=<span class="string">"get:skin_settings.maps_zoombuttons"</span> <span class="attr">crop</span>=<span class="string">"9|512|46|64"</span>  <span class="attr">align</span>=<span class="string">"right"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"-40"</span> <span class="attr">zorder</span>=<span class="string">"2"</span> <span class="attr">ondown</span>=<span class="string">"layer[skin_map].zoomin();  skin_buttonglow(get(name));"</span> <span class="attr">onup</span>=<span class="string">"skin_buttonglow(null);"</span> /&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_map_zoom_out"</span> <span class="attr">style</span>=<span class="string">"skin_base"</span> <span class="attr">visible</span>=<span class="string">"get:skin_settings.maps_zoombuttons"</span> <span class="attr">crop</span>=<span class="string">"73|512|46|64"</span> <span class="attr">align</span>=<span class="string">"right"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"+40"</span> <span class="attr">zorder</span>=<span class="string">"2"</span> <span class="attr">ondown</span>=<span class="string">"layer[skin_map].zoomout(); skin_buttonglow(get(name));"</span> <span class="attr">onup</span>=<span class="string">"skin_buttonglow(null);"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 底部控制条背景图 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_splitter_bottom"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"calc:skin_settings.controlbar_offset + skin_settings.controlbar_height - skin_settings.controlbar_overlap"</span> <span class="attr">y</span>=<span class="string">"0"</span> <span class="attr">maskchildren</span>=<span class="string">"true"</span> <span class="attr">onloaded</span>=<span class="string">"skin_calc_opened_closed();"</span> <span class="attr">zorder</span>=<span class="string">"2"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_control_bar_bg"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">width</span>=<span class="string">"get:skin_settings.controlbar_width"</span> <span class="attr">height</span>=<span class="string">"calc:skin_settings.controlbar_height + skin_settings.controlbar_overlap"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"get:skin_settings.controlbar_offset"</span> <span class="attr">bgcolor</span>=<span class="string">"get:skin_settings.design_bgcolor"</span> <span class="attr">bgalpha</span>=<span class="string">"get:skin_settings.design_bgalpha"</span> <span class="attr">bgborder</span>=<span class="string">"get:skin_settings.design_bgborder"</span> <span class="attr">bgroundedge</span>=<span class="string">"get:skin_settings.design_bgroundedge"</span> <span class="attr">bgshadow</span>=<span class="string">"get:skin_settings.design_bgshadow"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 控制按钮区域 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_control_bar"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">width</span>=<span class="string">"get:skin_settings.controlbar_width"</span> <span class="attr">height</span>=<span class="string">"calc:skin_settings.controlbar_height"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"get:skin_settings.controlbar_offset"</span> <span class="attr">onloaded</span>=<span class="string">"skin_calc_opened_closed();"</span> <span class="attr">zorder</span>=<span class="string">"3"</span>&gt;</span></div><div class="line">            <span class="comment">&lt;!-- 控制按钮 --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_control_bar_buttons"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"leftbottom"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"get:skin_settings.controlbar_height"</span>&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 前一个场景按钮 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_prev"</span>      <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|64|64|64"</span>   <span class="attr">align</span>=<span class="string">"left"</span>        <span class="attr">x</span>=<span class="string">"5"</span>    <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">alpha</span>=<span class="string">"0.5"</span>  <span class="attr">onclick</span>=<span class="string">"if(skin_settings.thumbs_loop, skin_nextscene_loop(-1), skin_nextscene(-1) );"</span> /&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 缩略图按钮，点击后调用skin_showthumbs方法动画展示缩略图--&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_thumbs"</span>    <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|128|64|64"</span>  <span class="attr">align</span>=<span class="string">"left"</span>        <span class="attr">x</span>=<span class="string">"50"</span>   <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">ondown2</span>=<span class="string">"skin_showmap(false); skin_showthumbs();"</span> /&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 地图按钮，点击后会隐藏缩略图--&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_map"</span>       <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"64|128|64|64"</span> <span class="attr">align</span>=<span class="string">"left"</span>        <span class="attr">x</span>=<span class="string">"90"</span>   <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">ondown2</span>=<span class="string">"skin_showthumbs(false); skin_showmap();"</span> <span class="attr">visible</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 导航栏包括上下左右移动放大与缩小，鼠标按下距离+或-1，抬起初始化为默认的0 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_navi"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">width</span>=<span class="string">"240"</span> <span class="attr">height</span>=<span class="string">"32"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_left"</span>  <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|192|64|64"</span>  <span class="attr">align</span>=<span class="string">"center"</span>      <span class="attr">x</span>=<span class="string">"-100"</span> <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">ondown2</span>=<span class="string">"set(hlookat_moveforce,-1);"</span> <span class="attr">onup2</span>=<span class="string">"set(hlookat_moveforce,0);"</span> /&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_right"</span> <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"64|192|64|64"</span> <span class="attr">align</span>=<span class="string">"center"</span>      <span class="attr">x</span>=<span class="string">"-60"</span>  <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">ondown2</span>=<span class="string">"set(hlookat_moveforce,+1);"</span> <span class="attr">onup2</span>=<span class="string">"set(hlookat_moveforce,0);"</span> /&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_up"</span>    <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|256|64|64"</span>  <span class="attr">align</span>=<span class="string">"center"</span>      <span class="attr">x</span>=<span class="string">"-20"</span>  <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">ondown2</span>=<span class="string">"set(vlookat_moveforce,-1);"</span> <span class="attr">onup2</span>=<span class="string">"set(vlookat_moveforce,0);"</span> /&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_down"</span>  <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"64|256|64|64"</span> <span class="attr">align</span>=<span class="string">"center"</span>      <span class="attr">x</span>=<span class="string">"+20"</span>  <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">ondown2</span>=<span class="string">"set(vlookat_moveforce,+1);"</span> <span class="attr">onup2</span>=<span class="string">"set(vlookat_moveforce,0);"</span> /&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_in"</span>    <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|320|64|64"</span>  <span class="attr">align</span>=<span class="string">"center"</span>      <span class="attr">x</span>=<span class="string">"+60"</span>  <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">ondown2</span>=<span class="string">"set(fov_moveforce,-1);"</span>     <span class="attr">onup2</span>=<span class="string">"set(fov_moveforce,0);"</span> /&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_out"</span>   <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"64|320|64|64"</span> <span class="attr">align</span>=<span class="string">"center"</span>      <span class="attr">x</span>=<span class="string">"+100"</span> <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">ondown2</span>=<span class="string">"set(fov_moveforce,+1);"</span>     <span class="attr">onup2</span>=<span class="string">"set(fov_moveforce,0);"</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 开启或关闭陀螺仪按钮 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_gyro"</span>      <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|384|64|64"</span>  <span class="attr">align</span>=<span class="string">"center"</span>      <span class="attr">x</span>=<span class="string">"+140"</span> <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">onclick</span>=<span class="string">"switch(plugin[skin_gyro].enabled); if(plugin[skin_gyro].enabled, skin_showmap(false));"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">devices</span>=<span class="string">"html5"</span> /&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 进入VR模式按钮 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_vr"</span>        <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|0|80|64"</span>    <span class="attr">align</span>=<span class="string">"center"</span>      <span class="attr">x</span>=<span class="string">"+146"</span> <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">onclick</span>=<span class="string">"webvr.enterVR();"</span> <span class="attr">visible</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 全屏按钮 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_fs"</span>        <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|576|64|64"</span>  <span class="attr">align</span>=<span class="string">"right"</span>       <span class="attr">x</span>=<span class="string">"90"</span>   <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">onclick</span>=<span class="string">"switch(fullscreen);"</span> <span class="attr">devices</span>=<span class="string">"fullscreensupport"</span> /&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 隐藏控制条按钮 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_hide"</span>      <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|448|64|64"</span>  <span class="attr">align</span>=<span class="string">"right"</span>       <span class="attr">x</span>=<span class="string">"50"</span>   <span class="attr">y</span>=<span class="string">"0"</span>  <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">onclick</span>=<span class="string">"skin_hideskin()"</span> /&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 显示控制条按钮 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_show"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">bgcapture</span>=<span class="string">"true"</span> <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"get:skin_settings.controlbar_height"</span> <span class="attr">y</span>=<span class="string">"calc:skin_settings.controlbar_height - skin_settings.controlbar_offset_closed"</span> <span class="attr">onclick</span>=<span class="string">"skin_showskin()"</span> <span class="attr">onhover</span>=<span class="string">"tween(alpha,1.0);"</span> <span class="attr">onout</span>=<span class="string">"tween(alpha,0.25);"</span> <span class="attr">ondown.touch</span>=<span class="string">"onhover();"</span> <span class="attr">onup.touch</span>=<span class="string">"onout();"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">capture</span>=<span class="string">"false"</span> <span class="attr">alpha</span>=<span class="string">"0.0"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_show_icon"</span> <span class="attr">style</span>=<span class="string">"skin_base"</span> <span class="attr">crop</span>=<span class="string">"64|448|64|64"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">align</span>=<span class="string">"bottom"</span> <span class="attr">y</span>=<span class="string">"2"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 下一个场景按钮 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_next"</span>      <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"64|64|64|64"</span>  <span class="attr">align</span>=<span class="string">"right"</span>       <span class="attr">x</span>=<span class="string">"5"</span>    <span class="attr">y</span>=<span class="string">"0"</span>   <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">alpha</span>=<span class="string">"0.5"</span>  <span class="attr">onclick</span>=<span class="string">"if(skin_settings.thumbs_loop, skin_nextscene_loop(+1), skin_nextscene(+1) );"</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 显示加载中文字图层 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_loadingtext"</span> <span class="attr">url</span>=<span class="string">"%SWFPATH%/plugins/textfield.swf"</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">x</span>=<span class="string">"5"</span> <span class="attr">y</span>=<span class="string">"-5"</span> <span class="attr">html</span>=<span class="string">"get:skin_settings.loadingtext"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">autoheight</span>=<span class="string">"true"</span> <span class="attr">background</span>=<span class="string">"false"</span> <span class="attr">border</span>=<span class="string">"false"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> <span class="attr">css</span>=<span class="string">"calc:skin_settings.design_text_css + ' text-align:center; font-style:italic; font-size:22px;'"</span> <span class="attr">textshadow</span>=<span class="string">"get:skin_settings.design_text_shadow"</span> /&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 发光的背景图片，用于按钮点击效果 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_buttonglow"</span>  <span class="attr">style</span>=<span class="string">"skin_base"</span> <span class="attr">crop</span>=<span class="string">"64|384|64|64"</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">x</span>=<span class="string">"0"</span> <span class="attr">y</span>=<span class="string">"1"</span> <span class="attr">scale</span>=<span class="string">"1.0"</span> <span class="attr">alpha</span>=<span class="string">"0.0"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 缩略图选择边框效果 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_thumbborder"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">x</span>=<span class="string">"get:skin_settings.design_thumbborder_padding"</span> <span class="attr">y</span>=<span class="string">"get:skin_settings.design_thumbborder_padding"</span> <span class="attr">width</span>=<span class="string">"calc:skin_settings.thumbs_width - 2*skin_settings.design_thumbborder_padding"</span> <span class="attr">height</span>=<span class="string">"calc:skin_settings.thumbs_height - 2*skin_settings.design_thumbborder_padding"</span> <span class="attr">visible</span>=<span class="string">"false"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span> <span class="attr">bgborder</span>=<span class="string">"get:skin_settings.design_thumbborder_bgborder"</span> <span class="attr">bgroundedge</span>=<span class="string">"get:skin_settings.design_thumbborder_bgroundedge"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- previous/next scene buttons for the hidden skin mode --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 隐藏控制条时显示的用于场景切换的按钮 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_prev_fs"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"lefttop"</span>  <span class="attr">x</span>=<span class="string">"-50"</span> <span class="attr">width</span>=<span class="string">"40"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">bgcapture</span>=<span class="string">"true"</span> <span class="attr">alpha</span>=<span class="string">"0.25"</span> <span class="attr">capture</span>=<span class="string">"false"</span> <span class="attr">zorder</span>=<span class="string">"2"</span> <span class="attr">onclick</span>=<span class="string">"skin_nextscene_loop(-1);"</span> <span class="attr">onhover</span>=<span class="string">"tween(alpha,1.0);"</span> <span class="attr">onout</span>=<span class="string">"tween(alpha,0.25);"</span> <span class="attr">ondown.touch</span>=<span class="string">"onhover();"</span> <span class="attr">onup.touch</span>=<span class="string">"onout();"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_prev_fs_icon"</span> <span class="attr">style</span>=<span class="string">"skin_base"</span> <span class="attr">crop</span>=<span class="string">"0|64|64|64"</span>  <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_next_fs"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">type</span>=<span class="string">"container"</span> <span class="attr">align</span>=<span class="string">"righttop"</span> <span class="attr">x</span>=<span class="string">"-50"</span> <span class="attr">width</span>=<span class="string">"40"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">bgcapture</span>=<span class="string">"true"</span> <span class="attr">alpha</span>=<span class="string">"0.25"</span> <span class="attr">capture</span>=<span class="string">"false"</span> <span class="attr">zorder</span>=<span class="string">"2"</span> <span class="attr">onclick</span>=<span class="string">"skin_nextscene_loop(+1);"</span> <span class="attr">onhover</span>=<span class="string">"tween(alpha,1.0);"</span> <span class="attr">onout</span>=<span class="string">"tween(alpha,0.25);"</span> <span class="attr">ondown.touch</span>=<span class="string">"onhover();"</span> <span class="attr">onup.touch</span>=<span class="string">"onout();"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_btn_next_fs_icon"</span> <span class="attr">style</span>=<span class="string">"skin_base"</span> <span class="attr">crop</span>=<span class="string">"64|64|64|64"</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">scale</span>=<span class="string">"0.5"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">layer</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- gyro plugin --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 陀螺仪插件 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>=<span class="string">"skin_gyro"</span> <span class="attr">keep</span>=<span class="string">"true"</span> <span class="attr">url</span>=<span class="string">""</span> <span class="attr">html5_url</span>=<span class="string">"%SWFPATH%/plugins/gyro2.js"</span> <span class="attr">softstart</span>=<span class="string">"1.0"</span> <span class="attr">enabled</span>=<span class="string">"false"</span> <span class="attr">onavailable</span>=<span class="string">"skin_arrange_buttons();"</span> <span class="attr">devices</span>=<span class="string">"html5"</span> /&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin events --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 皮肤的事件 </span></div><div class="line">    onxmlcomplete XML加载完成后清除当前事件，调用第一个函数skin_startup</div><div class="line">    onnewpano 加载新场景时skin_showloading显示加载中文字 skin_update_scene_infos 根据URL重新设定初始位置等信息</div><div class="line">    onloadcomplete 加载完成后隐藏加载中文字</div><div class="line">    onidle 空闲时执行URL的信息更新</div><div class="line">    onresize 屏幕尺寸变化时执行一次skin_onresize，当每次加载新的pano时onresize也会被触发一次</div><div class="line">    onenterfullscreen onexitfullscreen 进入退出全屏时更新全屏按钮的图标</div><div class="line">    onkeydown 监听键盘事件--&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">events</span> <span class="attr">name</span>=<span class="string">"skin_events"</span> <span class="attr">keep</span>=<span class="string">"true"</span></span></div><div class="line">            <span class="attr">onxmlcomplete</span>=<span class="string">"set(events[skin_events].onxmlcomplete,null); skin_startup();"</span></div><div class="line">            <span class="attr">onnewpano</span>=<span class="string">"skin_showloading(true); skin_update_scene_infos(); skin_deeplinking_update_url();"</span></div><div class="line">            <span class="attr">onremovepano</span>=<span class="string">"skin_showloading(true);"</span></div><div class="line">            <span class="attr">onloadcomplete</span>=<span class="string">"skin_showloading(false);"</span></div><div class="line">            <span class="attr">onidle</span>=<span class="string">"skin_deeplinking_update_url();"</span></div><div class="line">            <span class="attr">onresize</span>=<span class="string">"skin_onresize();"</span></div><div class="line">            <span class="attr">onenterfullscreen.fullscreensupport</span>=<span class="string">"set(layer[skin_btn_fs].crop, '64|576|64|64');"</span></div><div class="line">            <span class="attr">onexitfullscreen.fullscreensupport</span>=<span class="string">"set(layer[skin_btn_fs].crop, '0|576|64|64');"</span></div><div class="line">            <span class="attr">onkeydown</span>=<span class="string">"skin_keydown_event();"</span></div><div class="line">            /&gt;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin actions --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 当前皮肤的启动函数 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_startup"</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- apply skin settings on startup --&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 根据设置确定缩略图是否在打开时就显示，并且设定是否可拖拽，鼠标的情况下设置为滚动 --&gt;</span></div><div class="line">        if(skin_settings.thumbs,</div><div class="line">            if(skin_settings.thumbs_opened, set(layer[skin_thumbs].state,'opened'); set(layer[skin_thumbs_container].visible,true); );</div><div class="line">            copy(layer[skin_thumbs].draggable, skin_settings.thumbs_dragging);</div><div class="line">            if(skin_settings.thumbs_onhoverscrolling AND device.mouse,</div><div class="line">                set(layer[skin_thumbs].draggable, false);</div><div class="line">                set(layer[skin_thumbs].onhover_autoscrolling, true);</div><div class="line">              );</div><div class="line">          );</div><div class="line">        <span class="comment">&lt;!-- html5的情况下加载陀螺仪插件 --&gt;</span></div><div class="line">        if(skin_settings.gyro AND !device.desktop AND device.html5,</div><div class="line">            copy(plugin[skin_gyro].url, plugin[skin_gyro].html5_url);</div><div class="line">          );</div><div class="line">        <span class="comment">&lt;!-- html5并且支持WebVR的情况下加载WebVR插件 --&gt;</span></div><div class="line">        if(skin_settings.webvr AND device.html5 AND device.webgl,</div><div class="line">            copy(plugin[WebVR].url, plugin[WebVR].pluginurl);</div><div class="line">          );</div><div class="line">        <span class="comment">&lt;!-- 是否显示地图插件 --&gt;</span></div><div class="line">        if(skin_settings.maps == true,</div><div class="line">            set(layer[skin_btn_map].visible, true);</div><div class="line"></div><div class="line">            if(device.flash,</div><div class="line">                copy(layer[skin_map].key, skin_settings.maps_bing_api_key);</div><div class="line">                set(layer[skin_map].url, '%SWFPATH%/plugins/bingmaps.swf');</div><div class="line">              ,</div><div class="line">                if(skin_settings.maps_type == 'bing',</div><div class="line">                    copy(layer[skin_map].key, skin_settings.maps_bing_api_key);</div><div class="line">                    set(layer[skin_map].url, '%SWFPATH%/plugins/bingmaps.js');</div><div class="line">                  ,</div><div class="line">                    copy(layer[skin_map].key, skin_settings.maps_google_api_key);</div><div class="line">                    set(layer[skin_map].url, '%SWFPATH%/plugins/googlemaps.js');</div><div class="line">                  );</div><div class="line">              );</div><div class="line">          );</div><div class="line">        <span class="comment">&lt;!-- 小行星入场方式，只有支持WebGL和flash的情况下才可以 --&gt;</span></div><div class="line">        if(skin_settings.littleplanetintro AND (device.webgl OR device.flash),</div><div class="line">            skin_setup_littleplanetintro();</div><div class="line">          );</div><div class="line">        <span class="comment">&lt;!-- 增加缩略图 --&gt;</span></div><div class="line">        skin_addthumbs();</div><div class="line">        <span class="comment">&lt;!-- 调用onresize --&gt;</span></div><div class="line">        skin_onresize();</div><div class="line">        <span class="comment">&lt;!-- skin_updatescroll --&gt;</span></div><div class="line">        skin_updatescroll();</div><div class="line">        <span class="comment">&lt;!-- 显示下方控制条 --&gt;</span></div><div class="line">        set(layer[skin_layer].visible, true);</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 增加缩略图 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_addthumbs"</span>&gt;</span></div><div class="line">        if(skin_settings.thumbs == false,</div><div class="line">            set(layer[skin_btn_thumbs].visible,false);</div><div class="line">          ,</div><div class="line">            copy(thumbwidth, skin_settings.thumbs_width);</div><div class="line">            copy(thumbheight, skin_settings.thumbs_height);</div><div class="line">            copy(thumbpadding, skin_settings.thumbs_padding);</div><div class="line">            copy(thumbcrop, skin_settings.thumbs_crop);</div><div class="line"></div><div class="line">            add(thumbxoffset, thumbwidth, thumbpadding);</div><div class="line">            mul(thumbxcenter, thumbxoffset, 0.5);</div><div class="line">            mul(thumbbarwidth, thumbxoffset, scene.count);</div><div class="line">            add(thumbbarwidth, thumbpadding);</div><div class="line">            add(thumbbarheight, thumbpadding, thumbheight);</div><div class="line">            add(thumbbarheight, thumbpadding);</div><div class="line"></div><div class="line">            if(skin_settings.thumbs_scrollindicator,</div><div class="line">                copy(layer[skin_thumbs_scrollindicator].y, thumbbarheight);</div><div class="line">                add(thumbbarheight, layer[skin_thumbs_scrollindicator].height);</div><div class="line">            );</div><div class="line"></div><div class="line">            copy(layer[skin_thumbs].height, thumbbarheight);</div><div class="line">            copy(layer[skin_thumbs].width, thumbbarwidth);</div><div class="line"></div><div class="line">            mul(halfheight, thumbbarheight, 0.5);</div><div class="line">            copy(layer[skin_thumbs_scrollleft].y, halfheight);</div><div class="line">            copy(layer[skin_thumbs_scrollright].y, halfheight);</div><div class="line">            <span class="comment">&lt;!-- 遍历所有scene并且根据序号设置缩略图名称，并且根据设置添加缩略图文字 --&gt;</span></div><div class="line">            set(thumb_cnt,0);</div><div class="line">            for(set(i,0), i LT scene.count, inc(i),</div><div class="line">                inc(thumb_cnt);</div><div class="line">                txtadd(thumbname,'skin_thumb_',get(i));</div><div class="line">                addlayer(get(thumbname));</div><div class="line">                copy(layer[get(thumbname)].url, scene[get(i)].thumburl);</div><div class="line">                set(layer[get(thumbname)].keep, true);</div><div class="line">                set(layer[get(thumbname)].parent, 'skin_thumbs');</div><div class="line">                set(layer[get(thumbname)].align, lefttop);</div><div class="line">                copy(layer[get(thumbname)].crop, thumbcrop);</div><div class="line">                copy(layer[get(thumbname)].width, thumbwidth);</div><div class="line">                copy(layer[get(thumbname)].height, thumbheight);</div><div class="line">                mul(thumbx, i, thumbxoffset);</div><div class="line">                add(thumbx, thumbpadding);</div><div class="line">                copy(layer[get(thumbname)].x, thumbx);</div><div class="line">                copy(layer[get(thumbname)].y, thumbpadding);</div><div class="line">                add(scene[get(i)].thumbx, thumbx, thumbxcenter);</div><div class="line">                copy(scene[get(i)].thumby, thumbpadding);</div><div class="line">                set(layer[get(thumbname)].linkedscene, get(scene[get(i)].name) );</div><div class="line">                set(layer[get(thumbname)].onclick, copy(layer[skin_thumbborder].parent, name); skin_loadscene(get(linkedscene),get(skin_settings.loadscene_blend)); );</div><div class="line">                if(skin_settings.tooltips_thumbs,</div><div class="line">                    set(layer[get(thumbname)].tooltip, get(scene[get(i)].title) );</div><div class="line">                    layer[get(thumbname)].loadstyle(skin_tooltips);</div><div class="line">                  );</div><div class="line">                if(skin_settings.thumbs_text,</div><div class="line">                    txtadd(thumbtext, 'skin_thumbtext_', get(i));</div><div class="line">                    addlayer(get(thumbtext));</div><div class="line">                    layer[get(thumbtext)].loadstyle(skin_thumbtext_style);</div><div class="line">                    set(layer[get(thumbtext)].keep, true);</div><div class="line">                    set(layer[get(thumbtext)].parent, get(thumbname));</div><div class="line">                    set(layer[get(thumbtext)].html, get(scene[get(i)].title));</div><div class="line">                  );</div><div class="line">               );</div><div class="line"></div><div class="line">            if(thumb_cnt == 1,</div><div class="line">                set(layer[skin_thumbs].align, 'lefttop');</div><div class="line">              );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 设置地图热点 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_addmapspots"</span>&gt;</span></div><div class="line">        for(set(i,0), i LT scene.count, inc(i),</div><div class="line">            if(scene[get(i)].lat,</div><div class="line">                txtadd(spotname, 'spot', get(i));</div><div class="line">                txtadd(spotclickevent, 'skin_hidetooltips(); activatespot(',get(spotname),'); skin_loadscene(', get(scene[get(i)].name), ',get(skin_settings.loadscene_blend)); skin_updatescroll(); delayedcall(0.5,skin_showmap(false));');</div><div class="line">                copy(scene[get(i)].mapspotname, spotname);</div><div class="line">                addspot(get(spotname), get(scene[get(i)].lat), get(scene[get(i)].lng), get(scene[get(i)].heading), false, get(spotclickevent), null);</div><div class="line">                if(skin_settings.tooltips_mapspots,</div><div class="line">                    set(layer[skin_map].spot[get(spotname)].tooltip, get(scene[get(i)].title) );</div><div class="line">                    txtadd(layer[skin_map].spot[get(spotname)].onover, 'set(hovering,true);',  get(style[skin_tooltips].onover) );</div><div class="line">                    txtadd(layer[skin_map].spot[get(spotname)].onout,  'set(hovering,false);', get(style[skin_tooltips].onout)  );</div><div class="line">                  );</div><div class="line">              );</div><div class="line">          );</div><div class="line"></div><div class="line">        if(xml.scene != null,</div><div class="line">            activatespot( get(scene[get(xml.scene)].mapspotname) );</div><div class="line">          ,</div><div class="line">            activatespot(spot0);</div><div class="line">          );</div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- zoom and pan the map to see all spots at the same time --&gt;</span></div><div class="line">        zoomToSpotsExtent();</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 小行星入场方式 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_setup_littleplanetintro"</span>&gt;</span></div><div class="line">        copy(lp_scene, xml.scene);</div><div class="line">        copy(lp_hlookat, view.hlookat);</div><div class="line">        copy(lp_vlookat, view.vlookat);</div><div class="line">        copy(lp_fov, view.fov);</div><div class="line">        copy(lp_fovmax, view.fovmax);</div><div class="line">        copy(lp_limitview, view.limitview);</div><div class="line">        set(view.fovmax, 170);</div><div class="line">        set(view.limitview, lookto);</div><div class="line">        set(view.vlookatmin, 90);</div><div class="line">        set(view.vlookatmax, 90);</div><div class="line">        lookat(calc(lp_hlookat - 180), 90, 150, 1, 0, 0);</div><div class="line">        set(events[lp_events].onloadcomplete,</div><div class="line">            delayedcall(0.5,</div><div class="line">                if(lp_scene === xml.scene,</div><div class="line">                    set(control.usercontrol, off);</div><div class="line">                    copy(view.limitview, lp_limitview);</div><div class="line">                    set(view.vlookatmin, null);</div><div class="line">                    set(view.vlookatmax, null);</div><div class="line">                    tween(view.hlookat|view.vlookat|view.fov|view.distortion, calc('' + lp_hlookat + '|' + lp_vlookat + '|' + lp_fov + '|' + 0.0),</div><div class="line">                        3.0, easeOutQuad,</div><div class="line">                        set(control.usercontrol, all);</div><div class="line">                        tween(view.fovmax, get(lp_fovmax));</div><div class="line">                        );</div><div class="line">                  );</div><div class="line">              );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 跳转到指定的视角，VR模式下要同时更新切换热点的位置 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_lookat"</span>&gt;</span></div><div class="line">        if(webvr.isenabled,</div><div class="line">            <span class="comment">&lt;!-- adjust the VR prev/next hotspots for the view change --&gt;</span></div><div class="line">            calc(hlookat_offset, %1 - view.hlookat);</div><div class="line">            add(hotspot[webvr_prev_scene].ath, hlookat_offset);</div><div class="line">            add(hotspot[webvr_next_scene].ath, hlookat_offset);</div><div class="line">          );</div><div class="line">        if(plugin[skin_gyro].enabled,</div><div class="line">            <span class="comment">&lt;!-- reset the gyro tracking --&gt;</span></div><div class="line">            plugin[skin_gyro].resetsensor(%1);</div><div class="line">          );</div><div class="line">        <span class="comment">&lt;!-- change the view --&gt;</span></div><div class="line">        lookat(%1, %2, %3);</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 皮肤重置位置 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_onresize"</span>&gt;</span></div><div class="line">        mul(mh, area.pixelheight, -1);</div><div class="line">        if(layer[skin_thumbs].state == 'opened', add(mh,layer[skin_thumbs].height); );</div><div class="line">        if(layer[skin_map].state    == 'opened', sub(hh,area.pixelheight,skin_settings.controlbar_offset); sub(hh,layer[skin_control_bar].height); sub(hh,32); add(mh,hh); add(mh,skin_settings.controlbar_overlap); sub(mh, layer[skin_scroll_layer].y_offset); copy(layer[skin_map].height, hh); );</div><div class="line">        add(mh, layer[skin_scroll_layer].y_offset);</div><div class="line">        set(layer[skin_scroll_layer].y, get(mh));</div><div class="line">        skin_video_updateseekbarwidth();</div><div class="line">        skin_arrange_buttons();</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- determine the visibility of the buttons and calculate their positions --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 判断是否显示按钮并且计算他们的位置 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_arrange_buttons"</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 通过场景树是否大于1确定是否显示场景切换按钮 --&gt;</span></div><div class="line">        calc(show_selbuttons, scene.count GT 1);</div><div class="line">        calc(show_thumbutton, skin_settings.thumbs == true);</div><div class="line">        calc(show_mapbutton,  skin_settings.maps == true);</div><div class="line">        calc(show_gyrobutton, plugin[skin_gyro].available == true AND (view.vlookatrange == 180 OR lp_scene === xml.scene));</div><div class="line">        calc(show_vrbutton,   webvr.isavailable == true);</div><div class="line">        calc(show_fsbutton,   device.fullscreensupport == true);</div><div class="line"></div><div class="line">        set(lpos,6);</div><div class="line">        set(cpos,0);</div><div class="line">        if(show_gyrobutton, dec(cpos,20));</div><div class="line">        if(show_vrbutton, dec(cpos,24));</div><div class="line">        set(rpos,6);</div><div class="line">        <span class="comment">&lt;!-- 非手机且展示宽度去除VR和陀螺仪按钮宽度后大于520时显示方向控制按钮 --&gt;</span></div><div class="line">        calc(show_dirbuttons, !device.mobile AND ((area.pixelwidth + 2*cpos) GT 520));</div><div class="line"></div><div class="line">        copy(layer[skin_btn_navi].visible, show_dirbuttons);</div><div class="line"></div><div class="line">        copy(layer[skin_btn_prev].visible, show_selbuttons);</div><div class="line">        copy(layer[skin_btn_next].visible, show_selbuttons);</div><div class="line">        if(show_selbuttons, inc(lpos,44); inc(rpos,44); );</div><div class="line"></div><div class="line">        copy(layer[skin_btn_thumbs].visible, show_thumbutton);</div><div class="line">        copy(layer[skin_btn_thumbs].x, lpos);</div><div class="line">        if(show_thumbutton, inc(lpos,40));</div><div class="line"></div><div class="line">        copy(layer[skin_btn_map].visible, show_mapbutton);</div><div class="line">        copy(layer[skin_btn_map].x, lpos);</div><div class="line">        if(show_mapbutton, inc(lpos,40));</div><div class="line">        <span class="comment">&lt;!-- 如果贤惠方向控制按钮需要重新设置按钮的列方式 --&gt;</span></div><div class="line">        if(show_dirbuttons,</div><div class="line">            copy(layer[skin_btn_navi].x, cpos);</div><div class="line">            inc(cpos,140);</div><div class="line"></div><div class="line">            set(layer[skin_btn_gyro].align, center);</div><div class="line">            copy(layer[skin_btn_gyro].visible, show_gyrobutton);</div><div class="line">            copy(layer[skin_btn_gyro].x, cpos);</div><div class="line">            if(show_gyrobutton, inc(cpos,48));</div><div class="line"></div><div class="line">            set(layer[skin_btn_vr].align, center);</div><div class="line">            copy(layer[skin_btn_vr].visible, show_vrbutton);</div><div class="line">            copy(layer[skin_btn_vr].x, cpos);</div><div class="line">            if(show_vrbutton, inc(cpos,80));</div><div class="line">          ,</div><div class="line">            set(layer[skin_btn_gyro].align, left);</div><div class="line">            copy(layer[skin_btn_gyro].visible, show_gyrobutton);</div><div class="line">            copy(layer[skin_btn_gyro].x, lpos);</div><div class="line">            if(show_gyrobutton, inc(lpos,40));</div><div class="line"></div><div class="line">            set(layer[skin_btn_vr].align, left);</div><div class="line">            copy(layer[skin_btn_vr].visible, show_vrbutton);</div><div class="line">            copy(layer[skin_btn_vr].x, lpos);</div><div class="line">            if(show_vrbutton, inc(lpos,80));</div><div class="line">          );</div><div class="line"></div><div class="line">        copy(layer[skin_btn_hide].x, rpos);</div><div class="line">        inc(rpos,40);</div><div class="line"></div><div class="line">        copy(layer[skin_btn_fs].visible, show_fsbutton);</div><div class="line">        copy(layer[skin_btn_fs].x, rpos);</div><div class="line">        if(show_fsbutton, inc(rpos,40));</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 将当前的scene缩略图设置到正中央 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_updatescroll"</span>&gt;</span></div><div class="line">        if(layer[skin_thumbs].loaded,</div><div class="line">            set(cursceneindex, 0);</div><div class="line">            if(xml.scene, copy(cursceneindex, scene[get(xml.scene)].index));</div><div class="line">            layer[skin_thumbs].setcenter(get(scene[get(cursceneindex)].thumbx), get(scene[get(cursceneindex)].thumby));</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 更新滑动组件 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_updatethumbscroll"</span>&gt;</span></div><div class="line">        copy(padding,skin_settings.thumbs_padding);</div><div class="line"></div><div class="line">        if(skin_settings.thumbs_scrollbuttons,</div><div class="line">            if(loverflow GT 0, set(layer[skin_thumbs_scrollleft].visible,true),  set(layer[skin_thumbs_scrollleft].visible,false) );</div><div class="line">            if(roverflow GT 0, set(layer[skin_thumbs_scrollright].visible,true), set(layer[skin_thumbs_scrollright].visible,false) );</div><div class="line">          );</div><div class="line"></div><div class="line">        if(skin_settings.thumbs_scrollindicator,</div><div class="line">            if(woverflow GT 0,</div><div class="line">                set(layer[skin_thumbs_scrollindicator].visible,true);</div><div class="line">                sub(iw,pixelwidth,woverflow);</div><div class="line">                div(pw,iw,pixelwidth);</div><div class="line">                div(px,loverflow,woverflow);</div><div class="line">                mul(pw,iw);</div><div class="line">                copy(layer[skin_thumbs_scrollindicator].width,pw);</div><div class="line">                sub(iw,pw);</div><div class="line">                sub(iw,padding);</div><div class="line">                sub(iw,padding);</div><div class="line">                mul(px,iw);</div><div class="line">                add(px,padding);</div><div class="line">                copy(layer[skin_thumbs_scrollindicator].x,px);</div><div class="line">              ,</div><div class="line">                set(layer[skin_thumbs_scrollindicator].visible,false);</div><div class="line">              );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 更新场景信息 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_update_scene_infos"</span>&gt;</span></div><div class="line">        if(xml.scene !== null AND scene[get(xml.scene)].index GE 0,</div><div class="line">            <span class="comment">&lt;!-- 设置场景名称 --&gt;</span></div><div class="line">            if(skin_settings.title,</div><div class="line">                if(title, txtadd(layer[skin_title].html, get(title), ' - ', get(scene[get(xml.scene)].title) ); , copy(layer[skin_title].html, scene[get(xml.scene)].title ); );</div><div class="line">                delayedcall(0.1, set(layer[skin_title].visible,true) );</div><div class="line">              );</div><div class="line">            <span class="comment">&lt;!-- 如果不循环根据当前场景的序号设置切换按钮显示 --&gt;</span></div><div class="line">            if(skin_settings.thumbs_loop == false,</div><div class="line">                if(scene[get(xml.scene)].index GT 0,</div><div class="line">                    set(layer[skin_btn_prev].enabled, true);</div><div class="line">                    set(layer[skin_btn_prev].alpha, 1.0);</div><div class="line">                  ,</div><div class="line">                    set(layer[skin_btn_prev].enabled, false);</div><div class="line">                    set(layer[skin_btn_prev].alpha, 0.3);</div><div class="line">                  );</div><div class="line"></div><div class="line">                sub(lastsceneindex, scene.count, 1);</div><div class="line">                if(scene[get(xml.scene)].index LT lastsceneindex,</div><div class="line">                    set(layer[skin_btn_next].enabled, true);</div><div class="line">                    set(layer[skin_btn_next].alpha, 1.0);</div><div class="line">                  ,</div><div class="line">                    set(layer[skin_btn_next].enabled, false);</div><div class="line">                    set(layer[skin_btn_next].alpha, 0.3);</div><div class="line">                  );</div><div class="line">              ,</div><div class="line">                if(scene.count GT 1,</div><div class="line">                    set(layer[skin_btn_prev].enabled, true);</div><div class="line">                    set(layer[skin_btn_prev].alpha, 1.0);</div><div class="line">                    set(layer[skin_btn_next].enabled, true);</div><div class="line">                    set(layer[skin_btn_next].alpha, 1.0);</div><div class="line">                  ,</div><div class="line">                    set(layer[skin_btn_prev].enabled, false);</div><div class="line">                    set(layer[skin_btn_prev].alpha, 0.3);</div><div class="line">                    set(layer[skin_btn_next].enabled, false);</div><div class="line">                    set(layer[skin_btn_next].alpha, 0.3);</div><div class="line">                  );</div><div class="line">              );</div><div class="line"></div><div class="line">            if(scene.count GT 1,</div><div class="line">                set(layer[skin_btn_prev_fs].visible, true);</div><div class="line">                set(layer[skin_btn_next_fs].visible, true);</div><div class="line">              ,</div><div class="line">                set(layer[skin_btn_prev_fs].visible, false);</div><div class="line">                set(layer[skin_btn_next_fs].visible, false);</div><div class="line">              );</div><div class="line">            <span class="comment">&lt;!-- 设置当前场景的缩略图为选中式样 --&gt;</span></div><div class="line">            txtadd(parentname, 'skin_thumb_', get(scene[get(xml.scene)].index));</div><div class="line">            if(layer[get(parentname)],</div><div class="line">                set(layer[skin_thumbborder].parent, get(parentname));</div><div class="line">                set(layer[skin_thumbborder].visible, true);</div><div class="line">              ,</div><div class="line">                set(layer[skin_thumbborder].visible, false);</div><div class="line">              );</div><div class="line"></div><div class="line">            if(scene[get(xml.scene)].mapspotname,</div><div class="line">                layer[skin_map].activatespot(get(scene[get(xml.scene)].mapspotname));</div><div class="line">                layer[skin_map].pantospot(get(scene[get(xml.scene)].mapspotname));</div><div class="line">              );</div><div class="line">            <span class="comment">&lt;!-- 设置陀螺仪按钮是否显示 --&gt;</span></div><div class="line">            if(plugin[skin_gyro].isavailable == true AND view.vlookatrange == 180,</div><div class="line">                set(layer[skin_btn_gyro].visible, true);</div><div class="line">              ,</div><div class="line">                set(layer[skin_btn_gyro].visible, false)</div><div class="line">              );</div><div class="line">            <span class="comment">&lt;!-- 设置反弹效果 --&gt;</span></div><div class="line">            if(view.vlookatrange LT 180,</div><div class="line">                if(backup_control_bouncinglimits === null,</div><div class="line">                    copy(backup_control_bouncinglimits, control.bouncinglimits);</div><div class="line">                  );</div><div class="line">                set(control.bouncinglimits, false);</div><div class="line">              ,</div><div class="line">                if(backup_control_bouncinglimits !== null,</div><div class="line">                    copy(control.bouncinglimits, backup_control_bouncinglimits);</div><div class="line">                  );</div><div class="line">              );</div><div class="line">            <span class="comment">&lt;!-- 如果当前场景为视频则加载视频控制条 --&gt;</span></div><div class="line">            if(scene[get(xml.scene)].isvideopano AND plugin[video] !== null,</div><div class="line">                skin_video_addcontrols();</div><div class="line">              ,</div><div class="line">                skin_video_removecontrols();</div><div class="line">              );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 跳转到某一指定scene 参数为scene的序号--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_gotoscene"</span>&gt;</span></div><div class="line">        if(scene[%1],</div><div class="line">            copy(cursceneindex, scene[get(xml.scene)].index);</div><div class="line">            copy(newsceneindex, scene[%1].index);</div><div class="line">            skin_loadscene(get(newsceneindex), calc(newsceneindex LT cursceneindex ? skin_settings.loadscene_blend_prev : (newsceneindex GT cursceneindex ? skin_settings.loadscene_blend_next : skin_settings.loadscene_blend)) );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 显示下一个场景（不循环） --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_nextscene"</span>&gt;</span></div><div class="line">        add(newsceneindex, scene[get(xml.scene)].index, %1);</div><div class="line">        if(newsceneindex GE 0 AND newsceneindex LT scene.count,</div><div class="line">            skin_loadscene(get(newsceneindex), calc(%1 LT 0 ? skin_settings.loadscene_blend_prev : skin_settings.loadscene_blend_next));</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 显示下一个场景（循环） --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_nextscene_loop"</span>&gt;</span></div><div class="line">        add(newsceneindex, scene[get(xml.scene)].index, %1);</div><div class="line">        sub(lastsceneindex, scene.count, 1);</div><div class="line">        if(newsceneindex LT 0, copy(newsceneindex,lastsceneindex));</div><div class="line">        if(newsceneindex GT lastsceneindex, set(newsceneindex,0));</div><div class="line">        skin_loadscene(get(newsceneindex), calc(%1 LT 0 ? skin_settings.loadscene_blend_prev : skin_settings.loadscene_blend_next));</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- skin_loadscene(scenenameorindex, blendmode) --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 加载场景如果只有一个场景就WebVR的按钮隐藏，并且在场景缩略图上加上边框效果，blendmode为场景切换动画 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_loadscene"</span>&gt;</span></div><div class="line">        if(webvr.isenabled AND scene.count GT 1,</div><div class="line">            set(hotspot[webvr_prev_scene].visible, false);</div><div class="line">            set(hotspot[webvr_next_scene].visible, false);</div><div class="line">          );</div><div class="line"></div><div class="line">        txtadd(layer[skin_thumbborder].parent, 'skin_thumb_', get(scene[%1].index));</div><div class="line">        layer[skin_thumbs].scrolltocenter(get(scene[%1].thumbx), get(scene[%1].thumby));</div><div class="line">        loadscene(get(scene[%1].name), null, get(skin_settings.loadscene_flags), %2);</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 加载文字是否显示 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_showloading"</span>&gt;</span></div><div class="line">        if(display.stereo == true,</div><div class="line">            set(layer[skin_loadingtext].visible, false);</div><div class="line">          ,</div><div class="line">            set(layer[skin_loadingtext].visible, %1);</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 隐藏tips --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_hidetooltips"</span>&gt;</span></div><div class="line">        set(layer[skin_tooltip].alpha,0.0);</div><div class="line">        set(layer[skin_tooltip].visible,false);</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 按钮的点击效果，在点击的按钮下添加一个Child --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_buttonglow"</span>&gt;</span></div><div class="line">        if('%1' !== 'null',</div><div class="line">            set(strength,0.7);</div><div class="line">            if(%2 != null, set(strength,%2));</div><div class="line">            set(layer[skin_buttonglow].parent, %1);</div><div class="line">            set(layer[skin_buttonglow].visible, true);</div><div class="line">            tween(layer[skin_buttonglow].alpha, get(strength), 0.07);</div><div class="line">          ,</div><div class="line">            tween(layer[skin_buttonglow].alpha, 0.0, 0.1, default,</div><div class="line">                set(layer[skin_buttonglow].parent, null);</div><div class="line">                set(layer[skin_buttonglow].visible, false);</div><div class="line">              );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 设置关闭打开的距离 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_calc_opened_closed"</span>&gt;</span></div><div class="line">        if(layer[get(name)].y_closed === null,</div><div class="line">            set(layer[get(name)].y_opened, get(layer[get(name)].y));</div><div class="line">            set(layer[get(name)].y_closed, calc(layer[get(name)].y - skin_settings.controlbar_offset - skin_settings.controlbar_height + skin_settings.controlbar_offset_closed));</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 隐藏控制条，首先隐藏上方布局，其次底部最后控制条 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_hideskin"</span>&gt;</span></div><div class="line">        callwith(layer[skin_scroll_window],   skin_calc_opened_closed() );</div><div class="line">        callwith(layer[skin_splitter_bottom], skin_calc_opened_closed() );</div><div class="line">        callwith(layer[skin_control_bar],     skin_calc_opened_closed() );</div><div class="line"></div><div class="line">        if(layer[skin_map].state    != 'closed', skin_showmap(false);    wait(0.40); );</div><div class="line">        if(layer[skin_thumbs].state != 'closed', skin_showthumbs(false); wait(0.25); );</div><div class="line"></div><div class="line">        set(hidetime, calc('%1' == 'instant' ? 0.0 : 0.5));</div><div class="line">        tween(layer[skin_scroll_window].y,   get(layer[skin_scroll_window  ].y_closed), get(hidetime));</div><div class="line">        tween(layer[skin_splitter_bottom].y, get(layer[skin_splitter_bottom].y_closed), get(hidetime));</div><div class="line">        tween(layer[skin_control_bar].y,     get(layer[skin_control_bar    ].y_closed), get(hidetime));</div><div class="line"></div><div class="line">        tween(layer[skin_btn_prev_fs].x, 0, get(hidetime));</div><div class="line">        tween(layer[skin_btn_next_fs].x, 0, get(hidetime));</div><div class="line"></div><div class="line">        if(layer[skin_logo], tween(layer[skin_logo].alpha, 0.0, 0.5, default, set(layer[skin_logo].visible,false)); );</div><div class="line"></div><div class="line">        stopdelayedcall(skin_btn_show_alpha);</div><div class="line">        set(layer[skin_btn_show].visible, true);</div><div class="line">        delayedcall(skin_btn_show_alpha, get(hidetime), tween(layer[skin_btn_show].alpha, 0.25, 0.25); );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 显示隐藏的控制条 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_showskin"</span>&gt;</span></div><div class="line">        tween(layer[skin_scroll_window  ].y, get(layer[skin_scroll_window  ].y_opened));</div><div class="line">        tween(layer[skin_splitter_bottom].y, get(layer[skin_splitter_bottom].y_opened));</div><div class="line">        tween(layer[skin_control_bar    ].y, get(layer[skin_control_bar    ].y_opened));</div><div class="line"></div><div class="line">        tween(layer[skin_btn_prev_fs].x, -50);</div><div class="line">        tween(layer[skin_btn_next_fs].x, -50);</div><div class="line"></div><div class="line">        if(layer[skin_logo], set(layer[skin_logo].visible,true); tween(layer[skin_logo].alpha, 1.0); );</div><div class="line"></div><div class="line">        stopdelayedcall(skin_btn_show_alpha);</div><div class="line">        set(layer[skin_btn_show].visible, false);</div><div class="line">        delayedcall(skin_btn_show_alpha, 0.25, tween(layer[skin_btn_show].alpha, 0.0, 0.0); );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 显示缩略图， 首先判断是否已经关闭，layer[skin_scroll_layer].pixelheight=area.pixelheight的值为当前窗口的高度</span></div><div class="line">    假设当前窗口高度为640 1.640*-1=-640 2.减去（layer[skin_thumbs].height）缩略图的高度100 -640+100=-540 3.减去（y_offset）背景重叠区域大小 10 -540+10=-530</div><div class="line">    4. layer[skin_scroll_layer].y大小为负的area.pixelheight+y_offset一开始onresize时设定 则变化范围为 -630 到-530 </div><div class="line">    详细参照http://krpano.com/docu/xml/pluginalignment.png这张图，备注下对于xy属性，默认向下为Y的正向向右为X 的正向，edge未设定时默认和align一个值--&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_showthumbs"</span>&gt;</span></div><div class="line">        if(%1 == null, if(layer[skin_thumbs].state == 'closed', set(show,true), set(show,false)); , set(show,%1); );</div><div class="line">        mul(mh, layer[skin_scroll_layer].pixelheight, -1);</div><div class="line"></div><div class="line">        if(show,</div><div class="line">            set(layer[skin_thumbs].state, 'opened');</div><div class="line">            tween(layer[skin_thumbs].alpha, 1.0, 0.25);</div><div class="line">            add(mh, layer[skin_thumbs].height);</div><div class="line">            add(mh, layer[skin_scroll_layer].y_offset);</div><div class="line">            tween(layer[skin_scroll_layer].y, get(mh), 0.5, easeOutQuint);</div><div class="line">            set(layer[skin_thumbs_container].visible, true);</div><div class="line">            tween(layer[skin_thumbs_container].alpha, 1.0, 0.25);</div><div class="line">            tween(layer[skin_map].alpha, 0.0, 0.25, default, set(layer[skin_map].visible,false));</div><div class="line">          ,</div><div class="line">            set(layer[skin_thumbs].state, 'closed');</div><div class="line">            tween(layer[skin_thumbs].alpha, 0.0, 0.25, easeOutQuint);</div><div class="line">            add(mh, layer[skin_scroll_layer].y_offset);</div><div class="line">            tween(layer[skin_scroll_layer].y, get(mh), 0.5, easeOutQuint, set(layer[skin_thumbs_container].visible, false););</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 显示地图 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_showmap"</span>&gt;</span></div><div class="line">        if(%1 == null, if(layer[skin_map].state == 'closed', set(show,true), set(show,false)); , set(show,%1); );</div><div class="line">        mul(mh, layer[skin_scroll_layer].pixelheight, -1);</div><div class="line">        if(show,</div><div class="line">            tween(layer[skin_thumbs_container].alpha, 0.0, 0.25, default, set(layer[skin_thumbs_container].visible,false));</div><div class="line">            set(layer[skin_map].visible, true);</div><div class="line">            tween(layer[skin_map].alpha, 1.0, 0.25);</div><div class="line">            set(layer[skin_map].state, 'opened');</div><div class="line">            sub(hh,area.pixelheight,skin_settings.controlbar_offset);</div><div class="line">            sub(hh,layer[skin_control_bar].height);</div><div class="line">            sub(hh,32);</div><div class="line">            add(mh,hh);</div><div class="line">            sub(hh,skin_settings.controlbar_overlap);</div><div class="line">            copy(layer[skin_map].height, hh);</div><div class="line">            tween(layer[skin_scroll_layer].y, get(mh), 0.5, easeOutQuint);</div><div class="line">          ,</div><div class="line">            if(layer[skin_map].state != 'closed',</div><div class="line">                set(layer[skin_map].state, 'closed');</div><div class="line">                add(mh, layer[skin_scroll_layer].y_offset);</div><div class="line">                tween(layer[skin_map].alpha, 0.0, 0.5, easeOutQuint);</div><div class="line">                tween(layer[skin_scroll_layer].y, get(mh), 0.5, easeOutQuint, set(layer[skin_map].visible,false) );</div><div class="line">              );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 绑定键盘事件 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_keydown_event"</span>&gt;</span></div><div class="line">        if(keycode == 33, skin_nextscene_loop(-1) );                <span class="comment">&lt;!-- Page Up   - previous scene --&gt;</span></div><div class="line">        if(keycode == 34, skin_nextscene_loop(+1) );                <span class="comment">&lt;!-- Page Dowm - next scene --&gt;</span></div><div class="line">        if(keycode == 35, skin_gotoscene(calc(scene.count-1)) );    <span class="comment">&lt;!-- End       - last scene --&gt;</span></div><div class="line">        if(keycode == 36, skin_gotoscene(0) );                      <span class="comment">&lt;!-- Home/Pos1 - first scene --&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 如果使用深度链接功能调用skin_deeplinking_update_url_process获取链接参数并设置 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_deeplinking_update_url"</span>&gt;</span></div><div class="line">        if(skin_settings.deeplinking AND (!webvr OR webvr.isenabled === false),</div><div class="line">            delayedcall(skin_deeplinking_update, calc(%1 == null ? 0.1 : %1), skin_deeplinking_update_url_process() );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 深度链接功能，通过URL传递场景的初始位置等信息，重新设定到新的场景上 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_deeplinking_update_url_process"</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 获取当前的URL --&gt;</span></div><div class="line">        copy(adr, browser.location);</div><div class="line">        <span class="comment">&lt;!-- 获取？后的参数信息 --&gt;</span></div><div class="line">        indexoftxt(qi, get(adr), '?');</div><div class="line">        if(qi GT 0, subtxt(adr, adr, 0, get(qi)));</div><div class="line">        copy(si, scene[get(xml.scene)].index);</div><div class="line">        copy(h, view.hlookat);</div><div class="line">        copy(v, view.vlookat);</div><div class="line">        copy(f, view.fov);</div><div class="line">        copy(d, view.distortion);</div><div class="line">        copy(a, view.architectural);</div><div class="line">        clamp(d, 0.0, 1.0);</div><div class="line">        clamp(a, 0.0, 1.0);</div><div class="line">        set(pp, calc(f LT 10 ? 6 : 2));</div><div class="line">        roundval(h, get(pp));</div><div class="line">        roundval(v, get(pp));</div><div class="line">        roundval(f, get(pp));</div><div class="line">        roundval(d, 2);</div><div class="line">        roundval(a, 1);</div><div class="line">        set(adr, calc(adr + '?startscene=' + si + '&amp;amp;startactions=lookat('+h+','+v+','+f+','+d+','+a+');'));</div><div class="line">        js( history.replaceState(null, document.title, get(adr)); );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- reload the scene when there is a special image for VR --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 如果scene标签有havevrimage属性，进入VR重载界面 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_reloadscene_webvr"</span>&gt;</span></div><div class="line">        delayedcall(0.1,</div><div class="line">            if(scene[get(xml.scene)].havevrimage,</div><div class="line">                copy(keeplookingdirection_backup, skin_settings.webvr_gyro_keeplookingdirection);</div><div class="line">                set(skin_settings.webvr_gyro_keeplookingdirection, true);</div><div class="line">                loadscene(get(xml.scene), null, MERGE|KEEPVIEW|KEEPMOVING|KEEPHOTSPOTS|NOPREVIEW, BLEND(0.5));</div><div class="line">                copy(skin_settings.webvr_gyro_keeplookingdirection, keeplookingdirection_backup);</div><div class="line">                delete(keeplookingdirection_backup);</div><div class="line">              );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- videopano support - http://krpano.com/plugins/videoplayer/ --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 加载视频控制条 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_addcontrols"</span>&gt;</span></div><div class="line">        set(events[skin_events].onclick, skin_video_clickevent() );</div><div class="line"></div><div class="line">        set(plugin[video].onvideoready, skin_video_updatestate() );</div><div class="line">        set(plugin[video].onvideoplay, skin_video_updatestate() );</div><div class="line">        set(plugin[video].onvideopaused, skin_video_updatestate() );</div><div class="line">        set(plugin[video].onvideocomplete, skin_video_updatestate() );</div><div class="line"></div><div class="line">        if(plugin[video].ispaused AND plugin[video].pausedonstart,</div><div class="line">            set(layer[skin_video_playpause].state, 'visible');</div><div class="line">            set(layer[skin_video_playpause].enabled, true);</div><div class="line">            tween(layer[skin_video_playpause].alpha, 1.0);</div><div class="line">          );</div><div class="line"></div><div class="line">        delayedcall(skin_video_delayedvisible, 0.25, set(layer[skin_video_controls].visible, true) );</div><div class="line"></div><div class="line">        skin_video_updateseekbarwidth();</div><div class="line">        set(layer[skin_video_seekpos].x,0);</div><div class="line">        set(layer[skin_video_loadbar].width,0);</div><div class="line"></div><div class="line">        setinterval(skin_video_seek_updates, 0.5, skin_video_updatetime() );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 去除视频控制条 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_removecontrols"</span>&gt;</span></div><div class="line">        stopdelayedcall(skin_video_delayedvisible);</div><div class="line"></div><div class="line">        set(events[skin_events].onclick, null);</div><div class="line"></div><div class="line">        set(layer[skin_video_playpause].alpha, 0.0);</div><div class="line">        set(layer[skin_video_controls].visible, false);</div><div class="line"></div><div class="line">        clearinterval(skin_video_seek_updates);</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 实时更新seek的进度和时间显示 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_updatetime"</span>&gt;</span></div><div class="line">        copy(t1, plugin[video].time);</div><div class="line">        copy(t2, plugin[video].totaltime);</div><div class="line">        if(%1 !== null, calc(t1, %1 * t2); );</div><div class="line">        div(t1_min, t1, 60);</div><div class="line">        mod(t1_sec, t1, 60);</div><div class="line">        Math.floor(t1_min);</div><div class="line">        Math.floor(t1_sec);</div><div class="line">        div(t2_min, t2, 60);</div><div class="line">        mod(t2_sec, t2, 60);</div><div class="line">        Math.floor(t2_min);</div><div class="line">        Math.floor(t2_sec);</div><div class="line">        calc(layer[skin_video_time].html, t1_min + ':' + (t1_sec LT 10 ? '0' : '') + t1_sec + ' / ' + t2_min + ':' + (t2_sec LT 10 ? '0' : '') + t2_sec);</div><div class="line">        calc(layer[skin_video_seekpos].x, (t1 / t2 * 100) + '%');</div><div class="line">        calc(layer[skin_video_loadbar].width, (plugin[video].loadedbytes / plugin[video].totalbytes * 100) + '%');</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 更新视频进度空间的宽度 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_updateseekbarwidth"</span>&gt;</span></div><div class="line">        if(skin_settings.title,</div><div class="line">            calc(layer[skin_video_seekbar_container].width, 0 - (32 + layer[skin_title].pixelwidth + layer[skin_video_time].pixelwidth));</div><div class="line">            calc(layer[skin_video_seekbar_container].x, layer[skin_title].pixelwidth + 16);</div><div class="line">          ,</div><div class="line">            calc(layer[skin_video_seekbar_container].width, 0 - (24 + layer[skin_video_time].pixelwidth));</div><div class="line">            set(layer[skin_video_seekbar_container].x, 8);</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 跳转到指定的视频进度 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_ondownseeking"</span>&gt;</span></div><div class="line">        asyncloop(pressed,</div><div class="line">            screentolayer(skin_video_seekbar, mouse.stagex,mouse.stagey, lx,ly);</div><div class="line">            calc(seekpos, lx / layer[skin_video_seekbar].pixelwidth);</div><div class="line">            clamp(seekpos, 0.0, 1.0);</div><div class="line">            skin_video_updatetime(seekpos);</div><div class="line">          ,</div><div class="line">            plugin[video].seek(calc((seekpos * 100) + '%'));</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 暂停或者显示时的图层 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">layer</span> <span class="attr">name</span>=<span class="string">"skin_video_playpause"</span> <span class="attr">keep</span>=<span class="string">"true"</span></span></div><div class="line">             <span class="attr">style</span>=<span class="string">"skin_base|skin_glow"</span> <span class="attr">crop</span>=<span class="string">"0|640|64|64"</span> <span class="attr">scale</span>=<span class="string">"0.75"</span></div><div class="line">             <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">alpha</span>=<span class="string">"0.0"</span> <span class="attr">autoalpha</span>=<span class="string">"true"</span></div><div class="line">             <span class="attr">state</span>=<span class="string">"hidden"</span></div><div class="line">             <span class="attr">onclick</span>=<span class="string">"skin_video_playpause_click();"</span></div><div class="line">             /&gt;</div><div class="line">    <span class="comment">&lt;!-- 状态变更时更新 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_updatestate"</span>&gt;</span></div><div class="line">        calc(layer[skin_video_playpause].crop, plugin[video].ispaused ? '0|640|64|64' : '64|640|64|64');</div><div class="line">        if(plugin[video].iscomplete,</div><div class="line">            set(layer[skin_video_playpause].state, 'visible');</div><div class="line">            tween(layer[skin_video_playpause].alpha, 1.0);</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 点击暂停按钮 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_playpause_click"</span>&gt;</span></div><div class="line">        if(plugin[video].ispaused,</div><div class="line">            plugin[video].play();</div><div class="line">            set(layer[skin_video_playpause].state, 'hidden');</div><div class="line">            tween(layer[skin_video_playpause].alpha, 0.0);</div><div class="line">          ,</div><div class="line">            plugin[video].pause();</div><div class="line">            set(layer[skin_video_playpause].state, 'visible');</div><div class="line">            tween(layer[skin_video_playpause].alpha, 1.0);</div><div class="line">            delayedcall(autohide_pp, 2.0, set(layer[skin_video_playpause].state,'hidden'); tween(layer[skin_video_playpause].alpha, 0.0); );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 点击屏幕的事件触发视频播放和暂停 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_video_clickevent"</span>&gt;</span></div><div class="line">        stopdelayedcall(autohide_pp);</div><div class="line"></div><div class="line">        switch(layer[skin_video_playpause].state, 'visible', 'hidden');</div><div class="line"></div><div class="line">        if(layer[skin_video_playpause].state == 'hidden',</div><div class="line">            tween(layer[skin_video_playpause].alpha, 0.0);</div><div class="line">          ,</div><div class="line">            tween(layer[skin_video_playpause].alpha, 1.0);</div><div class="line">            delayedcall(autohide_pp, 2.0, set(layer[skin_video_playpause].state,'hidden'); tween(layer[skin_video_playpause].alpha, 0.0); );</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- context menu - http://krpano.com/docu/xml/#contextmenu --&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 右键按钮菜单 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">contextmenu</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"kr"</span> <span class="attr">caption</span>=<span class="string">"Krpano"</span> <span class="attr">onclick</span>=<span class="string">"openurl('http://www.krpano.com',_blank);"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"fs"</span> <span class="attr">caption</span>=<span class="string">"FULLSCREEN"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"cc"</span> <span class="attr">caption</span>=<span class="string">"Change Controlmode"</span> <span class="attr">onclick</span>=<span class="string">"skin_changecontrolmode();"</span>  <span class="attr">separator</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"nv"</span> <span class="attr">caption</span>=<span class="string">"Normal View"</span>        <span class="attr">onclick</span>=<span class="string">"skin_view_normal();"</span>        <span class="attr">showif</span>=<span class="string">"view.vlookatrange == 180"</span> <span class="attr">separator</span>=<span class="string">"true"</span>      /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"fv"</span> <span class="attr">caption</span>=<span class="string">"Fisheye View"</span>       <span class="attr">onclick</span>=<span class="string">"skin_view_fisheye();"</span>       <span class="attr">showif</span>=<span class="string">"view.vlookatrange == 180"</span> <span class="attr">devices</span>=<span class="string">"flash|webgl"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"sv"</span> <span class="attr">caption</span>=<span class="string">"Stereographic View"</span> <span class="attr">onclick</span>=<span class="string">"skin_view_stereographic();"</span> <span class="attr">showif</span>=<span class="string">"view.vlookatrange == 180"</span> <span class="attr">devices</span>=<span class="string">"flash|webgl"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"av"</span> <span class="attr">caption</span>=<span class="string">"Architectural View"</span> <span class="attr">onclick</span>=<span class="string">"skin_view_architectural();"</span> <span class="attr">showif</span>=<span class="string">"view.vlookatrange == 180"</span>                       /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"pv"</span> <span class="attr">caption</span>=<span class="string">"Pannini View"</span>       <span class="attr">onclick</span>=<span class="string">"skin_view_pannini();"</span>       <span class="attr">showif</span>=<span class="string">"view.vlookatrange == 180"</span> <span class="attr">devices</span>=<span class="string">"flash|webgl"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"lp"</span> <span class="attr">caption</span>=<span class="string">"Little Planet View"</span> <span class="attr">onclick</span>=<span class="string">"skin_view_littleplanet();"</span>  <span class="attr">showif</span>=<span class="string">"view.vlookatrange == 180"</span> <span class="attr">devices</span>=<span class="string">"flash|webgl"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">contextmenu</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 点击改变控制方式函数 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_changecontrolmode"</span>&gt;</span></div><div class="line">        switch(control.mouse, moveto, drag);</div><div class="line">        switch(control.touch, moveto, drag);</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 以下为不同的全景显示模式 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_view_look_straight"</span>&gt;</span></div><div class="line">        if(view.vlookat LT -80 OR view.vlookat GT +80,</div><div class="line">            tween(view.vlookat, 0.0, 1.0, easeInOutSine);</div><div class="line">            tween(view.fov,     100, distance(150,0.8));</div><div class="line">          );</div><div class="line">        skin_deeplinking_update_url(1.0);</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_view_normal"</span>&gt;</span></div><div class="line">        skin_view_look_straight();</div><div class="line">        tween(view.architectural, 0.0, distance(1.0,0.5));</div><div class="line">        tween(view.pannini,       0.0, distance(1.0,0.5));</div><div class="line">        tween(view.distortion,    0.0, distance(1.0,0.5));</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_view_fisheye"</span>&gt;</span></div><div class="line">        skin_view_look_straight();</div><div class="line">        tween(view.architectural, 0.0,  distance(1.0,0.5));</div><div class="line">        tween(view.pannini,       0.0,  distance(1.0,0.5));</div><div class="line">        tween(view.distortion,    0.35, distance(1.0,0.5));</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_view_architectural"</span>&gt;</span></div><div class="line">        skin_view_look_straight();</div><div class="line">        tween(view.architectural, 1.0, distance(1.0,0.5));</div><div class="line">        tween(view.pannini,       0.0, distance(1.0,0.5));</div><div class="line">        tween(view.distortion,    0.0, distance(1.0,0.5));</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_view_stereographic"</span>&gt;</span></div><div class="line">        skin_view_look_straight();</div><div class="line">        tween(view.architectural, 0.0, distance(1.0,0.5));</div><div class="line">        tween(view.pannini,       0.0, distance(1.0,0.5));</div><div class="line">        tween(view.distortion,    1.0, distance(1.0,0.8));</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_view_pannini"</span>&gt;</span></div><div class="line">        skin_view_look_straight();</div><div class="line">        tween(view.architectural, 0.0, distance(1.0,0.5));</div><div class="line">        tween(view.pannini,       1.0, distance(1.0,0.8));</div><div class="line">        if(view.distortion LT 0.1,</div><div class="line">            tween(view.distortion, 1.0, distance(1.0,0.8));</div><div class="line">          );</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"skin_view_littleplanet"</span>&gt;</span></div><div class="line">        tween(view.architectural, 0.0, distance(1.0,0.5));</div><div class="line">        tween(view.pannini,       0.0, distance(1.0,0.5));</div><div class="line">        tween(view.distortion,    1.0, distance(1.0,0.8));</div><div class="line">        tween(view.fov,           150, distance(150,0.8));</div><div class="line">        tween(view.vlookat,        90, distance(100,0.8));</div><div class="line">        add(new_hlookat, view.hlookat, 123.0);</div><div class="line">        tween(view.hlookat, get(new_hlookat), distance(100,0.8));</div><div class="line">        skin_deeplinking_update_url(1.0);</div><div class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">krpano</span>&gt;</span></div></pre></td></tr></table></figure>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      Krpano skin
    
    </summary>
    
      <category term="krpano" scheme="https://austinxishou.github.io/categories/krpano/"/>
    
    
      <category term="krpano" scheme="https://austinxishou.github.io/tags/krpano/"/>
    
  </entry>
  
  <entry>
    <title>SEAndroid权限修改</title>
    <link href="https://austinxishou.github.io/2017/11/01/android/android-selinux-sepolice-modify/"/>
    <id>https://austinxishou.github.io/2017/11/01/android/android-selinux-sepolice-modify/</id>
    <published>2017-11-01T08:03:06.333Z</published>
    <updated>2017-03-29T05:47:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="权限修改"><a href="#权限修改" class="headerlink" title="权限修改"></a>权限修改</h2><h3 id="方法1-adb在线修改seLinux"><a href="#方法1-adb在线修改seLinux" class="headerlink" title="方法1: adb在线修改seLinux"></a>方法1: adb在线修改seLinux</h3><p> <code>Enforcing</code>(表示已打开)，<code>Permissive</code>（表示已关闭）</p>
<pre><code>getenforce;  //获取当前seLinux状态
setenforce 1;   //打开seLinux
setenforce 0;   //关闭seLinux
</code></pre><h3 id="方法2-从kernel中彻底关闭"><a href="#方法2-从kernel中彻底关闭" class="headerlink" title="方法2: 从kernel中彻底关闭"></a>方法2: 从kernel中彻底关闭</h3><p>修改<code>LINUX/android/kernel/arch/arm64/configs/xxx_defconfig</code>文件（xxx一般为手机产品名）， 去掉<code>CONFIG_SECURITY_SELINUX=y</code>的配置项</p>
<h3 id="方法3-sepolicy中添加权限"><a href="#方法3-sepolicy中添加权限" class="headerlink" title="方法3: sepolicy中添加权限"></a>方法3: sepolicy中添加权限</h3><ul>
<li><p>修改依据，通过指令<code>cat /proc/kmsg | grep denied</code>，或者kernel的Log中定位到标志性log。</p>
</li>
<li><p>修改步骤</p>
<ul>
<li><p>找相应的<strong>源类型.te</strong>文件，此文件可能的存放路径 (其中<strong>源类型</strong>见下方的标志性log格式) ：</p>
<pre><code>LINUX/android/external/sepolicy
LINUX/android/device/qcom/sepolicy/common
</code></pre></li>
<li><p>标志性log 格式</p>
<pre><code>avc: denied  { 操作权限  }  for pid=7201  comm=“进程名”  scontext=u:r:源类型:s0  tcontext=u:r:目标类型:s0  tclass=访问类型 permissive=0
</code></pre></li>
<li><p>在相应<strong>源类型.te</strong>文件，添加如下格式的一行语句：(结尾别忘了分号)</p>
<pre><code>格式：allow  源类型 目标类型:访问类型 {操作权限};
</code></pre></li>
</ul>
</li>
<li><p>实例</p>
<ul>
<li><p>Kernel Log</p>
<pre><code>avc: denied {getattr read} for pid=7201 comm=&quot;xxx.xxx&quot; scontext=u:r:system_app:s0 tcontext=u:r:shell_data_file:s0 tclass=dir permissive=0
</code></pre></li>
<li><p>修改方案</p>
<pre><code>在system_app.te文件中，添加下面语句：
allow system_app shell_data_file:dir{getattr read};
</code></pre><script>
(function(){
var bp = document.createElement('script');
var curProtocol = window.location.protocol.split(':')[0];
if (curProtocol === 'https') {
  bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
}
else {
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
}
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(bp, s);

var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
</li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      android security selinux
    
    </summary>
    
    
      <category term="android" scheme="https://austinxishou.github.io/tags/android/"/>
    
      <category term="security" scheme="https://austinxishou.github.io/tags/security/"/>
    
      <category term="selinux" scheme="https://austinxishou.github.io/tags/selinux/"/>
    
  </entry>
  
  <entry>
    <title>微信公众号开发-微擎系统相关学习</title>
    <link href="https://austinxishou.github.io/2017/11/01/wechat/we7-wechat-framework-started/"/>
    <id>https://austinxishou.github.io/2017/11/01/wechat/we7-wechat-framework-started/</id>
    <published>2017-11-01T08:03:05.089Z</published>
    <updated>2017-05-18T09:45:57.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h2><ul>
<li><a href="http://www.we7.cc/" target="_blank" rel="external"><strong>微擎官网</strong></a></li>
<li><a href="http://www.we7.cc/docs/#module" target="_blank" rel="external"><strong>微擎文档</strong></a></li>
<li><p><a href="http://www.we7.cc/manual/structure:outline" target="_blank" rel="external"><strong>微擎开发文档</strong></a></p>
<script>
(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
  }
  else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);

  var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
  document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      微擎开发手册 微赞介绍 weiqing we7 	微信公众平台开发
    
    </summary>
    
      <category term="wechat" scheme="https://austinxishou.github.io/categories/wechat/"/>
    
    
      <category term="we7" scheme="https://austinxishou.github.io/tags/we7/"/>
    
      <category term="wechat" scheme="https://austinxishou.github.io/tags/wechat/"/>
    
  </entry>
  
  <entry>
    <title>GithubPages+Hexo3.0搭建静态博客网页</title>
    <link href="https://austinxishou.github.io/2017/11/01/webdesign/GithubPagesHexo3.0-for-personal-blog/"/>
    <id>https://austinxishou.github.io/2017/11/01/webdesign/GithubPagesHexo3.0-for-personal-blog/</id>
    <published>2017-11-01T08:03:05.042Z</published>
    <updated>2017-05-18T03:13:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p>Hexo 是一个轻量的静态博客框架。通过Hexo可以快速生成一个静态博客框架,仅需要几条命令就可以完成,相当方便。<br>而架设Hexo的环境更简单了 不需要lnmp/lamp这些繁琐复杂的环境 仅仅需要一个简单的http服务器即可使用 或者使用互联网上免费的页面托管服务</p>
<p>比如Hexo的<a href="http://hexo.io" target="_blank" rel="external">官方网站</a>就是托管于github的pages服务上</p>
<h2 id="Hexo配置方法"><a href="#Hexo配置方法" class="headerlink" title="Hexo配置方法"></a>Hexo配置方法</h2><p>进去之后加入hexo主程序和安装npm<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hexo init</div><div class="line">npm install</div></pre></td></tr></table></figure></p>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><p>新建完成后，指定文件夹的目录如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── _config.yml</div><div class="line">├── package.json</div><div class="line">├── scaffolds</div><div class="line">├── source</div><div class="line">|   ├── _drafts</div><div class="line">|   └── _posts</div><div class="line">└── themes</div></pre></td></tr></table></figure></p>
<p>_config.yml<br>网站的 配置 信息，您可以在此配置大部分的参数。</p>
<p>package.json<br>应用程序的信息。EJS, Stylus 和 Markdown renderer 已默认安装，您可以自由移除。</p>
<p>scaffolds<br>模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。</p>
<p>source<br>资源文件夹是存放用户资源的地方。除 posts 文件夹之外，开头命名为 (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。</p>
<p>themes<br>主题 文件夹。Hexo 会根据主题来生成静态页面。</p>
<h3 id="Hexo全局配置"><a href="#Hexo全局配置" class="headerlink" title="Hexo全局配置"></a>Hexo全局配置</h3><p>用文本编辑器修改_config.yml这个文件 大致如下 只需要自行修改几个 其他保持默认即可</p>
<p>通常需要修改站点名称 /URL格式 /归档设置 /disqus评论用户名 /部署配置 这几项就可以了 注意冒号后面都要添加一个半角空格 之后才是设置参数</p>
<p>自定义域名设置 在 source 我文件夹下面新建 CNAME 文件 里面写入你的自定义域名 并设置您的dns配置cname方式到服务提供商的给的地址即可</p>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><p>source_dir 资源文件夹，这个文件夹用来存放内容。 source</p>
<p>public_dir 公共文件夹，这个文件夹用于存放生成的站点文件。 public</p>
<p>tag_dir 标签文件夹 tags</p>
<p>archive_dir 归档文件夹 archives</p>
<p>category_dir 分类文件夹 categories</p>
<p>code_dir Include code 文件夹 downloads/code</p>
<p>i18n_dir 国际化（i18n）文件夹 :lang</p>
<p>skip_render 跳过指定文件的渲染，您可使用 glob 来配置路径。</p>
<h3 id="文章"><a href="#文章" class="headerlink" title="文章"></a>文章</h3><h2 id="本地启动server"><a href="#本地启动server" class="headerlink" title="本地启动server"></a>本地启动server</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>可以观察命令行的输出，然后通过浏览器打开<a href="http://localhost:4000/，成功的情况下则会看到默认的欢迎页面。" target="_blank" rel="external">http://localhost:4000/，成功的情况下则会看到默认的欢迎页面。</a></p>
<h2 id="部署到github-pages"><a href="#部署到github-pages" class="headerlink" title="部署到github pages"></a>部署到github pages</h2><p>Hexo 提供了快速方便的一键部署功能，让您只需一条命令就能将网站部署到服务器上。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure></p>
<p>在开始之前，您必须先在 _config.yml 中修改参数，一个正确的部署配置中至少要有 type 参数，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  repo: &lt;repository url&gt;</div><div class="line">  branch: [branch]</div><div class="line">  message: [message]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">参数	描述</div><div class="line">repo	库（Repository）地址</div><div class="line">branch	分支名称。如果您使用的是 GitHub 或 GitCafe 的话，程序会尝试自动检测。</div><div class="line">message	自定义提交信息 (默认为 Site updated: &#123;&#123; now(&apos;YYYY-MM-DD HH:mm:ss&apos;) &#125;&#125;)</div></pre></td></tr></table></figure>
<p>我的博客对应的参数设置为<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="attr">deploy:</span></div><div class="line"><span class="attr">  type:</span> <span class="string">git</span></div><div class="line"><span class="attr">  repo:</span> <span class="attr">https://github.com/austinxishou/austinxishou.github.io.git</span></div><div class="line"><span class="attr">  branch:</span> <span class="string">master</span></div><div class="line"><span class="attr">  name:</span> <span class="string">austinxishou</span></div><div class="line"><span class="attr">  email:</span> <span class="string">austinxishou@yahoo.com</span></div></pre></td></tr></table></figure></p>
<p>安装 hexo-deployer-git</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install hexo-deployer-git --save</div></pre></td></tr></table></figure>
<p>之后依次执行:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ hexo clean</div><div class="line">$ hexo generate</div><div class="line">$ hexo deploy</div></pre></td></tr></table></figure></p>
<p>上述命令只要Github的权限校验通过,基本都能成功;</p>
<h2 id="hexo主题"><a href="#hexo主题" class="headerlink" title="hexo主题"></a>hexo主题</h2><p>收集主题</p>
<ol>
<li><a href="http://theme-next.iissnan.com/" target="_blank" rel="external">Next</a></li>
<li><a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank" rel="external">Nidigo</a></li>
</ol>
<h2 id="写文章"><a href="#写文章" class="headerlink" title="写文章"></a>写文章</h2><h3 id="使用草稿"><a href="#使用草稿" class="headerlink" title="使用草稿"></a>使用草稿</h3><p>在 source/_drafts 文件夹中 创建的文章为草稿，默认情况下不生成；<br>可以显示草稿<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo --draft</div></pre></td></tr></table></figure></p>
<h2 id="生成sitemap站点地图"><a href="#生成sitemap站点地图" class="headerlink" title="生成sitemap站点地图"></a>生成sitemap站点地图</h2><p><strong>安装插件</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install -g hexo-generator-sitemap --save</div><div class="line">npm install -g hexo-generator-baidu-sitemap --save</div></pre></td></tr></table></figure></p>
<p><strong>修改_config.yml文件</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># auto sitemap</span></div><div class="line">sitemap:</div><div class="line">  path: sitemap.xml</div><div class="line">baidusitemap:</div><div class="line">  path: baidusitemap.xml</div></pre></td></tr></table></figure><script><br>(function(){<br>    var bp = document.createElement(‘script’);<br>    var curProtocol = window.location.protocol.split(‘:’)[0];<br>    if (curProtocol === ‘https’) {<br>        bp.src = ‘<a href="https://zz.bdstatic.com/linksubmit/push.js">https://zz.bdstatic.com/linksubmit/push.js</a>‘;<br>    }<br>    else {<br>        bp.src = ‘<a href="http://push.zhanzhang.baidu.com/push.js">http://push.zhanzhang.baidu.com/push.js</a>‘;<br>    }<br>    var s = document.getElementsByTagName(“script”)[0];<br>    s.parentNode.insertBefore(bp, s);</p>
<pre><code>var sozzsrc = (document.location.protocol == &quot;http:&quot;) ? &quot;http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;:&quot;https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;;
document.write(&apos;&lt;script src=&quot;&apos; + sozzsrc + &apos;&quot; id=&quot;sozz&quot;&gt;&lt;\/script&gt;&apos;);
</code></pre><p>})();<br></script></p>
]]></content>
    
    <summary type="html">
    
      GithubPages+Hexo3.0搭建静态博客网页
    
    </summary>
    
      <category term="webdesign" scheme="https://austinxishou.github.io/categories/webdesign/"/>
    
    
      <category term="Hexo" scheme="https://austinxishou.github.io/tags/Hexo/"/>
    
      <category term="webdesign" scheme="https://austinxishou.github.io/tags/webdesign/"/>
    
      <category term="github" scheme="https://austinxishou.github.io/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>Android组件生命周期解析</title>
    <link href="https://austinxishou.github.io/2017/11/01/android/android-compent-lifetime/"/>
    <id>https://austinxishou.github.io/2017/11/01/android/android-compent-lifetime/</id>
    <published>2017-11-01T08:03:04.375Z</published>
    <updated>2017-05-17T05:47:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h2><p>在平时的应用开发中,接触最多的就是<code>activity</code>的生命周期。在生命周期回调方法中，您可以声明当用户离开并重新进入活动时，执行相应的代码行为。每一个回调工作，都应该执行特定动作，在正确的时间进行正确的工作并正确处理转换，才能够使应用程序更加健壮，更有效率。</p>
<p>如果没有处理好<code>activity</code>的生命周期，则有可能导致各种异常:</p>
<ol>
<li>应用程序运行时被电话或者其他程序中断，导致崩溃；</li>
<li>没有正确释放资源时,消耗宝贵的系统资源，甚至OOM。</li>
<li>如果用户离开您的应用程序并在以后返回，则丢失用户的进度。</li>
<li>屏幕在横向和纵向方向之间旋转时，可能会崩溃或丢失用户的进度。</li>
</ol>
<p>所以有必要深入一些，了解和掌握Activity的生命，下面先放一张activity的生命周期图：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/lifecycle/activity.png" alt="activity lifecycle" title="">
                </div>
                <div class="image-caption">activity lifecycle</div>
            </figure>
<h3 id="1-1-Activity状态"><a href="#1-1-Activity状态" class="headerlink" title="1.1 Activity状态"></a>1.1 Activity状态</h3><p>根据具体的应用的复杂性，可能不需要实现所有的生命周期方法。</p>
<ul>
<li><strong>创建 onCreate()：</strong><ul>
<li>必须实现此回调，当系统首次创建活动时触发。</li>
<li>在该方法中，执行基本的应用程序启动逻辑，该逻辑在整个活动的整个生命周期中应该只发生一次。</li>
<li>例如，将数据绑定到列表，初始化后台线程，并实例化一些类范围变量。</li>
<li>此方法接收参数savedInstanceState，该参数是包含Bundle 活动之前保存的状态的对象。如果活动从未存在，则该Bundle对象的值为null。
　　</li>
</ul>
</li>
<li><p><strong>开始 onStart()：</strong></p>
<ul>
<li>当活动进入“开始”状态时，系统将调用此回调。</li>
<li>该方法是应用程序初始化维护UI的代码的位置。</li>
<li>它也可以注册一个BroadcastReceiver 监视UI中响应的更改。</li>
<li>该状态只是过渡状态，非常快速完成，与“创建”状态一样，活动不会保持在“已启动”状态。一旦这个回调结束，活动进入 Resumed状态，系统调用该 onResume()方法。</li>
</ul>
</li>
<li><p><strong>恢复 onResume()：</strong></p>
<ul>
<li>这是应用程序与用户进行交互的状态。该应用程序停留在此状态，直到发生某些事情，将焦点从应用程序中移开。</li>
<li>当发生中断事件时，活动进入暂停 状态，系统调用 onPause()回调。</li>
<li>onResume状态说明activity在最上方，用户可以与它进行交互。所以那些仅在用户关注时才使用的组件应该在这个回调中初始化。</li>
</ul>
</li>
</ul>
<ul>
<li><strong>暂停 onPause()：</strong><ul>
<li>当前activity仍然是可见的。但被另一个activity处在最上方，最上方的activity是半透明的，或者是部分覆盖整个屏幕。被暂停的activity不会再接受用户的输入。</li>
<li>动画和音乐播放Activity在暂停状态下不应该继续。</li>
<li>进入暂停的时机有以下几种：<ul>
<li>电话或者短信等系统中断；</li>
<li>在多窗口模式中，切换到其他窗口；</li>
<li>打开一个新的半透明活动（如对话框）;</li>
</ul>
</li>
<li>当处于极度低内存的状态时，系统会杀掉该activity，释放相应资源。</li>
<li>onPause()执行非常简短，并不一定有足够的时间执行保存操作。保存应用程序或用户数据不应该在这步骤实现；</li>
</ul>
</li>
<li><p><strong>停止 onStop（）：</strong></p>
<ul>
<li>当前activity完全被隐藏，不被用户可见。可以认为是处于在后台。</li>
<li>由于对用户不再可见，只要有内存的需要，系统就会杀掉该activity来释放资源。</li>
<li>该状态由<code>onStop()</code>进入，或<code>onRestart()</code>或者<code>onCreate()</code>重新唤醒软件，或者被<code>onDestroy()</code>彻底死亡..</li>
</ul>
</li>
<li><p><strong>销毁 onDestroy()：</strong></p>
<ul>
<li>在活动被销毁之前调用。这是活动收到的最后一个回调。</li>
<li>在该回调中，释放上述所有回调中未被销毁的资源；</li>
</ul>
</li>
</ul>
<p>当acitivty处于暂停或者停止状态，系统可以通过<code>finish()</code>或 <code>android.os.Process.killProcess(android.os.Process.myPid())</code>来杀死其进程。当该activity再次被打开时(结束或杀死后)，需要重新创建，走一遍完整的流程。</p>
<h3 id="1-2-Activities调用流程"><a href="#1-2-Activities调用流程" class="headerlink" title="1.2 Activities调用流程"></a>1.2 Activities调用流程</h3><p>当Activity A 启动 Activity B时，两个activity都有自个的生命周期。Activity A暂停或者停止，Activity B被创建。记住，在Activity B创建之前，Activity A并不会完全停止，流程如下：</p>
<ol>
<li>Activity A 进入onPause();</li>
<li>Activity B 依次 onCreate(), onStart(), onResume()。（此时Activity B得到了用户焦点）</li>
<li>如果Activity A不再可见，则进入onStop().</li>
</ol>
<h3 id="1-3-代码实践"><a href="#1-3-代码实践" class="headerlink" title="1.3 代码实践"></a>1.3 代码实践</h3><p>利用下面的<code>DemoActivity</code>代码，可亲自感受每一个阶段的状态。比如点返回键，home键，menu键等操作，可以借助通过logcat查看该activity到底处于哪种状态，这里就不说结果了，自己动手，丰衣足食。</p>
<pre><code>import android.app.Activity;
import android.os.Bundle;
import android.util.Log;

public class DemoActivity extends Activity {
    private static final String TAG = &quot;demo&quot;;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.i(TAG,&quot;onCreate::The activity is being created.&quot;);
    }
    @Override
    protected void onStart() {
        super.onStart();
        Log.i(TAG, &quot;onStart::The activity is about to become visible.&quot;);
    }
    @Override
    protected void onResume() {
        super.onResume();
        Log.i(TAG, &quot;onResume::The activity has become visible.&quot;);
    }
    @Override
    protected void onPause() {
        super.onPause();
        Log.i(TAG, &quot;onPause:: Another activity is taking focus.&quot;);
    }
    @Override
    protected void onStop() {
        super.onStop();
        Log.i(TAG, &quot;onStop::The activity is no longer visible&quot;);
    }
    @Override
    protected void onDestroy() {
        super.onDestroy();
        Log.i(TAG, &quot;onDestroy::The activity is about to be destroyed&quot;);
    }
}
</code></pre><hr>
<h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><p>理解activity的生命周期后，Service的生命周期也是大同小异，先看下Service的生命周期图：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/lifecycle/service.png" alt="service lifecycle" title="">
                </div>
                <div class="image-caption">service lifecycle</div>
            </figure>
<h3 id="2-1-启动方式："><a href="#2-1-启动方式：" class="headerlink" title="2.1  启动方式："></a>2.1  启动方式：</h3><p>service有两种启动方式：</p>
<ul>
<li>startService() 启动本地服务Local Service</li>
<li>bindService() 启动远程服务Remote Service</li>
</ul>
<h3 id="2-2-生命周期"><a href="#2-2-生命周期" class="headerlink" title="2.2  生命周期"></a>2.2  生命周期</h3><p>两种不同的启动方式决定了Service具有两种生命周期的可能（并非互斥的两种）。</p>
<ol>
<li>start方式：onCreate()，onStartCommand()。onDestroy释放资源。</li>
<li>bind方式： onCreate()，onBind()方法。需要所有client全部调用unbindService()才能将Service释放资源，等待系统回收。</li>
</ol>
<h3 id="2-3-代码实践"><a href="#2-3-代码实践" class="headerlink" title="2.3  代码实践"></a>2.3  代码实践</h3><p>利用下面的<code>DemoService</code>代码，通过logcat自行感受每一个阶段的状态与场景的关系。</p>
<pre><code>import android.app.Service;
import android.content.Intent;
import android.os.IBinder;
import android.util.Log;

public class DemoService extends Service {
    private static final String TAG = &quot;demo&quot;;

    int mStartMode;       // service被杀掉的方式
    IBinder mBinder;      // clients绑定接口
    boolean mAllowRebind; // 是否允许onRebind

    @Override
    public void onCreate() {
        Log.i(TAG,&quot;onCreate::The service is being created&quot;);
    }
    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.i(TAG,&quot;onStartCommand::The service is starting&quot;);
        return mStartMode;
    }
    @Override
    public IBinder onBind(Intent intent) {
        Log.i(TAG,&quot;onBind::A client is binding to the service&quot;);
        return mBinder;
    }
    @Override
    public boolean onUnbind(Intent intent) {
        Log.i(TAG,&quot;onUnbind::All clients have unbound&quot;);
        return mAllowRebind;
    }
    @Override
    public void onRebind(Intent intent) {
        Log.i(TAG,&quot;onRebind::A client rebind to the service &quot; +
                &quot;after onUnbind() has already been called&quot;);
    }
    @Override
    public void onDestroy() {
        Log.i(TAG,&quot;onDestroy::The service is no longer used&quot;);
    }
}
</code></pre><script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      Android activity lifetime
    
    </summary>
    
      <category term="android" scheme="https://austinxishou.github.io/categories/android/"/>
    
    
      <category term="android" scheme="https://austinxishou.github.io/tags/android/"/>
    
      <category term="activity" scheme="https://austinxishou.github.io/tags/activity/"/>
    
  </entry>
  
  <entry>
    <title>Android源码环境集成预编译APK</title>
    <link href="https://austinxishou.github.io/2017/11/01/android/android-source-code-prebuild-apk/"/>
    <id>https://austinxishou.github.io/2017/11/01/android/android-source-code-prebuild-apk/</id>
    <published>2017-11-01T07:55:41.223Z</published>
    <updated>2017-09-06T02:13:08.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="系统集成任务"><a href="#系统集成任务" class="headerlink" title="系统集成任务"></a>系统集成任务</h2><blockquote>
<p>作为系统开发人员，经常需要集成第三方<code>APK</code> <code>JAR包</code> <code>so包</code>等;面对不同的情况,就要熟悉Android-mk语法的各种LOCAL_XXX变量,这篇文章就是对不同情况的一个梳理总结。</p>
</blockquote>
<p>首先需要了解</p>
<ol>
<li>Node Package Manager (NPM): 阅读 <a href="https://docs.npmjs.com/getting-started/what-is-npm" target="_blank" rel="external">Getting Started guide</a></li>
<li>Modern JavaScript with ES2015/16: 阅读 Babel 的 <a href="https://babeljs.io/learn-es2015/" target="_blank" rel="external">Learn ES2015 guide</a></li>
<li><a href="https://github.com/vuejs-templates/webpack-simple" target="_blank" rel="external"> webpack-simple</a></li>
<li><a href="https://egghead.io/courses/using-webpack-for-production-javascript-applications" target="_blank" rel="external"> 这个在 Egghead.io上的 高级 Webpack 课程</a></li>
<li><a href="https://vue-loader.vuejs.org/" target="_blank" rel="external">vue-loader</a></li>
</ol>
<p>//参考markdown格式</p>
<h2 id="集成可执行bin文件"><a href="#集成可执行bin文件" class="headerlink" title="集成可执行bin文件"></a>集成可执行bin文件</h2><p>例如:集成预编译好的busybox命令</p>
<figure class="highlight mk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">LOCAL_PATH:= <span class="variable">$(call my-dir)</span>  </div><div class="line">  </div><div class="line">include $(CLEAR_VARS)  </div><div class="line">LOCAL_MODULE        := busybox  </div><div class="line">LOCAL_MODULE_TAGS   := optional  </div><div class="line">LOCAL_MODULE_CLASS  := EXECUTABLES  </div><div class="line">LOCAL_SRC_FILES     := busybox  </div><div class="line">LOCAL_MODULE_PATH   := <span class="variable">$(PRODUCT_OUT)</span>/system/xbin  </div><div class="line">include $(BUILD_PREBUILT)</div></pre></td></tr></table></figure>
<h2 id="集成第三方jar包"><a href="#集成第三方jar包" class="headerlink" title="集成第三方jar包"></a>集成第三方jar包</h2><figure class="highlight mk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">LOCAL_PATH :=<span class="variable">$(call my-dir)</span>  </div><div class="line"></div><div class="line">include $(CLEAR_VARS)</div><div class="line">LOCAL_MODULE_TAGS := optional</div><div class="line">LOCAL_STATIC_JAVA_LIBRARIES :=zxing android-support-v4 android-support-v13  </div><div class="line">LOCAL_SRC_FILES :=<span class="variable">$(call all-java-files-under, src)</span>  </div><div class="line">LOCAL_PACKAGE_NAME := SetInput2  </div><div class="line">LOCAL_CERTIFICATE := platform</div><div class="line">  </div><div class="line">include $(BUILD_PACKAGE)  </div><div class="line"> </div><div class="line">include $(CLEAR_VARS)  </div><div class="line">LOCAL_PREBUILT_STATIC_JAVA_LIBRARIES :=zxing:libs/zxing-1.6-core.jar  </div><div class="line">include $(BUILD_MULTI_PREBUILT)</div></pre></td></tr></table></figure>
<h2 id="集成不带so包的apk"><a href="#集成不带so包的apk" class="headerlink" title="集成不带so包的apk"></a>集成不带so包的apk</h2><figure class="highlight mk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">LOCAL_PATH := <span class="variable">$(call my-dir)</span>  </div><div class="line">  </div><div class="line">include $(CLEAR_VARS)  </div><div class="line">LOCAL_MODULE_TAGS := optional  </div><div class="line">LOCAL_MODULE := rsota  </div><div class="line">LOCAL_SRC_FILES := <span class="variable">$(LOCAL_MODULE)</span>.apk  </div><div class="line">LOCAL_MODULE_CLASS  := APPS  </div><div class="line">LOCAL_MODULE_PATH := <span class="variable">$(PRODUCT_OUT)</span>/system/app  </div><div class="line">LOCAL_CERTIFICATE := platform     </div><div class="line">LOCAL_MODULE_SUFFIX := .apk  </div><div class="line">  </div><div class="line">include $(BUILD_PREBUILT)</div></pre></td></tr></table></figure>
<h2 id="集成带so的apk"><a href="#集成带so的apk" class="headerlink" title="集成带so的apk"></a>集成带so的apk</h2><figure class="highlight mk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<blockquote>
<p>在国内的Android生态中,所有的APP开发者都是一种流氓的心态,后台服务一大堆,还监听各种广播,导致用户根本不可能完全删除后台服务;有人说既然他们流氓,你不用他们就是,卸载掉啊!!哎,一些主流公司的APP,即使知道他流氓,还真的继续用它,比如支付宝\微信等;</p>
<p>所以采用冻结的方法是最有效,最干净的,只是可惜<strong> pm disable </strong>这个权限Android并没有对普通应用开放,也是一个蛋疼的事情.Android生态也是,申请各种权限不需要root,反而关闭权限需要;</p>
</blockquote>
<p>使用冻结APP的场景:</p>
<ol>
<li>某些应用开启大量后台服务,导致系统响应缓慢,再不能卸载的情况下,冻结它;</li>
<li>某些不常用的APP,但是需要的时候重新下载又麻烦,冻结它;</li>
<li>某些应用后台大量更新数据,消耗流量,冻结它;</li>
<li>冻结app解冻后,保留所有应用数据,不用担心数据丢失,账号重新登录等;</li>
</ol>
<h2 id="主要代码实现"><a href="#主要代码实现" class="headerlink" title="主要代码实现"></a>主要代码实现</h2><p>冻结APP<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">disableApp</span><span class="params">(String appPackageName)</span></span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        Process localProcess=Runtime.getRuntime().exec(<span class="string">"su"</span>);</div><div class="line">        String cmd=<span class="string">"pm disable "</span>+appPackageName+<span class="string">"\n"</span>;</div><div class="line">        DataOutputStream dataOutputStream=<span class="keyword">new</span> DataOutputStream(localProcess.getOutputStream());</div><div class="line">        dataOutputStream.writeBytes(cmd);</div><div class="line">        dataOutputStream.flush();</div><div class="line">        dataOutputStream.writeBytes(<span class="string">"exit\n"</span>);</div><div class="line"></div><div class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>解冻APP<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enableApp</span><span class="params">(String appPackageName)</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        Process localProcess=Runtime.getRuntime().exec(<span class="string">"su"</span>);</div><div class="line">        String cmd=<span class="string">"pm enable "</span>+appPackageName+<span class="string">"\n"</span>;</div><div class="line">        DataOutputStream dataOutputStream=<span class="keyword">new</span> DataOutputStream(localProcess.getOutputStream());</div><div class="line">        dataOutputStream.writeBytes(cmd);</div><div class="line">        dataOutputStream.flush();</div><div class="line">        dataOutputStream.writeBytes(<span class="string">"exit\n"</span>);</div><div class="line"></div><div class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><script><br>(function(){<br>    var bp = document.createElement(‘script’);<br>    var curProtocol = window.location.protocol.split(‘:’)[0];<br>    if (curProtocol === ‘https’) {<br>        bp.src = ‘<a href="https://zz.bdstatic.com/linksubmit/push.js">https://zz.bdstatic.com/linksubmit/push.js</a>‘;<br>    }<br>    else {<br>        bp.src = ‘<a href="http://push.zhanzhang.baidu.com/push.js">http://push.zhanzhang.baidu.com/push.js</a>‘;<br>    }<br>    var s = document.getElementsByTagName(“script”)[0];<br>    s.parentNode.insertBefore(bp, s);</p>
<pre><code>var sozzsrc = (document.location.protocol == &quot;http:&quot;) ? &quot;http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;:&quot;https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;;
document.write(&apos;&lt;script src=&quot;&apos; + sozzsrc + &apos;&quot; id=&quot;sozz&quot;&gt;&lt;\/script&gt;&apos;);
</code></pre><p>})();<br></script></p>
]]></content>
    
    <summary type="html">
    
      Android prebuild
    
    </summary>
    
      <category term="android" scheme="https://austinxishou.github.io/categories/android/"/>
    
    
      <category term="android" scheme="https://austinxishou.github.io/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>krpano入门资料</title>
    <link href="https://austinxishou.github.io/2017/11/01/krpano/krpano-dev-doc/"/>
    <id>https://austinxishou.github.io/2017/11/01/krpano/krpano-dev-doc/</id>
    <published>2017-11-01T07:55:31.191Z</published>
    <updated>2017-11-06T07:29:28.955Z</updated>
    
    <content type="html"><![CDATA[<h2 id="About-简介"><a href="#About-简介" class="headerlink" title="About 简介"></a>About 简介</h2><blockquote>
<p>Krpano 可以方便快速的构建全景场景或全景视频</p>
</blockquote>
<p><a href="https://krpano.com/" target="_blank" rel="external">Krpano官方网站</a><br><a href="https://krpano.milly.me/" target="_blank" rel="external">Krpano 非官方中文文档</a><br><a href="http://www.720ku.com/" target="_blank" rel="external">720ku</a><br><a href="http://720yun.com/" target="_blank" rel="external">720yun</a><br><a href="http://new720.com" target="_blank" rel="external">New720</a><br><a href="http://blog.new720.com" target="_blank" rel="external">New720-Blog</a></p>
<p><a href="http://www.krpano.tech/" target="_blank" rel="external">KRPano技术解密</a></p>
<p><a href="https://github.com/NalvyBoo/nodeKrpano" target="_blank" rel="external">Krpano 全景笔记</a></p>
<h2 id="成熟商业网站"><a href="#成熟商业网站" class="headerlink" title="成熟商业网站"></a>成熟商业网站</h2><p><a href="https://tourvista.co.uk/" target="_blank" rel="external">tourvista</a></p>
<p><a href="https://github.com/zjzcsongchi/hunyan" target="_blank" rel="external">hunyan</a></p>
<p><a href="https://github.com/wwzhao55/IncityPrograme" target="_blank" rel="external">印象城</a></p>
<p><a href="https://github.com/michaelchen2017/wowkb.com" target="_blank" rel="external">wowkb.com</a></p>
<p><a href="https://github.com/helix-Ain/OSP" target="_blank" rel="external">全景展示系统</a></p>
<h2 id="awesome-krpano"><a href="#awesome-krpano" class="headerlink" title="awesome krpano"></a>awesome krpano</h2><p><a href="https://github.com/gouldingken/krpano_tool_stereo" target="_blank" rel="external">krpano_tool_stereo</a></p>
<h2 id="Krpano-学习"><a href="#Krpano-学习" class="headerlink" title="Krpano 学习"></a>Krpano 学习</h2><h3 id="Embedding-into-HTML"><a href="#Embedding-into-HTML" class="headerlink" title="Embedding into HTML"></a>Embedding into HTML</h3><pre><code>嵌入到HTML文档
</code></pre><h3 id="XML文档"><a href="#XML文档" class="headerlink" title="XML文档"></a>XML文档</h3><ul>
<li><a href="#常用设置">常用设置</a><ul>
<li><a href="#小行星开场">小行星开场</a></li>
<li><a href="#加载动画">加载动画</a></li>
<li><a href="#修改右键菜单">修改右键菜单</a></li>
<li><a href="#自定义热点">自定义热点</a></li>
<li><a href="#隐藏皮肤">隐藏皮肤</a></li>
<li><a href="#动态热点">添加动态热点</a></li>
<li><a href="#动态热点添加始终显示的文字">动态热点添加始终显示的文字</a></li>
<li><a href="#热点和或图层在鼠标点击或鼠标悬停时进入动态模式">热点和或图层在鼠标点击或鼠标悬停时进入动态模式</a></li>
<li><a href="#拖拽热点">拖拽热点</a></li>
<li><a href="#添加简单的全景视频">添加简单的全景视频</a></li>
<li><a href="#添加雨雪特效">添加雨雪特效</a></li>
<li><a href="#自动旋转">自动旋转</a></li>
<li><a href="#无按钮控制的自动旋转">无按钮控制的自动旋转</a></li>
<li><a href="#按钮控制的自动旋转">按钮控制的自动旋转</a></li>
<li><a href="#添加陀螺仪">添加陀螺仪</a></li>
<li><a href="#场景过渡效果">场景过渡效果</a></li>
<li><a href="#隐藏显示热点">隐藏显示热点</a></li>
<li><a href="#获取全景视频进度">获取全景视频进度</a></li>
</ul>
</li>
</ul>
<h3 id="Actions-Scripting-动态执行动作及脚本"><a href="#Actions-Scripting-动态执行动作及脚本" class="headerlink" title="Actions / Scripting 动态执行动作及脚本"></a>Actions / Scripting 动态执行动作及脚本</h3><h3 id="HTML5"><a href="#HTML5" class="headerlink" title="HTML5"></a>HTML5</h3><h3 id="Javascript接口调用"><a href="#Javascript接口调用" class="headerlink" title="Javascript接口调用"></a>Javascript接口调用</h3><h2 id="全景场景插入平面视频"><a href="#全景场景插入平面视频" class="headerlink" title="全景场景插入平面视频"></a>全景场景插入平面视频</h2><p><a href="https://github.com/dee-wei/Krpano" target="_blank" rel="external">Krpano-video</a><br><a href="http://blog.new720.com/tour/video/video.html" target="_blank" rel="external">krpano内嵌视频编辑插件</a></p>
<h2 id="Krpano-精灵图（雪碧图-sprites）完美解决方案"><a href="#Krpano-精灵图（雪碧图-sprites）完美解决方案" class="headerlink" title="Krpano 精灵图（雪碧图 || sprites）完美解决方案"></a>Krpano 精灵图（雪碧图 || sprites）完美解决方案</h2><blockquote>
<p>做全景播放器的时候，我们们通常会用到各种各样的图标，播放暂停啊，全屏VR啊什么的，如果每个图标都用单张图片来引入的话，势必会产生非常多的HTTP请求，而我们知道，过多的HTTP请求是页面性能的大杀器，还好 Krpano-xml 的 layer 提供了 crop 属性给我们，这个属性可以让我们对图片进行切割，只显示切割出来的区域，和 CSS 精灵图使用 background-image 和 background-position 来进行图片显示的方式非常类似。</p>
</blockquote>
<p>下面是 krpano crop 属性示例：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">layer</span> </span></div><div class="line">	<span class="attr">name</span>=<span class="string">"some-image-layer"</span></div><div class="line">	<span class="attr">url</span>=<span class="string">"/foo/bar/image.png"</span></div><div class="line">	<span class="attr">crop</span>=<span class="string">"0|0|64|64"</span></div><div class="line">	/&gt;</div><div class="line">//上述代码的意思就是，从 x=0 y=0 坐标开始，截取图片的64x64宽高的区域来显示。</div></pre></td></tr></table></figure></p>
<blockquote>
<p>现在我们有了 krpano 精灵图的使用方法，但是当你有很多张图片的时候，手动管理这些坐标点的位置是一件非常非常非常麻烦的事情。</p>
</blockquote>
<p>CSS 精灵图已经有各种成熟的解决方案，比如博主喜欢的 gulp 插件 <a href="https://www.npmjs.com/package/sprity" target="_blank" rel="external">sprity</a> ，它可以一键拼合零碎图片，并且生成 CSS/LESS/SASS 代码，可惜 krpano-xml 相对来说太小众了，我找遍 google 并没有找到一个好的解决方案，所以是时候造个轮子了:grin:。</p>
<h2 id="Krpano-Plugins"><a href="#Krpano-Plugins" class="headerlink" title="Krpano-Plugins"></a>Krpano-Plugins</h2><h3 id="Videoplayer"><a href="#Videoplayer" class="headerlink" title="Videoplayer"></a>Videoplayer</h3><p>Videoplayer插件可用于在krpano内播放视频。<br>作为屏幕上的平面layer元素使用：<br>作为3D变形热点使用：<br>作为全景视频使用：</p>
<h2 id="krpano工程问题"><a href="#krpano工程问题" class="headerlink" title="krpano工程问题"></a>krpano工程问题</h2><ol>
<li><p>autorotate 自动旋转,自动播放<br> 全景图在开启了自动旋转后,会自动在间隔时间内,加载其他scene,但是自动旋转却会停止;<br> KEEPMOVING Autorotate</p>
</li>
<li><p>浏览器接受蓝牙控制</p>
</li>
</ol>
<p>蓝牙作为信息输入</p>
<p><a href="https://webbluetoothcg.github.io/web-bluetooth/" target="_blank" rel="external">Web Bluetooth</a></p>
<p><a href="http://caniuse.com" target="_blank" rel="external">caniuse</a></p>
<p>Web Bluetooth API</p>
<h2 id="热点"><a href="#热点" class="headerlink" title="热点"></a>热点</h2><h3 id="热点资源"><a href="#热点资源" class="headerlink" title="热点资源"></a>热点资源</h3><p><a href="https://pan.baidu.com/s/1pLHVCGr" target="_blank" rel="external">将多张图片合并成一个png序列图的小小工具-PngMergeHelper</a> 密码: wf65<br><a href="https://pan.baidu.com/s/1i45Gskt" target="_blank" rel="external">将多张jpg图片合并成一个jpg序列图的小小工具-JPGCombine</a> 密码: ecpr<br><a href="https://pan.baidu.com/s/1dEWmRCl" target="_blank" rel="external">将gif分离成多个png的小工具-GIF分离器</a> 密码: kti6</p>
<h3 id="动态热点代码分析"><a href="#动态热点代码分析" class="headerlink" title="动态热点代码分析"></a>动态热点代码分析</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;action name=&quot;do_animation_hotspot&quot;&gt;</div><div class="line">    &lt;!-- add attributes to the hotspot --&gt;</div><div class="line">    registerattribute(xframes, calc((imagewidth / %1) BOR 0));</div><div class="line">    registerattribute(yframes, calc((imageheight / %2) BOR 0));</div><div class="line">    registerattribute(frames, calc(xframes * yframes));</div><div class="line">    registerattribute(frame, 0);</div><div class="line"></div><div class="line">    set(crop, &apos;0|0|%1|%2&apos;);</div><div class="line"></div><div class="line">    setinterval(calc(&apos;crop_anim_&apos; + name), calc(1.0 / %3),</div><div class="line">        if(loaded,</div><div class="line">            inc(frame);</div><div class="line">            if(frame GE frames, if(onlastframe !== null, onlastframe() ); set(frame,0); );</div><div class="line">            mod(xpos, frame, xframes);</div><div class="line">            div(ypos, frame, xframes);</div><div class="line">            Math.floor(ypos);</div><div class="line">            mul(xpos, %1);</div><div class="line">            mul(ypos, %2);</div><div class="line">            calc(crop, xpos + &apos;|&apos; + ypos + &apos;|%1|%2&apos;);</div><div class="line">          ,</div><div class="line">            clearinterval(calc(&apos;crop_anim_&apos; + name));</div><div class="line">          );</div><div class="line">      );</div><div class="line">&lt;/action&gt;</div></pre></td></tr></table></figure>
<h3 id="动态热点上添加始终显示的文字"><a href="#动态热点上添加始终显示的文字" class="headerlink" title="动态热点上添加始终显示的文字"></a>动态热点上添加始终显示的文字</h3><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><h3 id="ABS-获取绝对位置"><a href="#ABS-获取绝对位置" class="headerlink" title="ABS-获取绝对位置"></a>ABS-获取绝对位置</h3><h3 id="折叠菜单"><a href="#折叠菜单" class="headerlink" title="折叠菜单"></a>折叠菜单</h3><p>Accordion Menu Plugin</p>
<h3 id="太阳光插件"><a href="#太阳光插件" class="headerlink" title="太阳光插件"></a>太阳光插件</h3><p><a href="http://www.krpano.tech/archives/400" target="_blank" rel="external">KRPANO太阳光插件</a></p>
<h3 id="密码插件"><a href="#密码插件" class="headerlink" title="密码插件"></a>密码插件</h3><p><a href="http://www.krpano.tech/archives/393" target="_blank" rel="external">KRPANO密码插件</a></p>
<h3 id="自动缩略图分组"><a href="#自动缩略图分组" class="headerlink" title="自动缩略图分组"></a>自动缩略图分组</h3><p><a href="https://krpano.com/plugins/userplugins/autothumbs/#top" target="_blank" rel="external">Auto Thumbs Plugin</a></p>
<h3 id="KRPANO二维码自动生成插件"><a href="#KRPANO二维码自动生成插件" class="headerlink" title="KRPANO二维码自动生成插件"></a>KRPANO二维码自动生成插件</h3><p><a href="http://www.krpano.tech/archives/295" target="_blank" rel="external">KRPANO二维码自动生成插件</a></p>
<h3 id="高德地图导航插件"><a href="#高德地图导航插件" class="headerlink" title="高德地图导航插件"></a>高德地图导航插件</h3><p><a href="http://www.krpano.tech/archives/289" target="_blank" rel="external">高德地图导航插件</a></p>
<h3 id="说一说插件"><a href="#说一说插件" class="headerlink" title="说一说插件"></a>说一说插件</h3><p><a href="http://www.krpano.tech/archives/269" target="_blank" rel="external">说一说插件</a></p>
<h2 id="多屏互动"><a href="#多屏互动" class="headerlink" title="多屏互动"></a>多屏互动</h2><p><a href="http://www.krpano.tech/archives/534" target="_blank" rel="external">KRPANO多屏互动原理</a><br><a href="https://github.com/vutdang/firstlook360" target="_blank" rel="external">firstlook360</a></p>
<h2 id="编辑器"><a href="#编辑器" class="headerlink" title="编辑器"></a>编辑器</h2><p><a href="https://github.com/orientalinformation/krtonducthang" target="_blank" rel="external">krtonducthang</a><br>    参考<br><a href="https://github.com/Arliki" target="_blank" rel="external">Arliki</a><br>    关注</p>
<p><a href="https://github.com/cantatas/smartcity" target="_blank" rel="external">易航智慧城市管理系统</a></p>
<p><a href="https://github.com/zhouzedeng/zedcloud" target="_blank" rel="external">zedcloud</a></p>
<p><a href="https://github.com/icey830/krpano-cms/commits/master" target="_blank" rel="external">krpano-cms</a></p>
<p><a href="https://github.com/michaelzhaofuning/vrm-php" target="_blank" rel="external">vrm-php</a></p>
<p><a href="https://github.com/xxweimei/krpano-editor-vuejs" target="_blank" rel="external">krpano-editor-vuejs</a></p>
<p><a href="https://github.com/JackGit/krpano-editor" target="_blank" rel="external">krpano-editor</a></p>
<p><a href="https://github.com/xxweimei/krpano-editor-js" target="_blank" rel="external">krpano-editor-js</a></p>
<h2 id="测试工程搭建"><a href="#测试工程搭建" class="headerlink" title="测试工程搭建"></a>测试工程搭建</h2><p>tour_testingserver.exe</p>
<h2 id="导航图功能"><a href="#导航图功能" class="headerlink" title="导航图功能"></a>导航图功能</h2><h2 id="实现浏览器后退加载场景"><a href="#实现浏览器后退加载场景" class="headerlink" title="实现浏览器后退加载场景"></a>实现浏览器后退加载场景</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//load pano on browser backbutton</div><div class="line">            window.onpopstate = function (event) &#123;</div><div class="line">                var scene = event.state.scene;</div><div class="line">                var vars = &quot;view.hlookat=&quot; + event.state.view.hlookat;</div><div class="line">                vars += &quot;&amp;view.vlookat=&quot;+ event.state.view.vlookat;</div><div class="line">                vars += &quot;&amp;view.fov=&quot;+ event.state.view.fov;</div><div class="line">               krpano().call(&quot;loadscene(&quot; + scene + &quot;,&quot; + vars + &quot;, MERGE, BLEND(1));&quot;);</div><div class="line"></div><div class="line">            &#125;;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">function krpano() &#123;</div><div class="line">    return document.getElementById(&quot;krpanoSWFObject&quot;);</div><div class="line">&#125;</div><div class="line">//called by scene loading</div><div class="line">function krp_pushState(scene, spot) &#123;</div><div class="line">    history.pushState(&#123; scene: scene, refspot:spot &#125;, scene, location.origin + &quot;/?ambiente=&quot; + scene);</div><div class="line">&#125;</div><div class="line">function krp_replaceState(scene, view) &#123;</div><div class="line">    history.replaceState(&#123; scene: scene, view:view &#125;,</div><div class="line">                            scene,</div><div class="line">                            location.origin + &quot;/?ambiente=&quot; + scene);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      krpano技术摘要，入门资料
    
    </summary>
    
      <category term="krpano" scheme="https://austinxishou.github.io/categories/krpano/"/>
    
    
      <category term="krpano" scheme="https://austinxishou.github.io/tags/krpano/"/>
    
  </entry>
  
  <entry>
    <title>人工智能学习路径</title>
    <link href="https://austinxishou.github.io/2017/11/01/AI/AI-learning-road/"/>
    <id>https://austinxishou.github.io/2017/11/01/AI/AI-learning-road/</id>
    <published>2017-11-01T07:53:58.885Z</published>
    <updated>2017-10-27T08:05:21.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="学习路径和资料"><a href="#学习路径和资料" class="headerlink" title="学习路径和资料"></a>学习路径和资料</h2><ol>
<li><a href="http://www.ppvke.com/Blog/archives/46893" target="_blank" rel="external">最佳AI /机器学习资源索引</a></li>
<li><a href="https://github.com/exacity/deeplearningbook-chinese" target="_blank" rel="external">Github开源资料</a></li>
<li><a href="http://blog.csdn.net/xummgg/article/details/69214366" target="_blank" rel="external">TensorFlow和深度学习入门教程</a></li>
<li><a href="https://github.com/collections/machine-learning" target="_blank" rel="external">Getting started with machine learning</a></li>
</ol>
<h2 id="社区和博客"><a href="#社区和博客" class="headerlink" title="社区和博客"></a>社区和博客</h2><ol>
<li><a href="http://geek.csdn.net/forum/AI" target="_blank" rel="external">CSDN人工智能专栏</a></li>
<li><a href="http://meta-guide.com/" target="_blank" rel="external">Meta Guides</a></li>
</ol>
<p><a href="https://github.com/Rochester-NRT/RocAlphaGo" target="_blank" rel="external">RocAlphaGo</a></p>
<p><a href="https://mast-group.github.io/" target="_blank" rel="external">MAST</a><br>    通过人工智能分析代码质量</p>
<p>## </p>
<p><a href="https://github.com/josephmisiti/awesome-machine-learning" target="_blank" rel="external">awesome-machine-learning</a><br><a href="https://github.com/jobbole/awesome-machine-learning-cn" target="_blank" rel="external">awesome-machine-learning-cn</a>                 机器学习资源大全中文版<br><a href="https://github.com/owainlewis/awesome-artificial-intelligence" target="_blank" rel="external">awesome-artificial-intelligence</a>    人工智能<br><a href="http://www.cnblogs.com/52machinelearning/p/5821555.html" target="_blank" rel="external">机器学习相关的Awesome系列</a></p>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      AI artificial intelligence
    
    </summary>
    
      <category term="AI" scheme="https://austinxishou.github.io/categories/AI/"/>
    
    
      <category term="AI" scheme="https://austinxishou.github.io/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>windows文件夹右键直接打开sublime</title>
    <link href="https://austinxishou.github.io/2017/11/01/python/win-director-sublime-open/"/>
    <id>https://austinxishou.github.io/2017/11/01/python/win-director-sublime-open/</id>
    <published>2017-11-01T07:52:13.057Z</published>
    <updated>2017-05-19T02:47:58.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p> 在web学习或开发中，会接触到各种Demo代码或者Github上的开源代码。要是每次都打开Sublime Text，然后把文件夹拖到里面，以打开一个文件夹，无疑是一件繁琐的事情。当然，你也可以使用Sublime Text里的project功能，不过个人觉得还是不够便捷。为什么不能在文件夹的右键菜单上添加一个”用Sublime Text打开“这样的菜单，直接打开呢？ok，懒人的方法来了。</p>
<p> 一般建立 “Open With Sublime Text” 右键菜单的办法是导入注册表文件，但是你可能使用的是 Sublime Text 2 的 Portable 版本，还需要修改 .reg 文件中 sublime_text.exe 的路径，这里给出更好的办法。</p>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ol>
<li><p>把以下保存成 .bat 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">set</span> ST_BIN=<span class="string">""</span><span class="string">"%~dp0sublime_text.exe"</span><span class="string">""</span></div><div class="line"></div><div class="line">reg add <span class="string">"HKCR\*\shell\Sublime Text 2"</span>                            /ve       /d <span class="string">"Open with Sublime Text 2"</span>       /f</div><div class="line">reg add <span class="string">"HKCR\*\shell\Sublime Text 2"</span>                            /v <span class="string">"Icon"</span> /d <span class="string">"%ST_BIN%,0"</span>                     /f</div><div class="line">reg add <span class="string">"HKCR\*\shell\Sublime Text 2\command"</span>                    /ve       /d <span class="string">"%ST_BIN% "</span><span class="string">""</span>%%1<span class="string">""</span><span class="string">""</span>             /f</div><div class="line"></div><div class="line">reg add <span class="string">"HKCR\Directory\shell\Sublime Text 2"</span>                    /ve       /d <span class="string">"Open Folder as Sublime Project"</span> /f</div><div class="line">reg add <span class="string">"HKCR\Directory\shell\Sublime Text 2"</span>                    /v <span class="string">"Icon"</span> /d <span class="string">"%ST_BIN%,0"</span>                     /f</div><div class="line">reg add <span class="string">"HKCR\Directory\shell\Sublime Text 2\command"</span>            /ve       /d <span class="string">"%ST_BIN% "</span><span class="string">""</span>%%V<span class="string">""</span><span class="string">""</span>             /f</div><div class="line"></div><div class="line">reg add <span class="string">"HKCR\Directory\Background\shell\Sublime Text 2"</span>         /ve       /d <span class="string">"Open Folder as Sublime Project"</span> /f</div><div class="line">reg add <span class="string">"HKCR\Directory\Background\shell\Sublime Text 2"</span>         /v <span class="string">"Icon"</span> /d <span class="string">"%ST_BIN%,0"</span>                     /f</div><div class="line">reg add <span class="string">"HKCR\Directory\Background\shell\Sublime Text 2\command"</span> /ve       /d <span class="string">"%ST_BIN% "</span><span class="string">""</span>%%V<span class="string">""</span><span class="string">""</span>             /f</div><div class="line"></div><div class="line">@echo.</div><div class="line">@pause</div></pre></td></tr></table></figure>
</li>
<li><p>放到 sublime_text.exe 所在目录下</p>
</li>
<li><p>以管理员身份运行该 .bat</p>
</li>
</ol>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><ol>
<li>在文件上点右键会出现 “Open with Sublime Text 2”</li>
<li>在文件夹或资源管理器的背景空白处点右键会出现 “Open Folder as Sublime Project”</li>
<li><p>带有 /v “Icon” 的那几行是增加菜单项前的图标，如果你不需要可以删掉它</p>
<script>
(function(){
 var bp = document.createElement('script');
 var curProtocol = window.location.protocol.split(':')[0];
 if (curProtocol === 'https') {
     bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
 }
 else {
     bp.src = 'http://push.zhanzhang.baidu.com/push.js';
 }
 var s = document.getElementsByTagName("script")[0];
 s.parentNode.insertBefore(bp, s);

 var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
 document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      windows文件夹右键直接打开sublime sublime 技巧
    
    </summary>
    
      <category term="python sublime" scheme="https://austinxishou.github.io/categories/python-sublime/"/>
    
    
      <category term="python" scheme="https://austinxishou.github.io/tags/python/"/>
    
      <category term="sublime" scheme="https://austinxishou.github.io/tags/sublime/"/>
    
  </entry>
  
  <entry>
    <title>hexo 插件推荐收藏</title>
    <link href="https://austinxishou.github.io/2017/11/01/webdesign/hexo-plugin/"/>
    <id>https://austinxishou.github.io/2017/11/01/webdesign/hexo-plugin/</id>
    <published>2017-11-01T07:52:12.916Z</published>
    <updated>2017-05-18T08:32:24.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Hexo七牛同步插件"><a href="#Hexo七牛同步插件" class="headerlink" title="Hexo七牛同步插件"></a>Hexo七牛同步插件</h2><p><a href="https://github.com/gyk001/hexo-qiniu-sync" target="_blank" rel="external">Hexo七牛同步插件</a></p>
<p><strong> 简介 </strong><br>这是一个hexo插件， 可以让你在文档中入嵌存储在七牛上的图片、JS、CSS类型的静态文件。</p>
<p>你可以不用手动上传文件到七牛，插件会自动帮你将本地目录的文件同步到七牛。</p>
<h2 id="TF-IDF自动提取摘要"><a href="#TF-IDF自动提取摘要" class="headerlink" title="TF-IDF自动提取摘要"></a>TF-IDF自动提取摘要</h2><p><a href="https://github.com/vfasky/hexo-summarizer" target="_blank" rel="external">TF-IDF自动提取摘要</a></p>
<p><strong> 简介 </strong><br>根据文章内容,自动提取文章摘要</p>
<h2 id="百度链接自动提交"><a href="#百度链接自动提交" class="headerlink" title="百度链接自动提交"></a>百度链接自动提交</h2><p><a href="https://github.com/xuanmiaog/hexo-baidu-url-push" target="_blank" rel="external">hexo-baidu-url-push</a></p>
<p><strong> 简介 </strong><br>自动推送是百度站长平台为提高站点新增网页发现速度推出的工具，安装自动推送JS代码的网页，在页面被访问时，页面URL将立即被推送给百度。</p>
<h2 id="百度链接主动推送"><a href="#百度链接主动推送" class="headerlink" title="百度链接主动推送"></a>百度链接主动推送</h2><p><a href="https://github.com/huiwang/hexo-baidu-url-submit" target="_blank" rel="external">hexo-baidu-url-submit</a></p>
<p><strong> 简介 </strong><br>主动推送Hexo博客新链接至百度搜索引擎，解决百度爬虫被禁止访问的问题，提升网站收录质量和速度。<script><br>(function(){<br>    var bp = document.createElement(‘script’);<br>    var curProtocol = window.location.protocol.split(‘:’)[0];<br>    if (curProtocol === ‘https’) {<br>        bp.src = ‘<a href="https://zz.bdstatic.com/linksubmit/push.js">https://zz.bdstatic.com/linksubmit/push.js</a>‘;<br>    }<br>    else {<br>        bp.src = ‘<a href="http://push.zhanzhang.baidu.com/push.js">http://push.zhanzhang.baidu.com/push.js</a>‘;<br>    }<br>    var s = document.getElementsByTagName(“script”)[0];<br>    s.parentNode.insertBefore(bp, s);</p>
<pre><code>var sozzsrc = (document.location.protocol == &quot;http:&quot;) ? &quot;http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;:&quot;https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;;
document.write(&apos;&lt;script src=&quot;&apos; + sozzsrc + &apos;&quot; id=&quot;sozz&quot;&gt;&lt;\/script&gt;&apos;);
</code></pre><p>})();<br></script></p>
]]></content>
    
    <summary type="html">
    
      hexo 插件推荐收藏 hexo常用插件 hexo-plugin
    
    </summary>
    
      <category term="android" scheme="https://austinxishou.github.io/categories/android/"/>
    
    
      <category term="hexo" scheme="https://austinxishou.github.io/tags/hexo/"/>
    
      <category term="plugin" scheme="https://austinxishou.github.io/tags/plugin/"/>
    
  </entry>
  
  <entry>
    <title>youtube-dl视频下载工具使用</title>
    <link href="https://austinxishou.github.io/2017/11/01/python/youtube-dl-cmd-usage/"/>
    <id>https://austinxishou.github.io/2017/11/01/python/youtube-dl-cmd-usage/</id>
    <published>2017-11-01T07:52:12.833Z</published>
    <updated>2017-05-17T10:41:38.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="About-简介"><a href="#About-简介" class="headerlink" title="About-简介"></a>About-简介</h2><p>通常用于下载网站视频的工具有youtube-dl和You-Get;经过测试发现,下载国外视频用youtube-dl比较方便,下载国内视频用You-Get;</p>
<p>不过,由于youtube-dl支持的是Python 2.6, 2.7, or 3.2+,相对来说会方便很多;</p>
<p>这篇文章主要介绍youtube-dl 命令行工具的使用,以及如何在python代码中调用外部 youtube-dl 命令,执行下载操作;</p>
<p><a href="https://yt-dl.org/" target="_blank" rel="external">youtube-dl官网</a><br><a href="https://github.com/rg3/youtube-dl" target="_blank" rel="external">youtube-dlGithub</a></p>
<h2 id="Download-and-Install-下载安装"><a href="#Download-and-Install-下载安装" class="headerlink" title="Download and Install-下载安装"></a>Download and Install-下载安装</h2><ul>
<li><p>方式一 下载Windows exe程序使用<br>  从官网下载<a href="http://rg3.github.io/youtube-dl/download.html" target="_blank" rel="external">youtube-dl.exe</a><br>  然后放在电脑的任意目录下即可使用;可以通过下面的命令来更新youtube-dl</p>
</li>
<li><p>方式二 直接使用命令行来安装<br>  在安装了Python之后,按Win+R键打开运行，输入cmd，再输入下面的代码即可自动下载安装youtube-dl</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pip install youtube-dl //直接安装youtube-dl</div><div class="line">pip install --upgrade youtube-dl //安装youtube-dl并更新</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Usage-使用"><a href="#Usage-使用" class="headerlink" title="Usage-使用"></a>Usage-使用</h2><p>命令格式为:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">youtube-dl [OPTIONS] URL [URL...]</div></pre></td></tr></table></figure>
<p><strong> 常用的选项有:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">-h, --help                       打印帮助</div><div class="line">--version                        显示版本</div><div class="line">-U, --update                     升级</div><div class="line">-i, --ignore-errors              忽略错误继续执行下载操作</div><div class="line">--abort-on-error                 出现错误中断下载</div><div class="line">--dump-user-agent                显示当前的用户代理信息</div><div class="line">--list-extractors                显示所有的支持解析</div><div class="line">--extractor-descriptions         显示所有的支持解析的描述</div><div class="line">--force-generic-extractor        使用通用的解析器强制下载</div><div class="line">--default-search PREFIX          对未校验的链接使用默认的前缀</div><div class="line">--ignore-config                  忽略配置文件</div><div class="line">--config-location PATH           使用本地的配置文件</div><div class="line">--flat-playlist                  不解析播放列表,仅仅显示</div><div class="line">--mark-watched                   标记视频已看过</div><div class="line">--no-mark-watched                不标记已观看</div><div class="line">--no-color                       忽略颜色输出</div></pre></td></tr></table></figure>
<p><strong> 网络 选项 </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">--proxy URL                      使用指定的代理</div><div class="line">--socket-timeout SECONDS         设置超时时间</div><div class="line">--source-address IP              绑定客户端IP地址</div><div class="line"><span class="number">-4</span>, --force-ipv4                 设置所有链接为 IPv4</div><div class="line"><span class="number">-6</span>, --force-ipv6                 设置所有链接为 IPv6</div></pre></td></tr></table></figure>
<p><strong> 视频选择 </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">--playlist-start NUMBER          播放列表起始位置(默认为 <span class="number">1</span>)</div><div class="line">--playlist-end NUMBER            播放列表结束位置(默认为 最后)</div><div class="line">--playlist-items ITEM_SPEC       播放列表特定选项进行下载</div><div class="line">--match-title REGEX              只下载匹配相应标题的视频</div><div class="line">--reject-title REGEX             跳过已经看过的视频</div><div class="line">--max-downloads NUMBER           设置最大下载数量</div><div class="line">--min-filesize SIZE              不下载视频大小小于设定值的视频</div><div class="line">--max-filesize SIZE              不下载视频大小大于设定值的视频</div><div class="line">--date DATE                      只下载更新日期为DATE的视频</div><div class="line">--datebefore DATE                只下载更新日期早于DATE的视频</div><div class="line">--dateafter DATE                 只下载更新日期晚于DATE的视频</div><div class="line">--min-views COUNT                不下载视频数量小于设定值的视频</div><div class="line">--max-views COUNT                不下载视频数量大于设定值的视频</div><div class="line">--match-filter FILTER            设置通用的视频过滤器</div><div class="line">--no-playlist                    如果连接指向视频和播放列表,只下载视频</div><div class="line">--yes-playlist                   如果连接指向视频和播放列表,只下载播放列表</div><div class="line">--age-limit YEARS                只下载指定年份的视频</div><div class="line">--download-archive FILE          只下载archive文件中没有的视频</div><div class="line">--include-ads                    广告视频也一起下载</div></pre></td></tr></table></figure>
<p><strong> 下载选项 </strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">-r, --limit-rate RATE            设置下载最大sulv</div><div class="line">-R, --retries RETRIES            最大的尝试次数</div><div class="line">--fragment-retries RETRIES       fragment窗口最大的尝试次数</div><div class="line">--skip-unavailable-fragments     跳过无效的fragment窗口</div><div class="line">--abort-on-unavailable-fragment  当某些窗口失效时,停止下载</div><div class="line">--buffer-size SIZE               设置下载缓存</div><div class="line">--no-resize-buffer               不要进行下载缓存的自适应</div><div class="line">--playlist-reverse               反向下载播放列表视频</div><div class="line">--playlist-random                随机下载播放列表视频</div><div class="line">--xattr-set-filesize             设置文件xattr属性大小</div><div class="line">--hls-prefer-native              使用HLS下载器替代 ffmpeg                                 </div><div class="line">--hls-prefer-ffmpeg              使用ffmpeg下载器替代HLS</div><div class="line">--external-downloader COMMAND    使用外部下载器,目前支持:</div><div class="line">                                 aria2c,avconv,axel,curl,ffmpeg,httpie,wget</div><div class="line">--external-downloader-args ARGS  设置外部下载器参数</div></pre></td></tr></table></figure></p>
<p><strong> 文件系统选项 </strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">-a, --batch-file FILE            下载指定文件包含的url链接视频</div><div class="line">--id                             文件名使用视频ID值</div><div class="line">-o, --output TEMPLATE            设置输出临时文件名</div><div class="line">--autonumber-start NUMBER        指定开始数值<span class="keyword">for</span> %(autonumber)s(默认为<span class="number">1</span>)</div><div class="line">--restrict-filenames             限制文件名使用ASCII编码</div><div class="line">-w, --no-overwrites              不要覆盖文件</div><div class="line">-c, --<span class="keyword">continue</span>                   强制恢复下载文件</div><div class="line">--no-<span class="keyword">continue</span>                    不要恢复下载文件</div><div class="line">--no-part                        不要使用.part 文件 - 直接写入到输出文件</div><div class="line">--no-mtime                       不要使用最后的修改时间</div><div class="line">--write-description              输出视频描述到指定文件</div><div class="line">--write-info-json                输出视频元数据metadata 到.info.json 文件</div><div class="line">--write-annotations              输出视频标记信息到.annotations.xml 文件</div><div class="line">--load-info-json FILE            载入视频信息文件</div><div class="line">--cookies FILE                   缓存文件</div><div class="line">--cache-dir DIR                  指定缓存文件目录</div><div class="line">--no-cache-dir                   关闭文件系统缓存</div><div class="line">--rm-cache-dir                   删除所有文件系统缓存文件</div></pre></td></tr></table></figure></p>
<p><strong> 缩略图选项 </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">--write-thumbnail                下载缩略图</div><div class="line">--write-all-thumbnails           下载所有格式的缩略图</div><div class="line">--list-thumbnails                仅仅显示缩略图列表</div></pre></td></tr></table></figure>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      youtube-dl视频下载工具使用
    
    </summary>
    
      <category term="python" scheme="https://austinxishou.github.io/categories/python/"/>
    
    
      <category term="python" scheme="https://austinxishou.github.io/tags/python/"/>
    
      <category term="youtube-dl" scheme="https://austinxishou.github.io/tags/youtube-dl/"/>
    
  </entry>
  
  <entry>
    <title>python多线程以及执行本地命令技术要点</title>
    <link href="https://austinxishou.github.io/2017/11/01/python/python-subprocess-popen-usage/"/>
    <id>https://austinxishou.github.io/2017/11/01/python/python-subprocess-popen-usage/</id>
    <published>2017-11-01T07:52:12.660Z</published>
    <updated>2017-05-17T05:57:35.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="subprocess-About-简介"><a href="#subprocess-About-简介" class="headerlink" title="subprocess-About-简介"></a>subprocess-About-简介</h2><p><code>subprocess</code> 模块用来创建新的进程，连接到其stdin、stdout、stderr管道并获取它们的返回码。</p>
<p>subprocess模块的出现是为了替代旧模块及函数：<code>os.system</code>、<code>os.spawn*</code>、<code>os.popen*</code>、<code>popen2.*</code>、<code>commands.*</code>。</p>
<p>强烈建议POSIX用户（Linux、BSD等）安装并使用较新的<code>subprocess32</code>模块，而不是Python 2.7自带的subprocess。</p>
<p>推荐用户使用<code>call</code>、<code>check_call</code>和<code>check_output</code>这三个快捷函数，在无法满足需求的时候才使用更高级的<code>Popen</code>接口。</p>
<h2 id="subprocess-call-调用"><a href="#subprocess-call-调用" class="headerlink" title="subprocess.call-调用"></a>subprocess.call-调用</h2><p>call函数可以认为是对<code>popen</code>和<code>wait</code>的分装，直接对<code>call</code>函数传入要执行的命令行，将命令行的退出code返回。</p>
<p>运行由<code>args</code>参数提供的命令，等待命令执行结束并返回返回码。args参数由字符串形式提供且有多个命令参数时，</p>
<p>需要提供<code>shell=True</code>参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subprocess.call(args, *, stdin= <span class="keyword">None</span>, stdout = <span class="keyword">None</span>, stderr = <span class="keyword">None</span>, shell = <span class="keyword">False</span>)</div></pre></td></tr></table></figure>
<blockquote>
<p>注意不要为stdout和stderr参数赋值subprocess.PIPE，如果子进程输出量较多会造成死锁，这两个参数可以赋值为subprocess.STDOUT打印到屏幕或者赋值为一个文件对象将输出写入文件：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">//test.py-示例</div><div class="line"><span class="keyword">import</span> subprocess <span class="keyword">as</span> sp</div><div class="line">sp.call(<span class="string">'python run.py'</span>, shell = <span class="keyword">True</span>, stdin=open(<span class="string">'fake_input'</span>, <span class="string">'r'</span>), stdout=open(<span class="string">'result'</span>, <span class="string">'w'</span>))</div></pre></td></tr></table></figure>
<h2 id="subprocess-check-call-调用返回确认"><a href="#subprocess-check-call-调用返回确认" class="headerlink" title="subprocess.check_call-调用返回确认"></a>subprocess.check_call-调用返回确认</h2><p>与call方法类似，不同在于如果命令行执行成功，<code>check_call</code>返回返回码0，否则抛出subprocess.CalledProcessError异常。 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subprocess.check_call(args, *, stdin = <span class="keyword">None</span>, stdout = <span class="keyword">None</span>, stderr = <span class="keyword">None</span>, shell = <span class="keyword">False</span>)</div></pre></td></tr></table></figure>
<h2 id="subprocess-check-output-调用输出确认"><a href="#subprocess-check-output-调用输出确认" class="headerlink" title="subprocess.check_output-调用输出确认"></a>subprocess.check_output-调用输出确认</h2><p>在子进程执行命令，以字符串形式返回执行结果的输出。如果子进程退出码不是0，抛出subprocess.CalledProcessError异常，异常的output字段包含错误输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subprocess.check_output(args, *, stdin = <span class="keyword">None</span>, stderr = <span class="keyword">None</span>, shell = <span class="keyword">False</span>, universal_newlines = <span class="keyword">False</span>)</div></pre></td></tr></table></figure>
<h2 id="subprocess-Popen-管道调用"><a href="#subprocess-Popen-管道调用" class="headerlink" title="subprocess.Popen 管道调用"></a>subprocess.Popen 管道调用</h2><h3 id="开启新进程"><a href="#开启新进程" class="headerlink" title="开启新进程"></a>开启新进程</h3><p>Popen启动新的进程与父进程并行执行，默认父进程不等待新进程结束。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestPopen</span><span class="params">()</span>:</span></div><div class="line">  <span class="keyword">import</span> subprocess</div><div class="line">  p=subprocess.Popen(<span class="string">"dir"</span>,shell=<span class="keyword">True</span>)</div><div class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">250</span>) :</div><div class="line">    <span class="keyword">print</span> (<span class="string">"other things"</span>)</div></pre></td></tr></table></figure>
<h3 id="等待子进程结束"><a href="#等待子进程结束" class="headerlink" title="等待子进程结束"></a>等待子进程结束</h3><p><code>p.wait</code>函数使得父进程等待新创建的进程运行结束，然后再继续父进程的其他任务。且此时可以在<code>p.returncode</code>中得到新进程的返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestWait</span><span class="params">()</span>:</span></div><div class="line">  <span class="keyword">import</span> subprocess</div><div class="line">  <span class="keyword">import</span> datetime</div><div class="line">  <span class="keyword">print</span> (datetime.datetime.now())</div><div class="line">  p=subprocess.Popen(<span class="string">"sleep 10"</span>,shell=<span class="keyword">True</span>)</div><div class="line">  p.wait()</div><div class="line">  <span class="keyword">print</span> (p.returncode)</div><div class="line">  <span class="keyword">print</span> (datetime.datetime.now())</div></pre></td></tr></table></figure>
<h3 id="poll等待"><a href="#poll等待" class="headerlink" title="poll等待"></a>poll等待</h3><p><code>p.poll</code>函数可以用来检测新创建的进程是否结束。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestPoll</span><span class="params">()</span>:</span></div><div class="line">  <span class="keyword">import</span> subprocess</div><div class="line">  <span class="keyword">import</span> datetime</div><div class="line">  <span class="keyword">import</span> time</div><div class="line">  <span class="keyword">print</span> (datetime.datetime.now())</div><div class="line">  p=subprocess.Popen(<span class="string">"sleep 10"</span>,shell=<span class="keyword">True</span>)</div><div class="line">  t = <span class="number">1</span></div><div class="line">  <span class="keyword">while</span>(t &lt;= <span class="number">5</span>):</div><div class="line">    time.sleep(<span class="number">1</span>)</div><div class="line">    p.poll()</div><div class="line">    <span class="keyword">print</span> (p.returncode)</div><div class="line">    t+=<span class="number">1</span></div><div class="line">  <span class="keyword">print</span> (datetime.datetime.now())</div></pre></td></tr></table></figure>
<h3 id="结束进程"><a href="#结束进程" class="headerlink" title="结束进程"></a>结束进程</h3><p><code>p.kill</code>或<code>p.terminate</code>用来结束创建的新进程，在windows系统上相当于调用<code>TerminateProcess()</code>，在posix系统上相当于发送信号SIGTERM和SIGKILL。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestKillAndTerminate</span><span class="params">()</span>:</span></div><div class="line">    p=subprocess.Popen(<span class="string">"notepad.exe"</span>)</div><div class="line">    t = <span class="number">1</span></div><div class="line">    <span class="keyword">while</span>(t &lt;= <span class="number">5</span>):</div><div class="line">      time.sleep(<span class="number">1</span>)</div><div class="line">      t +=<span class="number">1</span></div><div class="line">    p.kill()</div><div class="line">    <span class="comment">#p.terminate()</span></div><div class="line">    <span class="keyword">print</span> (<span class="string">"new process was killed"</span>)</div></pre></td></tr></table></figure>
<h3 id="与子进程交互"><a href="#与子进程交互" class="headerlink" title="与子进程交互"></a>与子进程交互</h3><p><code>p.communicate</code>可以与新进程交互，但是必须要在popen构造时候将管道重定向。</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestCommunicate</span><span class="params">()</span>:</span></div><div class="line">  <span class="keyword">import</span> subprocess</div><div class="line">  cmd = <span class="string">"dir"</span></div><div class="line">  p=subprocess.Popen(cmd, shell=<span class="keyword">True</span>, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)</div><div class="line">  (stdoutdata, stderrdata) = p.communicate()</div><div class="line">  </div><div class="line">  <span class="keyword">if</span> p.returncode != <span class="number">0</span>:</div><div class="line">        <span class="keyword">print</span> (cmd + <span class="string">"error !"</span>)</div><div class="line">  <span class="comment">#defaultly the return stdoutdata is bytes, need convert to str and utf8</span></div><div class="line">  <span class="keyword">for</span> r <span class="keyword">in</span> str(stdoutdata,encoding=<span class="string">'utf8'</span> ).split(<span class="string">"\n"</span>):</div><div class="line">    <span class="keyword">print</span> (r)</div><div class="line">  <span class="keyword">print</span> (p.returncode)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestCommunicate2</span><span class="params">()</span>:</span></div><div class="line">  <span class="keyword">import</span> subprocess</div><div class="line">  cmd = <span class="string">"dir"</span></div><div class="line">  <span class="comment">#universal_newlines=True, it means by text way to open stdout and stderr</span></div><div class="line">  p = subprocess.Popen(cmd, shell=<span class="keyword">True</span>, universal_newlines=<span class="keyword">True</span>, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)</div><div class="line">  curline = p.stdout.readline()</div><div class="line">  <span class="keyword">while</span>(curline != <span class="string">""</span>):</div><div class="line">        <span class="keyword">print</span> (curline)</div><div class="line">        curline = p.stdout.readline()</div><div class="line">  p.wait()</div><div class="line">  <span class="keyword">print</span> (p.returncode)</div></pre></td></tr></table></figure><script><br>(function(){<br>    var bp = document.createElement(‘script’);<br>    var curProtocol = window.location.protocol.split(‘:’)[0];<br>    if (curProtocol === ‘https’) {<br>        bp.src = ‘<a href="https://zz.bdstatic.com/linksubmit/push.js">https://zz.bdstatic.com/linksubmit/push.js</a>‘;<br>    }<br>    else {<br>        bp.src = ‘<a href="http://push.zhanzhang.baidu.com/push.js">http://push.zhanzhang.baidu.com/push.js</a>‘;<br>    }<br>    var s = document.getElementsByTagName(“script”)[0];<br>    s.parentNode.insertBefore(bp, s);</p>
<pre><code>var sozzsrc = (document.location.protocol == &quot;http:&quot;) ? &quot;http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;:&quot;https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;;
document.write(&apos;&lt;script src=&quot;&apos; + sozzsrc + &apos;&quot; id=&quot;sozz&quot;&gt;&lt;\/script&gt;&apos;);
</code></pre><p>})();<br></script></p>
]]></content>
    
    <summary type="html">
    
      python多线程以及执行本地命令技术要点  Run Shell Commands in Python
    
    </summary>
    
      <category term="python" scheme="https://austinxishou.github.io/categories/python/"/>
    
    
      <category term="python" scheme="https://austinxishou.github.io/tags/python/"/>
    
      <category term="scrapy" scheme="https://austinxishou.github.io/tags/scrapy/"/>
    
  </entry>
  
  <entry>
    <title>python结巴分词jieba技术集成应用说明</title>
    <link href="https://austinxishou.github.io/2017/11/01/python/python-jieba-fenci-usage/"/>
    <id>https://austinxishou.github.io/2017/11/01/python/python-jieba-fenci-usage/</id>
    <published>2017-11-01T07:52:12.608Z</published>
    <updated>2017-05-17T02:03:35.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="About-简介说明"><a href="#About-简介说明" class="headerlink" title="About-简介说明"></a>About-简介说明</h2><p><a href="https://github.com/fxsjy/jieba/" target="_blank" rel="external">jieba-Github</a></p>
<p>结巴支持三种分词模式:</p>
<ol>
<li>精确模式，试图将句子最精确地切开，适合文本分析； </li>
<li>全模式，把句子中所有的可以成词的词语都扫描出来, 速度非常快，但是不能解决歧义； </li>
<li>搜索引擎模式，在精确模式的基础上，对长词再次切分，提高召回率，适合用于搜索引擎分词。</li>
</ol>
<p>结巴支持繁体分词</p>
<p>结巴支持自定义词典</p>
<p><strong>算法实现简析</strong></p>
<blockquote>
<p>基于Trie树结构实现高效的词图扫描，生成句子中汉字所有可能成词情况所构成的有向无环图（DAG)<br>采用了动态规划查找最大概率路径, 找出基于词频的最大切分组合<br>对于未登录词，采用了基于汉字成词能力的HMM模型，使用了Viterbi算法</p>
</blockquote>
<h2 id="Install-安装"><a href="#Install-安装" class="headerlink" title="Install-安装"></a>Install-安装</h2><p><strong> Python 2.x 下的安装 </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install jieba</div></pre></td></tr></table></figure>
<p>或者进行下载后自行引入;</p>
<p><strong> Python 3.x 下的安装 </strong></p>
<blockquote>
<p>  目前master分支是只支持Python2.x 的<br>  Python3.x 版本的分支也已经基本可用： <a href="https://github.com/fxsjy/jieba/tree/jieba3k" target="_blank" rel="external">https://github.com/fxsjy/jieba/tree/jieba3k</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/fxsjy/jieba.git  </div><div class="line">git checkout jieba3k  </div><div class="line">python setup.py install</div></pre></td></tr></table></figure>
<h2 id="Usage-应用"><a href="#Usage-应用" class="headerlink" title="Usage-应用"></a>Usage-应用</h2><h3 id="分词"><a href="#分词" class="headerlink" title="分词"></a>分词</h3><p><strong>函数: jieba.cut</strong></p>
<blockquote>
<p>jieba.cut方法接受两个输入参数: </p>
<pre><code>+ 1) 第一个参数为需要分词的字符串 
+ 2）cut_all参数用来控制是否采用全模式
</code></pre><p>jieba.cut_for_search方法接受一个参数：</p>
<pre><code>+ 需要分词的字符串,该方法适合用于搜索引擎构建倒排索引的分词，粒度比较细 
</code></pre><p>注意：待分词的字符串可以是gbk字符串、utf-8字符串或者unicode </p>
<p> jieba.cut以及jieba.cut_for_search返回的结构都是一个可迭代的generator，可以使用for循环来获得分词后得到的每一个词语(unicode)，也可以用list(jieba.cut(…))转化为list</p>
</blockquote>
<p><strong> 代码示例 </strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#encoding=utf-8  </span></div><div class="line"><span class="keyword">import</span> jieba  </div><div class="line">seg_list = jieba.cut(<span class="string">"我来到北京清华大学"</span>, cut_all=<span class="keyword">True</span>)  </div><div class="line"><span class="keyword">print</span> <span class="string">"Full Mode:"</span>, <span class="string">"/ "</span>.join(seg_list)  <span class="comment"># 全模式  </span></div><div class="line">seg_list = jieba.cut(<span class="string">"我来到北京清华大学"</span>, cut_all=<span class="keyword">False</span>)  </div><div class="line"><span class="keyword">print</span> <span class="string">"Default Mode:"</span>, <span class="string">"/ "</span>.join(seg_list)  <span class="comment"># 精确模式  </span></div><div class="line">seg_list = jieba.cut(<span class="string">"他来到了网易杭研大厦"</span>)  <span class="comment"># 默认是精确模式  </span></div><div class="line"><span class="keyword">print</span> <span class="string">", "</span>.join(seg_list)  </div><div class="line">seg_list = jieba.cut_for_search(<span class="string">"小明硕士毕业于中国科学院计算所，后在日本京都大学深造"</span>)  <span class="comment"># 搜索引擎模式  </span></div><div class="line"><span class="keyword">print</span> <span class="string">", "</span>.join(seg_list)</div></pre></td></tr></table></figure></p>
<p>输出为:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Output: </div><div class="line">【全模式】: 我/ 来到/ 北京/ 清华/ 清华大学/ 华大/ 大学 </div><div class="line">【精确模式】: 我/ 来到/ 北京/ 清华大学 </div><div class="line">【新词识别】：他, 来到, 了, 网易, 杭研, 大厦    (此处，“杭研”并没有在词典中，但是也被Viterbi算法识别出来了) </div><div class="line">【搜索引擎模式】： 小明, 硕士, 毕业, 于, 中国, 科学, 学院, 科学院, 中国科学院, 计算, 计算所, 后, 在, 日本, 京都, 大学, 日本京都大学, 深造</div></pre></td></tr></table></figure></p>
<h3 id="添加自定义词典"><a href="#添加自定义词典" class="headerlink" title="添加自定义词典"></a>添加自定义词典</h3><blockquote>
<p>开发者可以指定自己自定义的词典，以便包含jieba词库里没有的词。虽然jieba有新词识别能力，但是自行添加新词可以保证更高的正确率 </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jieba.load_userdict(file_name) <span class="comment"># file_name为自定义词典的路径</span></div></pre></td></tr></table></figure>
<blockquote>
<p>词典格式和dict.txt一样，一个词占一行；每一行分三部分，一部分为词语，另一部分为词频，最后为词性（可省略），用空格隔开<br>范例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">自定义词典：</div><div class="line">云计算 5  </div><div class="line">李小福 2 nr  </div><div class="line">创新办 3 i  </div><div class="line">easy_install 3 eng  </div><div class="line">好用 300  </div><div class="line">韩玉赏鉴 3 nz</div></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#encoding=utf-8  </span></div><div class="line"><span class="keyword">import</span> sys  </div><div class="line">sys.path.append(<span class="string">"../"</span>)  </div><div class="line"><span class="keyword">import</span> jieba  </div><div class="line">jieba.load_userdict(<span class="string">"userdict.txt"</span>)  </div><div class="line"><span class="keyword">import</span> jieba.posseg <span class="keyword">as</span> pseg  </div><div class="line">  </div><div class="line">test_sent = <span class="string">"李小福是创新办主任也是云计算方面的专家;"</span>  </div><div class="line">test_sent += <span class="string">"例如我输入一个带“韩玉赏鉴”的标题，在自定义词库中也增加了此词为N类型"</span>  </div><div class="line">words = jieba.cut(test_sent)  </div><div class="line"><span class="keyword">for</span> w <span class="keyword">in</span> words:  </div><div class="line"><span class="keyword">print</span> w  </div><div class="line">  </div><div class="line">result = pseg.cut(test_sent)  </div><div class="line">  </div><div class="line"><span class="keyword">for</span> w <span class="keyword">in</span> result:  </div><div class="line"><span class="keyword">print</span> w.word, <span class="string">"/"</span>, w.flag, <span class="string">", "</span>,  </div><div class="line">  </div><div class="line"><span class="keyword">print</span> <span class="string">"\n========"</span>  </div><div class="line">  </div><div class="line">terms = jieba.cut(<span class="string">'easy_install is great'</span>)  </div><div class="line"><span class="keyword">for</span> t <span class="keyword">in</span> terms:  </div><div class="line">    <span class="keyword">print</span> t  </div><div class="line"><span class="keyword">print</span> <span class="string">'-------------------------'</span>  </div><div class="line">terms = jieba.cut(<span class="string">'python 的正则表达式是好用的'</span>)  </div><div class="line"><span class="keyword">for</span> t <span class="keyword">in</span> terms:  </div><div class="line">    <span class="keyword">print</span> t</div></pre></td></tr></table></figure>
<blockquote>
<p>之前： 李小福 / 是 / 创新 / 办 / 主任 / 也 / 是 / 云 / 计算 / 方面 / 的 / 专家 / 加载自定义词库后： 李小福 / 是 / 创新办 / 主任 / 也 / 是 / 云计算 / 方面 / 的 / 专家 /<br>“通过用户自定义词典来增强歧义纠错能力” </p>
</blockquote>
<h3 id="关键词提取"><a href="#关键词提取" class="headerlink" title="关键词提取"></a>关键词提取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jieba.analyse.extract_tags(sentence,topK) <span class="comment">#需要先import jieba.analyse</span></div></pre></td></tr></table></figure>
<blockquote>
<p>说明<br>    setence为待提取的文本<br>    topK为返回几个TF/IDF权重最大的关键词，默认值为20 </p>
</blockquote>
<p><strong> 代码示例 （关键词提取） </strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys  </div><div class="line">sys.path.append(<span class="string">'../'</span>)  </div><div class="line">  </div><div class="line"><span class="keyword">import</span> jieba  </div><div class="line"><span class="keyword">import</span> jieba.analyse  </div><div class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser  </div><div class="line">  </div><div class="line">USAGE = <span class="string">"usage: python extract_tags.py [file name] -k [top k]"</span>  </div><div class="line">  </div><div class="line">parser = OptionParser(USAGE)  </div><div class="line">parser.add_option(<span class="string">"-k"</span>, dest=<span class="string">"topK"</span>)  </div><div class="line">opt, args = parser.parse_args()  </div><div class="line">  </div><div class="line">‘’‘  </div><div class="line"><span class="keyword">if</span> len(args) &lt; <span class="number">1</span>:  </div><div class="line">    <span class="keyword">print</span> USAGE  </div><div class="line">    sys.exit(<span class="number">1</span>)  </div><div class="line">  </div><div class="line">file_name = args[<span class="number">0</span>]  </div><div class="line">’‘’  </div><div class="line">file_name=<span class="string">u"D:XXX/xx/xx.txt"</span>  </div><div class="line"><span class="keyword">if</span> opt.topK <span class="keyword">is</span> <span class="keyword">None</span>:  </div><div class="line">    topK = <span class="number">10</span>  </div><div class="line"><span class="keyword">else</span>:  </div><div class="line">    topK = int(opt.topK)  </div><div class="line">  </div><div class="line">content = open(file_name, <span class="string">'rb'</span>).read()  </div><div class="line">  </div><div class="line">tags = jieba.analyse.extract_tags(content, topK=topK)  </div><div class="line">  </div><div class="line"><span class="keyword">print</span> <span class="string">","</span>.join(tags)</div></pre></td></tr></table></figure></p>
<h3 id="词性标注"><a href="#词性标注" class="headerlink" title="词性标注"></a>词性标注</h3><blockquote>
<p>标注句子分词后每个词的词性，采用和ictclas兼容的标记法 </p>
</blockquote>
<p><strong> 用法示例 </strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> jieba.posseg <span class="keyword">as</span> pseg  </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>words = pseg.cut(<span class="string">"我爱北京天安门"</span>)  </div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> w <span class="keyword">in</span> words:  </div><div class="line"><span class="meta">... </span>   <span class="keyword">print</span> w.word, w.flag  </div><div class="line"><span class="meta">... </span> </div><div class="line">我 r  </div><div class="line">爱 v  </div><div class="line">北京 ns  </div><div class="line">天安门 ns</div></pre></td></tr></table></figure></p>
<h3 id="并行分词"><a href="#并行分词" class="headerlink" title="并行分词"></a>并行分词</h3><blockquote>
<p>原理：将目标文本按行分隔后，把各行文本分配到多个python进程并行分词，然后归并结果，从而获得分词速度的可观提升基于python自带的multiprocessing模块，目前暂不支持windows </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">jieba.enable_parallel(<span class="number">4</span>) <span class="comment"># 开启并行分词模式，参数为并行进程数  </span></div><div class="line">jieba.disable_parallel() <span class="comment"># 关闭并行分词模式</span></div></pre></td></tr></table></figure>
<p><strong> 用法示例 </strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> urllib2  </div><div class="line"><span class="keyword">import</span> sys,time  </div><div class="line"><span class="keyword">import</span> sys  </div><div class="line">sys.path.append(<span class="string">"../../"</span>)  </div><div class="line"><span class="keyword">import</span> jieba  </div><div class="line">jieba.enable_parallel(<span class="number">4</span>)  </div><div class="line">  </div><div class="line">url = sys.argv[<span class="number">1</span>]  </div><div class="line">content = open(url,<span class="string">"rb"</span>).read()  </div><div class="line">t1 = time.time()  </div><div class="line">words = list(jieba.cut(content))  </div><div class="line">  </div><div class="line">t2 = time.time()  </div><div class="line">tm_cost = t2-t1  </div><div class="line">  </div><div class="line">log_f = open(<span class="string">"1.log"</span>,<span class="string">"wb"</span>)  </div><div class="line"><span class="keyword">for</span> w <span class="keyword">in</span> words:  </div><div class="line"><span class="keyword">print</span> &gt;&gt; log_f, w.encode(<span class="string">"utf-8"</span>), <span class="string">"/"</span> ,  </div><div class="line">  </div><div class="line"><span class="keyword">print</span> <span class="string">'speed'</span> , len(content)/tm_cost, <span class="string">" bytes/second"</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>实验结果：在4核3.4GHz Linux机器上，对金庸全集进行精确分词，获得了1MB/s的速度，是单进程版的3.3倍。<br>其他词典</p>
<p>占用内存较小的词典文件 <a href="https://github.com/fxsjy/jieba/raw/master/extra_dict/dict.txt.small" target="_blank" rel="external">https://github.com/fxsjy/jieba/raw/master/extra_dict/dict.txt.small</a><br>    支持繁体分词更好的词典文件 <a href="https://github.com/fxsjy/jieba/raw/master/extra_dict/dict.txt.big" target="_blank" rel="external">https://github.com/fxsjy/jieba/raw/master/extra_dict/dict.txt.big</a> 下载你所需要的词典，然后覆盖jieba/dict.txt 即可或者用jieba.set_dictionary(‘data/dict.txt.big’)</p>
<p>模块初始化机制的改变:lazy load （从0.28版本开始）<br>jieba采用延迟加载，”import jieba”不会立即触发词典的加载，一旦有必要才开始加载词典构建trie。如果你想手工初始jieba，也可以手动初始化。</p>
</blockquote>
<h3 id="Tokenize：返回词语在原文的起始位置"><a href="#Tokenize：返回词语在原文的起始位置" class="headerlink" title="Tokenize：返回词语在原文的起始位置"></a>Tokenize：返回词语在原文的起始位置</h3><blockquote>
<p>注意，输入参数只接受unicode</p>
</blockquote>
<h3 id="ChineseAnalyzer-for-Whoosh搜索引擎"><a href="#ChineseAnalyzer-for-Whoosh搜索引擎" class="headerlink" title="ChineseAnalyzer for Whoosh搜索引擎"></a>ChineseAnalyzer for Whoosh搜索引擎</h3><blockquote>
<p>引用： from jieba.analyse import ChineseAnalyzer<br>用法示例：<a href="https://github.com/fxsjy/jieba/blob/master/test/test_whoosh.py" target="_blank" rel="external">https://github.com/fxsjy/jieba/blob/master/test/test_whoosh.py</a></p>
</blockquote>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      python 分词 jieba
    
    </summary>
    
      <category term="python" scheme="https://austinxishou.github.io/categories/python/"/>
    
    
      <category term="python" scheme="https://austinxishou.github.io/tags/python/"/>
    
      <category term="jieba" scheme="https://austinxishou.github.io/tags/jieba/"/>
    
  </entry>
  
  <entry>
    <title>游戏站推荐</title>
    <link href="https://austinxishou.github.io/2017/11/01/killtime/game-resource-collection/"/>
    <id>https://austinxishou.github.io/2017/11/01/killtime/game-resource-collection/</id>
    <published>2017-11-01T07:52:12.524Z</published>
    <updated>2017-05-12T02:34:12.000Z</updated>
    
    <content type="html"><![CDATA[<ul>
<li>拼命玩游戏 : <a href="http://wanga.me/" target="_blank" rel="external">http://wanga.me/</a></li>
<li>ArmorGames : <a href="http://armorgames.com/" target="_blank" rel="external">http://armorgames.com/</a></li>
<li>u77汉化 : <a href="http://www.u77.com/" target="_blank" rel="external">http://www.u77.com/</a></li>
<li><p>taptap : <a href="https://www.taptap.com/" target="_blank" rel="external">https://www.taptap.com/</a></p>
<script>
(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
  }
  else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);

  var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
  document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      游戏站推荐
    
    </summary>
    
      <category term="killtime" scheme="https://austinxishou.github.io/categories/killtime/"/>
    
    
      <category term="killtime" scheme="https://austinxishou.github.io/tags/killtime/"/>
    
      <category term="football" scheme="https://austinxishou.github.io/tags/football/"/>
    
  </entry>
  
  <entry>
    <title>IT技术站点收集</title>
    <link href="https://austinxishou.github.io/2017/11/01/killtime/ittech-site-collection/"/>
    <id>https://austinxishou.github.io/2017/11/01/killtime/ittech-site-collection/</id>
    <published>2017-11-01T07:52:12.424Z</published>
    <updated>2017-05-12T06:35:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h2><ul>
<li><a href="http://www.androidchina.net/" target="_blank" rel="external">Android开发中文站</a></li>
<li><a href="http://p.codekk.com/" target="_blank" rel="external">codeKK</a></li>
<li><a href="https://juejin.im/#/" target="_blank" rel="external">稀土掘金</a></li>
<li><a href="http://www.jcodecraeer.com/" target="_blank" rel="external">泡在网上的日子</a></li>
<li><a href="http://www.phpxs.com/code" target="_blank" rel="external">代码片段</a></li>
<li><a href="http://www.devstore.cn/" target="_blank" rel="external">DevStore</a></li>
<li><a href="http://www.androidweekly.cn/" target="_blank" rel="external">技术周报</a></li>
<li><a href="http://www.trinea.cn/" target="_blank" rel="external">Trinea</a></li>
</ul>
<h2 id="webdesign-worldpress"><a href="#webdesign-worldpress" class="headerlink" title="webdesign-worldpress"></a>webdesign-worldpress</h2><ul>
<li><a href="https://perishablepress.com/" target="_blank" rel="external">perishablepress</a></li>
<li><a href="http://www.cssflow.com/" target="_blank" rel="external">cssflow</a></li>
<li><a href="http://www.webappers.com/" target="_blank" rel="external">webappers</a></li>
<li><a href="https://www.smashingmagazine.com/" target="_blank" rel="external">smashingmagazine</a></li>
</ul>
<h2 id="C-C"><a href="#C-C" class="headerlink" title="C/C++"></a>C/C++</h2><ul>
<li><p><a href="http://forums.codeguru.com/" target="_blank" rel="external"></a></p>
<script>
(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
  }
  else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);

  var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
  document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      IT技术站点收集
    
    </summary>
    
      <category term="killtime" scheme="https://austinxishou.github.io/categories/killtime/"/>
    
    
      <category term="killtime" scheme="https://austinxishou.github.io/tags/killtime/"/>
    
      <category term="ittech" scheme="https://austinxishou.github.io/tags/ittech/"/>
    
  </entry>
  
  <entry>
    <title>pyinstaller打包可执行文件命令工具使用</title>
    <link href="https://austinxishou.github.io/2017/11/01/python/pyinstaller-winexe-usage-guide/"/>
    <id>https://austinxishou.github.io/2017/11/01/python/pyinstaller-winexe-usage-guide/</id>
    <published>2017-11-01T07:52:11.919Z</published>
    <updated>2017-05-17T06:37:20.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介安装与说明"><a href="#简介安装与说明" class="headerlink" title="简介安装与说明"></a>简介安装与说明</h2><p><a href="http://www.pyinstaller.org/" target="_blank" rel="external">pyinstall官网</a><br><a href="http://www.111cn.net/phper/python/122937.htm" target="_blank" rel="external">http://www.111cn.net/phper/python/122937.htm</a></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>命令格式为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pyinstaller [options] script [script ...] | specfile</div></pre></td></tr></table></figure></p>
<p>所以最基本的使用为:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pyinstaller myscript.py</div></pre></td></tr></table></figure></p>
<ul>
<li>Writes myscript.spec in the same folder as the script.</li>
<li>Creates a folder build in the same folder as the script if it does not exist.</li>
<li>Writes some log files and working files in the build folder.</li>
<li>Creates a folder dist in the same folder as the script if it does not exist.</li>
<li>Writes the myscript executable folder in the dist folder.</li>
</ul>
<p>更深入的使用得配合各种选项和myscript.spec文件</p>
<h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><h3 id="Spec-文件"><a href="#Spec-文件" class="headerlink" title="Spec 文件"></a>Spec 文件</h3><h3 id="UPX压缩可执行包"><a href="#UPX压缩可执行包" class="headerlink" title="UPX压缩可执行包"></a>UPX压缩可执行包</h3><p>默认生成的python可执行文件有点大，可以通过upx程序进行压缩，upx程序的主页位于：<a href="https://upx.github.io/" target="_blank" rel="external">https://upx.github.io/</a> ，目前windows版的最新upx为upx391w.zip ，下载后，将其中的upx.exe文件放到C:\Python27目录下（python可执行程序的安装目录），再次执行的时候，可以跟上–upx进行压缩。默认存在时不指定也会进行压缩，生成exe文件时，在其日志中可以发现如下内容：</p>
<p>###加密 python 可执行文件<br>Encrypting Python Bytecode</p>
<h3 id="跨平台打包"><a href="#跨平台打包" class="headerlink" title="跨平台打包"></a>跨平台打包</h3><h3 id="windows-安装包的版本文件"><a href="#windows-安装包的版本文件" class="headerlink" title="windows 安装包的版本文件"></a>windows 安装包的版本文件</h3><p>pyi-grab_version 命令<br>pyi-grab_version executable_with_version_resource</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">--version-file=<span class="string">'file_version_info.txt'</span>,</div><div class="line">          --version-file file_version_info.txt,</div><div class="line">icon</div><div class="line">          icon=<span class="string">'news_xishou.ico'</span>,</div><div class="line"><span class="keyword">import</span> logging</div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="number">1</span>/<span class="number">0</span></div><div class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">    logging.exception(<span class="string">"message"</span>)</div></pre></td></tr></table></figure>
<h2 id="运行时信息"><a href="#运行时信息" class="headerlink" title="运行时信息"></a>运行时信息</h2><p>当应用运行时,有可能从以下三个地方获取可访问的文件:</p>
<ol>
<li>当前程序的文件夹内,比如我们添加的 Adding Data Files</li>
<li>用户在使用时放置在程序文件夹内</li>
<li>用户当前工作目录</li>
</ol>
<h3 id="使用-file-and-sys-MEIPASS"><a href="#使用-file-and-sys-MEIPASS" class="headerlink" title="使用 file and sys._MEIPASS"></a>使用 <strong>file</strong> and sys._MEIPASS</h3><p>在Python中,<code>__file__</code> 表示当前脚本文件的路径.当程序包文件运行时,加载器会设置sys.frozen变量和<br>把运行文件的绝对路径保存在 <code>sys._MEIPASS</code> 变量中;</p>
<p>在 一个文件夹安装包的模式,这个路径指向文件夹;<br>在一个文件的模式中,这个路径指向 _MEIxxxxxx 临时文件夹</p>
<h3 id="使用-sys-executable-and-sys-argv-0"><a href="#使用-sys-executable-and-sys-argv-0" class="headerlink" title="使用 sys.executable and sys.argv[0]"></a>使用 sys.executable and sys.argv[0]</h3><p>在 python 运行时, sys.executable 表示当前程序的路径,一般为python解释的路径,如:<br>C:\Python27\python.exe</p>
<p>但是在 安装包运行,虽然也表示运行程序的路径,但已经不是 python解释器的路径,而是程序加载器<br>bootloader<br>所以这个变量提供了一个可靠的路径标识当前用户使用的路径位置;</p>
<p>当用户是使用快捷键运行时,sys.argv[0]标识快捷键的位置,sys.executable仍然是可执行文件真实存在的位置</p>
<p>当需要提供不同快捷键运行不同功能时,就可以使用该参数<br>os.path.basename(sys.argv[0])</p>
<p>示例程序<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"><span class="keyword">import</span> sys, os</div><div class="line">frozen = <span class="string">'not'</span></div><div class="line"><span class="keyword">if</span> getattr(sys, <span class="string">'frozen'</span>, <span class="keyword">False</span>):</div><div class="line">        <span class="comment"># we are running in a bundle</span></div><div class="line">        frozen = <span class="string">'ever so'</span></div><div class="line">        bundle_dir = sys._MEIPASS</div><div class="line"><span class="keyword">else</span>:</div><div class="line">        <span class="comment"># we are running in a normal Python environment</span></div><div class="line">        bundle_dir = os.path.dirname(os.path.abspath(__file__))</div><div class="line">print( <span class="string">'we are'</span>,frozen,<span class="string">'frozen'</span>)</div><div class="line">print( <span class="string">'bundle dir is'</span>, bundle_dir )</div><div class="line">print( <span class="string">'sys.argv[0] is'</span>, sys.argv[<span class="number">0</span>] )</div><div class="line">print( <span class="string">'sys.executable is'</span>, sys.executable )</div><div class="line">print( <span class="string">'os.getcwd is'</span>, os.getcwd() )</div></pre></td></tr></table></figure></p>
<h3 id="LD-LIBRARY-PATH-LIBPATH-considerations"><a href="#LD-LIBRARY-PATH-LIBPATH-considerations" class="headerlink" title="LD_LIBRARY_PATH / LIBPATH considerations"></a>LD_LIBRARY_PATH / LIBPATH considerations</h3><p>在类Unix系统中,表示库搜索路径</p>
<h2 id="使用-Spec-文件"><a href="#使用-Spec-文件" class="headerlink" title="使用 Spec 文件"></a>使用 Spec 文件</h2><p>使用spec文件的场景:</p>
<ol>
<li>打包数据文件</li>
<li>加载运行时库文件</li>
<li>增加Python运行时配置参数</li>
<li>打包跨程序的安装包</li>
</ol>
<p>单独生成spec文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pyi-makespec options name.py [other scripts ...]</div></pre></td></tr></table></figure></p>
<p>当生成并修改好spec文件后,运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pyinstaller options name.spec</div></pre></td></tr></table></figure></p>
<p>当你使用spec文件时,绝大多数的选项参数已经在spec文件中给出,这些参数不会改变;也就说你在命令行中给出的选项参数会被spec文件的参数覆盖,不起作用</p>
<p>只有下述几个参数才是有意义的<br>–upx-dir=<br>–distpath=<br>–workpath=<br>–noconfirm<br>–ascii</p>
<h3 id="spec-文件的结构"><a href="#spec-文件的结构" class="headerlink" title="spec 文件的结构"></a>spec 文件的结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">block_cipher = None</div><div class="line">a = Analysis([&apos;minimal.py&apos;],</div><div class="line">     pathex=[&apos;/Developer/PItests/minimal&apos;],</div><div class="line">     binaries=None,</div><div class="line">     datas=None,</div><div class="line">     hiddenimports=[],</div><div class="line">     hookspath=None,</div><div class="line">     runtime_hooks=None,</div><div class="line">     excludes=None,</div><div class="line">     cipher=block_cipher)</div><div class="line">pyz = PYZ(a.pure, a.zipped_data,</div><div class="line">     cipher=block_cipher)</div><div class="line">exe = EXE(pyz,... )</div><div class="line">coll = COLLECT(...)</div></pre></td></tr></table></figure>
<p>由四部分组成: Analysis, PYZ, EXE and COLLECT.</p>
<h3 id="向压缩包中添加文件"><a href="#向压缩包中添加文件" class="headerlink" title="向压缩包中添加文件"></a>向压缩包中添加文件</h3><p>添加文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">added_files = [</div><div class="line">         ( &apos;/mygame/sfx/*.mp3&apos;, &apos;sfx&apos; ),</div><div class="line">         ( &apos;src/README.txt&apos;, &apos;.&apos; )</div><div class="line">         ]</div><div class="line">    a = Analysis(...</div><div class="line">         datas = added_files,</div><div class="line">         ...</div><div class="line">         )</div></pre></td></tr></table></figure>
<p>可以添加整个文件夹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">added_files = [</div><div class="line">         ( &apos;/mygame/data&apos;, &apos;data&apos; ),</div><div class="line">         ( &apos;/mygame/sfx/*.mp3&apos;, &apos;sfx&apos; ),</div><div class="line">         ( &apos;src/README.txt&apos;, &apos;.&apos; )</div><div class="line">         ]</div></pre></td></tr></table></figure></p>
<p>/mygame/data整个文件夹复制到data目录</p>
<h3 id="在模块中使用-data文件"><a href="#在模块中使用-data文件" class="headerlink" title="在模块中使用 data文件"></a>在模块中使用 data文件</h3><p>pkgutils.get_data()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">import pkgutil</div><div class="line">help_bin = pkgutil.get_data( &apos;helpmod&apos;, &apos;help_data.txt&apos; )</div></pre></td></tr></table></figure>
<p>添加可执行文件</p>
<h3 id="增加Python运行时参数"><a href="#增加Python运行时参数" class="headerlink" title="增加Python运行时参数"></a>增加Python运行时参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">v to write a message to stdout each time a module is initialized.</div><div class="line">u for unbuffered stdio.</div><div class="line">W and an option to change warning behavior: W ignore or W once or W error.</div></pre></td></tr></table></figure>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';       
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);

    var sozzsrc = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a":"https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a";
    document.write('<script src="' + sozzsrc + '" id="sozz"><\/script>');
})();
</script>
]]></content>
    
    <summary type="html">
    
      pyinstaller打包可执行文件命令工具使用
    
    </summary>
    
      <category term="python pyinstaller" scheme="https://austinxishou.github.io/categories/python-pyinstaller/"/>
    
    
      <category term="python" scheme="https://austinxishou.github.io/tags/python/"/>
    
      <category term="pyinstaller" scheme="https://austinxishou.github.io/tags/pyinstaller/"/>
    
  </entry>
  
  <entry>
    <title>Android 冻结APP</title>
    <link href="https://austinxishou.github.io/2017/11/01/android/android-apk-disable/"/>
    <id>https://austinxishou.github.io/2017/11/01/android/android-apk-disable/</id>
    <published>2017-11-01T07:52:11.216Z</published>
    <updated>2017-08-24T12:44:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="js模块开发的任务"><a href="#js模块开发的任务" class="headerlink" title="js模块开发的任务"></a>js模块开发的任务</h2><p>首先需要了解</p>
<ol>
<li>Node Package Manager (NPM): 阅读 <a href="https://docs.npmjs.com/getting-started/what-is-npm" target="_blank" rel="external">Getting Started guide</a></li>
<li>Modern JavaScript with ES2015/16: 阅读 Babel 的 <a href="https://babeljs.io/learn-es2015/" target="_blank" rel="external">Learn ES2015 guide</a></li>
<li><a href="https://github.com/vuejs-templates/webpack-simple" target="_blank" rel="external"> webpack-simple</a></li>
<li><a href="https://egghead.io/courses/using-webpack-for-production-javascript-applications" target="_blank" rel="external"> 这个在 Egghead.io上的 高级 Webpack 课程</a></li>
<li><a href="https://vue-loader.vuejs.org/" target="_blank" rel="external">vue-loader</a></li>
</ol>
<p>//参考markdown格式</p>
<h2 id="功能说"><a href="#功能说" class="headerlink" title="功能说"></a>功能说</h2><blockquote>
<p>在国内的Android生态中,所有的APP开发者都是一种流氓的心态,后台服务一大堆,还监听各种广播,导致用户根本不可能完全删除后台服务;有人说既然他们流氓,你不用他们就是,卸载掉啊!!哎,一些主流公司的APP,即使知道他流氓,还真的继续用它,比如支付宝\微信等;</p>
<p>所以采用冻结的方法是最有效,最干净的,只是可惜<strong> pm disable </strong>这个权限Android并没有对普通应用开放,也是一个蛋疼的事情.Android生态也是,申请各种权限不需要root,反而关闭权限需要;</p>
</blockquote>
<p>使用冻结APP的场景:</p>
<ol>
<li>某些应用开启大量后台服务,导致系统响应缓慢,再不能卸载的情况下,冻结它;</li>
<li>某些不常用的APP,但是需要的时候重新下载又麻烦,冻结它;</li>
<li>某些应用后台大量更新数据,消耗流量,冻结它;</li>
<li>冻结app解冻后,保留所有应用数据,不用担心数据丢失,账号重新登录等;</li>
</ol>
<h2 id="主要代码实现"><a href="#主要代码实现" class="headerlink" title="主要代码实现"></a>主要代码实现</h2><p>冻结APP<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">disableApp</span><span class="params">(String appPackageName)</span></span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        Process localProcess=Runtime.getRuntime().exec(<span class="string">"su"</span>);</div><div class="line">        String cmd=<span class="string">"pm disable "</span>+appPackageName+<span class="string">"\n"</span>;</div><div class="line">        DataOutputStream dataOutputStream=<span class="keyword">new</span> DataOutputStream(localProcess.getOutputStream());</div><div class="line">        dataOutputStream.writeBytes(cmd);</div><div class="line">        dataOutputStream.flush();</div><div class="line">        dataOutputStream.writeBytes(<span class="string">"exit\n"</span>);</div><div class="line"></div><div class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>解冻APP<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enableApp</span><span class="params">(String appPackageName)</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        Process localProcess=Runtime.getRuntime().exec(<span class="string">"su"</span>);</div><div class="line">        String cmd=<span class="string">"pm enable "</span>+appPackageName+<span class="string">"\n"</span>;</div><div class="line">        DataOutputStream dataOutputStream=<span class="keyword">new</span> DataOutputStream(localProcess.getOutputStream());</div><div class="line">        dataOutputStream.writeBytes(cmd);</div><div class="line">        dataOutputStream.flush();</div><div class="line">        dataOutputStream.writeBytes(<span class="string">"exit\n"</span>);</div><div class="line"></div><div class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><script><br>(function(){<br>    var bp = document.createElement(‘script’);<br>    var curProtocol = window.location.protocol.split(‘:’)[0];<br>    if (curProtocol === ‘https’) {<br>        bp.src = ‘<a href="https://zz.bdstatic.com/linksubmit/push.js">https://zz.bdstatic.com/linksubmit/push.js</a>‘;<br>    }<br>    else {<br>        bp.src = ‘<a href="http://push.zhanzhang.baidu.com/push.js">http://push.zhanzhang.baidu.com/push.js</a>‘;<br>    }<br>    var s = document.getElementsByTagName(“script”)[0];<br>    s.parentNode.insertBefore(bp, s);</p>
<pre><code>var sozzsrc = (document.location.protocol == &quot;http:&quot;) ? &quot;http://js.passport.qihucdn.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;:&quot;https://jspassport.ssl.qhimg.com/11.0.1.js?6934e60f0fcbf5f113646cf0c3c61c6a&quot;;
document.write(&apos;&lt;script src=&quot;&apos; + sozzsrc + &apos;&quot; id=&quot;sozz&quot;&gt;&lt;\/script&gt;&apos;);
</code></pre><p>})();<br></script></p>
]]></content>
    
    <summary type="html">
    
      Android pm disable
    
    </summary>
    
      <category term="android" scheme="https://austinxishou.github.io/categories/android/"/>
    
    
      <category term="android" scheme="https://austinxishou.github.io/tags/android/"/>
    
  </entry>
  
</feed>
